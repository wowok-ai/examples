process.argv = [process.argv[0], ...process.argv.slice(3)];

		import __esrun_url from 'url';

		import { createRequire as __esrun_createRequire } from "module";

		const __esrun_fileUrl = __esrun_url.pathToFileURL("\wowok\test\node_modules\.bin\esrun-1709189650738.tmp.mjs");

		const require = __esrun_createRequire(__esrun_fileUrl);
// src/index.ts
import { SuiClient as SuiClient2, getFullnodeUrl as getFullnodeUrl2 } from "../../node_modules/@mysten/sui.js/dist/esm/client/index.js";
import { TransactionBlock as TransactionBlock2 } from "../../node_modules/@mysten/sui.js/dist/esm/builder/export.js";
import { Ed25519Keypair } from "../../node_modules/@mysten/sui.js/dist/esm/keypairs/ed25519/index.js";
import { BCS as BCS4, fromHEX as fromHEX4 } from "../../node_modules/@mysten/bcs/dist/esm/index.js";

// src/config.ts
import { Inputs } from "../../node_modules/@mysten/sui.js/dist/esm/builder/export.js";

// src/util.ts
function capitalize(s) {
  return s && s[0].toUpperCase() + s.slice(1);
}

// src/config.ts
var Config_EntryPoint = "localnet" /* localnet */;
var PACKAGE = "0x77b83ae81904154142e48683731800285932ff49317cde241a2dd80460f5dd34";
var SENDER_PRIV = "0xc9bbc30f72ef7d9aa674a3be1448b9267141a676b59f3f4315231617a5bbc0e8";
var ADDR = "0xe386bb9e01b3528b75f3751ad8a1e418b207ad979fea364087deef5250a73d3f";
var MODULES = /* @__PURE__ */ ((MODULES5) => {
  MODULES5["machine"] = "machine";
  MODULES5["node"] = "node";
  MODULES5["progress"] = "progress";
  MODULES5["community"] = "community";
  MODULES5["repository"] = "repository";
  MODULES5["permission"] = "permission";
  MODULES5["passport"] = "passport";
  MODULES5["guard"] = "guard";
  MODULES5["vote"] = "vote";
  MODULES5["demand"] = "demand";
  MODULES5["order"] = "order";
  MODULES5["reward"] = "reward";
  MODULES5["service"] = "service";
  MODULES5["wowok"] = "wowok";
  return MODULES5;
})(MODULES || {});
var OBJECTS_TYPE_PREFIX = Object.keys(MODULES).map((key) => {
  return PACKAGE + "::" + key + "::";
});
var OBJECTS_TYPE = Object.keys(MODULES).map((key) => {
  let i = PACKAGE + "::" + key + "::";
  return i + capitalize(key);
});
var PermissionFn = (fn) => {
  return `${PACKAGE}::${"permission" /* permission */}::${fn}`;
};
var CLOCK_OBJECT = Inputs.SharedObjectRef({
  objectId: "0x6",
  mutable: false,
  initialSharedVersion: 1
});

// src/guard.ts
import { BCS, getSuiMoveConfig } from "../../node_modules/@mysten/bcs/dist/esm/index.js";
var Sense_Cmd = [
  ["permission" /* permission */, "creator", 1, [], 101 /* TYPE_STATIC_address */],
  ["permission" /* permission */, "is_admin", 2, [101 /* TYPE_STATIC_address */], 100 /* TYPE_STATIC_bool */],
  ["permission" /* permission */, "has_rights", 3, [101 /* TYPE_STATIC_address */, 102 /* TYPE_STATIC_u64 */], 100 /* TYPE_STATIC_bool */],
  ["permission" /* permission */, "contains_address", 4, [101 /* TYPE_STATIC_address */], 100 /* TYPE_STATIC_bool */],
  ["permission" /* permission */, "contains_index", 5, [101 /* TYPE_STATIC_address */, 102 /* TYPE_STATIC_u64 */], 100 /* TYPE_STATIC_bool */],
  ["permission" /* permission */, "contains_guard", 6, [101 /* TYPE_STATIC_address */, 102 /* TYPE_STATIC_u64 */], 100 /* TYPE_STATIC_bool */],
  ["repository" /* repository */, "permission", 1, [], 101 /* TYPE_STATIC_address */],
  ["repository" /* repository */, "policy_contains", 2, [105 /* TYPE_STATIC_vec_u8 */], 100 /* TYPE_STATIC_bool */],
  ["repository" /* repository */, "policy_has_permission_index", 3, [105 /* TYPE_STATIC_vec_u8 */], 100 /* TYPE_STATIC_bool */],
  ["repository" /* repository */, "policy_permission_index", 4, [105 /* TYPE_STATIC_vec_u8 */], 102 /* TYPE_STATIC_u64 */],
  ["repository" /* repository */, "policy_value_type", 5, [105 /* TYPE_STATIC_vec_u8 */], 103 /* TYPE_STATIC_u8 */],
  ["repository" /* repository */, "contains_id", 6, [101 /* TYPE_STATIC_address */], 100 /* TYPE_STATIC_bool */],
  ["repository" /* repository */, "contains_value", 7, [101 /* TYPE_STATIC_address */, 105 /* TYPE_STATIC_vec_u8 */], 100 /* TYPE_STATIC_bool */],
  ["repository" /* repository */, "value_without_type", 8, [101 /* TYPE_STATIC_address */, 105 /* TYPE_STATIC_vec_u8 */], 105 /* TYPE_STATIC_vec_u8 */],
  ["repository" /* repository */, "value", 9, [101 /* TYPE_STATIC_address */, 105 /* TYPE_STATIC_vec_u8 */], 105 /* TYPE_STATIC_vec_u8 */],
  ["repository" /* repository */, "type", 10, [], 103 /* TYPE_STATIC_u8 */],
  ["repository" /* repository */, "policy_mode", 11, [], 103 /* TYPE_STATIC_u8 */]
];

// src/query.ts
import { SuiClient, getFullnodeUrl } from "../../node_modules/@mysten/sui.js/dist/esm/client/index.js";
import { TransactionBlock, Inputs as Inputs2 } from "../../node_modules/@mysten/sui.js/dist/esm/builder/export.js";
import { BCS as BCS2, getSuiMoveConfig as getSuiMoveConfig2 } from "../../node_modules/@mysten/bcs/dist/esm/index.js";

// src/permission.ts
import { BCS as BCS3 } from "../../node_modules/@mysten/bcs/dist/esm/index.js";
function create_permission(txb, data) {
  let permission2 = txb.moveCall({
    target: PermissionFn("new"),
    arguments: [txb.pure(data.description)]
  });
  let guards = [];
  console.log(data.entities);
  for (let i = 0; i < data.entities.length; i++) {
    let entity = data.entities[i];
    let indexes = [];
    for (let j = 0; j < entity.permissions.length; j++) {
      let index = entity.permissions[j];
      if (index?.guard && index.guard.length > 0) {
        guards.push({ who: entity.who, index: index.index, guard: index.guard });
      }
      indexes.push(index.index);
    }
    if (indexes.length > 0) {
      txb.moveCall({
        target: PermissionFn("add_batch"),
        arguments: [permission2, txb.pure(entity.who, BCS3.ADDRESS), txb.pure(permission2, "vector<u64>")]
      });
    }
  }
  console.log(guards);
  guards.forEach(({ who, index, guard }) => {
    txb.moveCall({
      target: PermissionFn("guard_set"),
      arguments: [permission2, txb.pure(who, BCS3.ADDRESS), txb.pure(index, BCS3.U64), txb.object(guard)]
    });
  });
  txb.moveCall({
    target: PermissionFn("admin_add_batch"),
    arguments: [permission2, txb.pure(data.admin, "vector<address>")]
  });
  txb.moveCall({
    target: PermissionFn("create"),
    arguments: [permission2]
  });
}

// src/index.ts
var permissionid = "0x66c09cdb0156ff5dcdc70ef3d2a6a29b5e36c46b28c8b7cf9461f5a83b621b74";
var main = async () => {
  let permissionid1 = await permission(permission_data);
  console.log(permissionid);
};
var permission_data = {
  description: "permission 1",
  admin: [ADDR, "0x26bd78c2f9766b95ebc3f2ccd70922092a79eda49815a91258aa44d68ccf098d", "0xc009bca7fa6e6cedafa1edb4812dc361e81bed605c87edbdd6af917e3e0d9ab3"],
  entities: [
    { who: "0x26bd78c2f9766b95ebc3f2ccd70922092a79eda49815a91258aa44d68ccf098d", permissions: [
      { index: 106 /* repository_policy_add */ },
      { index: 101 /* repository_description_set */ }
    ] },
    { who: "0xc009bca7fa6e6cedafa1edb4812dc361e81bed605c87edbdd6af917e3e0d9ab3", permissions: [
      { index: 107 /* repository_policy_remove */ },
      { index: 107 /* repository_policy_remove */, guard: "0x51627be10211fa81f5d30e568fc0e3229a746b12f1b8c1b7d0abab3b62680c35" }
    ] },
    { who: ADDR, permissions: [] }
  ]
};
var permission = async (data) => {
  const client = new SuiClient2({ url: getFullnodeUrl2(Config_EntryPoint) });
  const txb = new TransactionBlock2();
  create_permission(txb, data);
  const privkey = fromHEX4(SENDER_PRIV);
  const keypair = Ed25519Keypair.fromSecretKey(privkey);
  const options = { showEffects: true };
  const response = await client.signAndExecuteTransactionBlock({
    transactionBlock: txb,
    signer: keypair,
    options
  });
  let permissionid2 = response.effects?.created[0].reference.objectId;
  console.log("permissionid: " + permissionid2);
  return permissionid2;
};
main().then(console.log).catch(console.error);
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL2luZGV4LnRzIiwgInNyYy9jb25maWcudHMiLCAic3JjL3V0aWwudHMiLCAic3JjL2d1YXJkLnRzIiwgInNyYy9xdWVyeS50cyIsICJzcmMvcGVybWlzc2lvbi50cyJdLAogICJzb3VyY2VSb290IjogIkQ6XFx3b3dva1xcdGVzdCIsCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBTdWlDbGllbnQsIGdldEZ1bGxub2RlVXJsLCBTdWlPYmplY3RSZXNwb25zZSB9IGZyb20gJ0BteXN0ZW4vc3VpLmpzL2NsaWVudCc7XHJcbmltcG9ydCB7IFRyYW5zYWN0aW9uQmxvY2ssIElucHV0cywgdHlwZSBUcmFuc2FjdGlvblJlc3VsdCB9IGZyb20gJ0BteXN0ZW4vc3VpLmpzL3RyYW5zYWN0aW9ucyc7XHJcbmltcG9ydCB7IEVkMjU1MTlLZXlwYWlyIH0gZnJvbSAnQG15c3Rlbi9zdWkuanMva2V5cGFpcnMvZWQyNTUxOSc7XHJcbmltcG9ydCB7IEJDUywgZ2V0U3VpTW92ZUNvbmZpZywgdG9IRVgsIGZyb21IRVgsIEJjc1JlYWRlciB9IGZyb20gJ0BteXN0ZW4vYmNzJztcclxuaW1wb3J0IHsgQ29uZmlnX0VudHJ5UG9pbnQsIENMT0NLX09CSkVDVCwgUGFzc3BvcnRGbiwgR3VhcmRGbiwgRm5DYWxsVHlwZSwgRGF0YV9UeXBlLCBNT0RVTEVTLCBTRU5ERVJfUFJJViwgQUREUiwgUEFDS0FHRSwgU2VydmljZUZuLCBQZXJtaXNzaW9uRm4sIERlbWFuZEZufSBmcm9tICcuL2NvbmZpZyc7XHJcbmltcG9ydCB7IFNlbnNlTWFrZXIsIEd1YXJkX1NlbnNlX0JpbmRlciwgY3JlYXRlX2d1YXJkLCBwYXJzZV9zZW5zZV9ic2MsIEd1YXJkX1NlbnNlIH0gZnJvbSAnLi9ndWFyZCc7XHJcbmltcG9ydCB7IGNvbmNhdGVuYXRlLCBhcnJheV91bmlxdWUsIGNhcGl0YWxpemUsIHBhcnNlX29iamVjdF90eXBlfSBmcm9tICcuL3V0aWwnO1xyXG5pbXBvcnQgeyBHdWFyZF9RdWVyeV9PYmplY3RfUmVzdWx0LCBycGNfZ3VhcmRfcXVlcnlfb2JqZWN0cyB9IGZyb20gJy4vcXVlcnknXHJcbmltcG9ydCB7IHZlcmlmeSwgZGVzdHJveSwgIH0gZnJvbSAnLi9wYXNzcG9ydCdcclxuaW1wb3J0IHsgUGVybWlzc2lvbl9EYXRhLCBjcmVhdGVfcGVybWlzc2lvbiwgUGVybWlzc2lvbkluZGV4IH0gZnJvbSAnLi9wZXJtaXNzaW9uJ1xyXG5cclxudmFyIHBlcm1pc3Npb25pZCA9ICcweDY2YzA5Y2RiMDE1NmZmNWRjZGM3MGVmM2QyYTZhMjliNWUzNmM0NmIyOGM4YjdjZjk0NjFmNWE4M2I2MjFiNzQnO1xyXG52YXIgc2VydmljZWlkID0gJzB4OGJjOGNlNzhiMDU2ZDY5YzIyMGJmMjY0MTcyNjIzYzI5MGNlMTlkZTMzYjVlNDhkZmVlZGM4NzU4MGEwODU5Nyc7XHJcbnZhciBkZW1hbmRpZCA9ICcweDU1OTJhMTA4NmViZGIxMTAzYjkzMWE5MDA5ZmJmYzYxODIxNzk1NDI5NWE0NjE0ZmZjZWYxYjUxNTY3MTQxN2YnO1xyXG52YXIgZ3VhcmRpZCA9ICcweGMyZTk4MDYzZGI4NDBhNTg3Nzg1N2IwOTVlM2Y0N2EyZjIyYzBiODRkZjk4NDM4YmM5NWM2YjhjNjQ0YzYyYTMnO1xyXG52YXIgcGFzc3BvcnRpZCA9ICcweDVmOTE2MzQwYzcyOWQ3ZGFhZDA5NjkxNjk2Mzc5ZTcxMDUwMjI4OTdjZWEyZDYwNTIwYTk3YjQzN2M3ZWI0MGMnO1xyXG5cclxuY29uc3QgbWFpbiA9IGFzeW5jICgpID0+IHtcclxuICAgIC8vIGNvbnNvbGUubG9nKGF3YWl0IHNpbXBsZV9ndWFyZF90ZXN0KCkpO1xyXG4gICAgLy8gY29uc29sZS5sb2coYXdhaXQgcnBjX2d1YXJkX29iamVjdHMoQ29uZmlnX0VudHJ5UG9pbnQsIEFERFIsICcweDVhZTgxYTNlYzg4NzQ2Yzc5ZDc1ZDk2ZDUxNDg5MGE2NzBjOTYzMzYxMzMyZTVjZGY5YTNlMTI4YjMzMjEyNTAnKSlcclxuICAgIC8vIGNvbnNvbGUubG9nKGF3YWl0IHNlcnZpY2UoKSk7XHJcblxyXG4gICAgLy8gY29uc29sZS5sb2coYXdhaXQgZGVtYW5kKCkpO1xyXG4gICAgLy8gY29uc29sZS5sb2coYXdhaXQgbmV3Z3VhcmQoKSlcclxuICAgIC8vIGNvbnNvbGUubG9nKGF3YWl0IGRlbWFuZF9ndWFyZCgpKTtcclxuICAgIC8vIGNvbnNvbGUubG9nKGF3YWl0IHBhc3Nwb3J0KCkpXHJcbiAgICAvLyBjb25zb2xlLmxvZyhhd2FpdCBkZW1hbmRfcHJlc2VudCgpKVxyXG4gICAgLy8gY29uc29sZS5sb2coYXdhaXQgcGFzc3BvcnRfdmVyaWZ5KCkpIFxyXG4gICAgbGV0IHBlcm1pc3Npb25pZDEgPSBhd2FpdCBwZXJtaXNzaW9uKHBlcm1pc3Npb25fZGF0YSk7XHJcbiAgICBjb25zb2xlLmxvZyhwZXJtaXNzaW9uaWQpO1xyXG4gICAgLy8gbGV0IHBlcm1pc3Npb25pZDIgPSBhd2FpdCBwZXJtaXNzaW9uKCk7XHJcbiAgICAvLyBjb25zb2xlLmxvZyhhd2FpdCBxdWVyeV9ndWFyZF90ZXN0KFtwZXJtaXNzaW9uaWQxLCBwZXJtaXNzaW9uaWQyXSkpO1xyXG4gICAgLypjb25zb2xlLmxvZyhhd2FpdCBuZXdndWFyZDIoKSlcclxuICAgIGNvbnNvbGUubG9nKGF3YWl0IHBhc3Nwb3J0KCkpXHJcbiAgICBjb25zb2xlLmxvZyhhd2FpdCBwYXNzcG9ydF92ZXJpZnkoKSkqL1xyXG59XHJcblxyXG5jb25zdCBwZXJtaXNzaW9uX2RhdGEgOiBQZXJtaXNzaW9uX0RhdGE9IHtcclxuICAgIGRlc2NyaXB0aW9uOiAncGVybWlzc2lvbiAxJyxcclxuICAgIGFkbWluOiBbQUREUiwgJzB4MjZiZDc4YzJmOTc2NmI5NWViYzNmMmNjZDcwOTIyMDkyYTc5ZWRhNDk4MTVhOTEyNThhYTQ0ZDY4Y2NmMDk4ZCcsICcweGMwMDliY2E3ZmE2ZTZjZWRhZmExZWRiNDgxMmRjMzYxZTgxYmVkNjA1Yzg3ZWRiZGQ2YWY5MTdlM2UwZDlhYjMnXSxcclxuICAgIGVudGl0aWVzOiBbXHJcbiAgICAgICAge3dobzonMHgyNmJkNzhjMmY5NzY2Yjk1ZWJjM2YyY2NkNzA5MjIwOTJhNzllZGE0OTgxNWE5MTI1OGFhNDRkNjhjY2YwOThkJywgcGVybWlzc2lvbnM6W1xyXG4gICAgICAgICAgICB7aW5kZXg6UGVybWlzc2lvbkluZGV4LnJlcG9zaXRvcnlfcG9saWN5X2FkZH0sIFxyXG4gICAgICAgICAgICB7aW5kZXg6UGVybWlzc2lvbkluZGV4LnJlcG9zaXRvcnlfZGVzY3JpcHRpb25fc2V0fSxcclxuICAgICAgICBdfSxcclxuICAgICAgICB7d2hvOicweGMwMDliY2E3ZmE2ZTZjZWRhZmExZWRiNDgxMmRjMzYxZTgxYmVkNjA1Yzg3ZWRiZGQ2YWY5MTdlM2UwZDlhYjMnLCBwZXJtaXNzaW9uczpbXHJcbiAgICAgICAgICAgIHtpbmRleDpQZXJtaXNzaW9uSW5kZXgucmVwb3NpdG9yeV9wb2xpY3lfcmVtb3ZlfSwgXHJcbiAgICAgICAgICAgIHtpbmRleDpQZXJtaXNzaW9uSW5kZXgucmVwb3NpdG9yeV9wb2xpY3lfcmVtb3ZlLCBndWFyZDonMHg1MTYyN2JlMTAyMTFmYTgxZjVkMzBlNTY4ZmMwZTMyMjlhNzQ2YjEyZjFiOGMxYjdkMGFiYWIzYjYyNjgwYzM1J30sXHJcbiAgICAgICAgXX0sXHJcbiAgICAgICAge3dobzogQUREUiwgcGVybWlzc2lvbnM6W119LFxyXG4gICAgXVxyXG59XHJcblxyXG5jb25zdCBwZXJtaXNzaW9uID0gYXN5bmMgKGRhdGE6UGVybWlzc2lvbl9EYXRhKSA6IFByb21pc2U8c3RyaW5nPiA9PiB7IFxyXG4gICAgY29uc3QgY2xpZW50ID0gIG5ldyBTdWlDbGllbnQoeyB1cmw6IGdldEZ1bGxub2RlVXJsKENvbmZpZ19FbnRyeVBvaW50KSB9KTsgIFxyXG4gICAgY29uc3QgdHhiID0gbmV3IFRyYW5zYWN0aW9uQmxvY2soKTtcclxuICAgIFxyXG4gICAgY3JlYXRlX3Blcm1pc3Npb24odHhiLCBkYXRhKTtcclxuXHJcbiAgICBjb25zdCBwcml2a2V5ID0gZnJvbUhFWChTRU5ERVJfUFJJVik7XHJcbiAgICBjb25zdCBrZXlwYWlyID0gRWQyNTUxOUtleXBhaXIuZnJvbVNlY3JldEtleShwcml2a2V5KTtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0geyBzaG93RWZmZWN0czogdHJ1ZSB9O1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjbGllbnQuc2lnbkFuZEV4ZWN1dGVUcmFuc2FjdGlvbkJsb2NrKHtcclxuICAgICAgICB0cmFuc2FjdGlvbkJsb2NrOiB0eGIsIFxyXG4gICAgICAgIHNpZ25lcjoga2V5cGFpcixcclxuICAgICAgICBvcHRpb25zXHJcbiAgICB9KTtcclxuICAgIGxldCBwZXJtaXNzaW9uaWQgPSByZXNwb25zZS5lZmZlY3RzPy5jcmVhdGVkWzBdLnJlZmVyZW5jZS5vYmplY3RJZCBhcyBzdHJpbmc7ICBcclxuICAgIGNvbnNvbGUubG9nKFwicGVybWlzc2lvbmlkOiBcIiArIHBlcm1pc3Npb25pZCk7ICBcclxuICAgIHJldHVybiBwZXJtaXNzaW9uaWQgICAgXHJcbn1cclxuXHJcbmNvbnN0IHNlcnZpY2UgPSBhc3luYyAoKSA9PiB7IC8vIDB4NmE2NGY0ZmRkZDhmMWVjZWM5MjBhMjI5ODYxYzNjNDI1NzMzNDIxMTE1NTA2MDUyOWVlZGQ5OWQ5YmRmMWUzYVxyXG4gICAgY29uc3QgY2xpZW50ID0gIG5ldyBTdWlDbGllbnQoeyB1cmw6IGdldEZ1bGxub2RlVXJsKENvbmZpZ19FbnRyeVBvaW50KSB9KTsgIFxyXG4gICAgY29uc3QgdHhiID0gbmV3IFRyYW5zYWN0aW9uQmxvY2soKTtcclxuICAgIFxyXG4gICAgbGV0IHNlcnZpY2UgPSB0eGIubW92ZUNhbGwoe1xyXG4gICAgICAgIHRhcmdldDogU2VydmljZUZuKCduZXcnKSBhcyBGbkNhbGxUeXBlLFxyXG4gICAgICAgIGFyZ3VtZW50czpbdHhiLnB1cmUoJ3NlcnZpY2UgLi4uJyksIC8vIGRlc2NyaXBcclxuICAgICAgICAgICAgdHhiLnB1cmUoQUREUiksIC8vIHBheWVlXHJcbiAgICAgICAgICAgIHR4Yi5wdXJlKFswXSwgQkNTLlU4KSwgLy8gZW5kcG9pbnRcclxuICAgICAgICAgICAgdHhiLm9iamVjdChwZXJtaXNzaW9uaWQpIC8vIHBlcm1cclxuICAgICAgICBdLCBcclxuICAgICAgICB0eXBlQXJndW1lbnRzOltcIjB4Mjo6c3VpOjpTVUlcIl1cclxuICAgIH0pO1xyXG4gICAgdHhiLm1vdmVDYWxsKHtcclxuICAgICAgICB0YXJnZXQ6U2VydmljZUZuKCdjcmVhdGUnKSBhcyBGbkNhbGxUeXBlLFxyXG4gICAgICAgIGFyZ3VtZW50czpbIHNlcnZpY2UgXSxcclxuICAgICAgICB0eXBlQXJndW1lbnRzOltcIjB4Mjo6c3VpOjpTVUlcIl1cclxuICAgIH0pO1xyXG4gICAgY29uc3QgcHJpdmtleSA9IGZyb21IRVgoU0VOREVSX1BSSVYpO1xyXG4gICAgY29uc3Qga2V5cGFpciA9IEVkMjU1MTlLZXlwYWlyLmZyb21TZWNyZXRLZXkocHJpdmtleSk7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IHsgc2hvd0lucHV0OiB0cnVlLFxyXG4gICAgICAgIHNob3dFZmZlY3RzOiB0cnVlLFxyXG4gICAgICAgIHNob3dFdmVudHM6IHRydWUsXHJcbiAgICAgICAgc2hvd0JhbGFuY2VDaGFuZ2VzOiB0cnVlLFxyXG4gICAgICAgIHNob3dPYmplY3RDaGFuZ2VzOiB0cnVlfTtcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY2xpZW50LnNpZ25BbmRFeGVjdXRlVHJhbnNhY3Rpb25CbG9jayh7XHJcbiAgICAgICAgdHJhbnNhY3Rpb25CbG9jazogdHhiLCBcclxuICAgICAgICBzaWduZXI6IGtleXBhaXIsXHJcbiAgICAgICAgb3B0aW9uc1xyXG4gICAgfSk7XHJcbn1cclxuY29uc3QgcGFzc3BvcnQgPSBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCBjbGllbnQgPSAgbmV3IFN1aUNsaWVudCh7IHVybDogZ2V0RnVsbG5vZGVVcmwoQ29uZmlnX0VudHJ5UG9pbnQpIH0pOyAgXHJcbiAgICBjb25zdCB0eGIgPSBuZXcgVHJhbnNhY3Rpb25CbG9jaygpO1xyXG5cclxuICAgIHZhciBwYXNzcG9ydCA9IHR4Yi5tb3ZlQ2FsbCh7XHJcbiAgICAgICAgdGFyZ2V0OiBQYXNzcG9ydEZuKCduZXcnKSBhcyBGbkNhbGxUeXBlLFxyXG4gICAgICAgIGFyZ3VtZW50czogWyB0eGIub2JqZWN0KGd1YXJkaWQpLCB0eGIub2JqZWN0KENMT0NLX09CSkVDVCldXHJcbiAgICB9KTsgLypcclxuICAgIHR4Yi5tb3ZlQ2FsbCh7XHJcbiAgICAgICAgdGFyZ2V0OiBQYXNzcG9ydEZuKCdndWFyZF9hZGQnKSBhcyBGbkNhbGxUeXBlLFxyXG4gICAgICAgIGFyZ3VtZW50czogWyBwYXNzcG9ydCwgdHhiLm9iamVjdChndWFyZGlkKV1cclxuICAgIH0pXHJcbiovXHJcbiAgICB0eGIubW92ZUNhbGwoe1xyXG4gICAgICAgIHRhcmdldDogUGFzc3BvcnRGbignZGVzdHJveScpIGFzIEZuQ2FsbFR5cGUsXHJcbiAgICAgICAgYXJndW1lbnRzOiBbIHBhc3Nwb3J0IF0gICAgICAgIFxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIGNvbnN0IHByaXZrZXkgPSBmcm9tSEVYKFNFTkRFUl9QUklWKTtcclxuICAgIGNvbnN0IGtleXBhaXIgPSBFZDI1NTE5S2V5cGFpci5mcm9tU2VjcmV0S2V5KHByaXZrZXkpO1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSB7IHNob3dFZmZlY3RzOiB0cnVlLH07XHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNsaWVudC5zaWduQW5kRXhlY3V0ZVRyYW5zYWN0aW9uQmxvY2soe1xyXG4gICAgICAgIHRyYW5zYWN0aW9uQmxvY2s6IHR4YiwgXHJcbiAgICAgICAgc2lnbmVyOiBrZXlwYWlyLFxyXG4gICAgICAgIG9wdGlvbnNcclxuICAgIH0pO1xyXG4gICAgcGFzc3BvcnRpZCA9IHJlc3BvbnNlLmVmZmVjdHM/LmNyZWF0ZWRbMF0ucmVmZXJlbmNlLm9iamVjdElkOyAgXHJcbiAgICBjb25zb2xlLmxvZyhcInBhc3Nwb3J0aWQ6IFwiICsgcGFzc3BvcnRpZCk7XHJcbn1cclxuY29uc3QgZGVtYW5kX3ByZXNlbnQgPSBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCBjbGllbnQgPSAgbmV3IFN1aUNsaWVudCh7IHVybDogZ2V0RnVsbG5vZGVVcmwoQ29uZmlnX0VudHJ5UG9pbnQpIH0pOyAgXHJcbiAgICBjb25zdCB0eGIgPSBuZXcgVHJhbnNhY3Rpb25CbG9jaygpO1xyXG5cclxuICAgIHR4Yi5tb3ZlQ2FsbCh7XHJcbiAgICAgICAgdGFyZ2V0OkRlbWFuZEZuKCdwcmVzZW50X3dpdGhfcGFzc3BvcnQnKSBhcyBGbkNhbGxUeXBlLFxyXG4gICAgICAgIGFyZ3VtZW50czpbXHJcbiAgICAgICAgICAgIHR4Yi5vYmplY3QocGFzc3BvcnRpZCksXHJcbiAgICAgICAgICAgIHR4Yi5vYmplY3QoZGVtYW5kaWQpLCAvLyBkZW1hbmRcclxuICAgICAgICAgICAgdHhiLm9iamVjdChzZXJ2aWNlaWQpLCAvLyBzZXJ2aWNlXHJcbiAgICAgICAgICAgIHR4Yi5wdXJlKCdoZWxsbycpXHJcbiAgICAgICAgXSxcclxuICAgICAgICB0eXBlQXJndW1lbnRzOltcIjB4Mjo6Y29pbjo6Q29pbjwweDI6OnN1aTo6U1VJPlwiLCBcIjB4Mjo6c3VpOjpTVUlcIl0sXHJcbiAgICB9KSAgXHJcbiAgICBcclxuICAgIGNvbnN0IHByaXZrZXkgPSBmcm9tSEVYKFNFTkRFUl9QUklWKTtcclxuICAgIGNvbnN0IGtleXBhaXIgPSBFZDI1NTE5S2V5cGFpci5mcm9tU2VjcmV0S2V5KHByaXZrZXkpO1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSB7IHNob3dJbnB1dDogdHJ1ZSxcclxuICAgICAgICBzaG93RWZmZWN0czogdHJ1ZSxcclxuICAgICAgICBzaG93RXZlbnRzOiB0cnVlLFxyXG4gICAgICAgIHNob3dCYWxhbmNlQ2hhbmdlczogdHJ1ZSxcclxuICAgICAgICBzaG93T2JqZWN0Q2hhbmdlczogdHJ1ZX07XHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNsaWVudC5zaWduQW5kRXhlY3V0ZVRyYW5zYWN0aW9uQmxvY2soe1xyXG4gICAgICAgIHRyYW5zYWN0aW9uQmxvY2s6IHR4YiwgXHJcbiAgICAgICAgc2lnbmVyOiBrZXlwYWlyLFxyXG4gICAgICAgIG9wdGlvbnNcclxuICAgIH0pO1xyXG4gICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xyXG59XHJcbmNvbnN0IGRlbWFuZF9ndWFyZCA9IGFzeW5jICgpID0+IHtcclxuICAgIGNvbnN0IGNsaWVudCA9ICBuZXcgU3VpQ2xpZW50KHsgdXJsOiBnZXRGdWxsbm9kZVVybChDb25maWdfRW50cnlQb2ludCkgfSk7ICBcclxuICAgIGNvbnN0IHR4YiA9IG5ldyBUcmFuc2FjdGlvbkJsb2NrKCk7XHJcblxyXG4gICAgdHhiLm1vdmVDYWxsKHtcclxuICAgICAgICB0YXJnZXQ6RGVtYW5kRm4oJ2d1YXJkX3NldCcpIGFzIEZuQ2FsbFR5cGUsXHJcbiAgICAgICAgYXJndW1lbnRzOlt0eGIub2JqZWN0KGRlbWFuZGlkKSwgXHJcbiAgICAgICAgICAgIHR4Yi5vYmplY3QoZ3VhcmRpZCksIC8vIGd1YXJkXHJcbiAgICAgICAgICAgIHR4Yi5vYmplY3QocGVybWlzc2lvbmlkKV0sIC8vIHBlcm1pc3Npb25cclxuICAgICAgICB0eXBlQXJndW1lbnRzOltcIjB4Mjo6Y29pbjo6Q29pbjwweDI6OnN1aTo6U1VJPlwiXSxcclxuICAgIH0pOyBcclxuXHJcbiAgICBjb25zdCBwcml2a2V5ID0gZnJvbUhFWChTRU5ERVJfUFJJVik7XHJcbiAgICBjb25zdCBrZXlwYWlyID0gRWQyNTUxOUtleXBhaXIuZnJvbVNlY3JldEtleShwcml2a2V5KTtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0geyBzaG93SW5wdXQ6IHRydWUsXHJcbiAgICAgICAgc2hvd0VmZmVjdHM6IHRydWUsXHJcbiAgICAgICAgc2hvd0V2ZW50czogdHJ1ZSxcclxuICAgICAgICBzaG93QmFsYW5jZUNoYW5nZXM6IHRydWUsXHJcbiAgICAgICAgc2hvd09iamVjdENoYW5nZXM6IHRydWV9O1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjbGllbnQuc2lnbkFuZEV4ZWN1dGVUcmFuc2FjdGlvbkJsb2NrKHtcclxuICAgICAgICB0cmFuc2FjdGlvbkJsb2NrOiB0eGIsIFxyXG4gICAgICAgIHNpZ25lcjoga2V5cGFpcixcclxuICAgICAgICBvcHRpb25zXHJcbiAgICB9KTtcclxuICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcclxufVxyXG5cclxuY29uc3QgZGVtYW5kID0gYXN5bmMgKCkgPT4geyBcclxuICAgIGNvbnN0IGNsaWVudCA9ICBuZXcgU3VpQ2xpZW50KHsgdXJsOiBnZXRGdWxsbm9kZVVybChDb25maWdfRW50cnlQb2ludCkgfSk7ICBcclxuICAgIGNvbnN0IHR4YiA9IG5ldyBUcmFuc2FjdGlvbkJsb2NrKCk7XHJcbiAgICBcclxuXHJcbi8qICB2YXIgcXVlcmllc19pbmZvICA9IGF3YWl0IGNsaWVudC5jYWxsKCdzdWlfZ2V0T2JqZWN0JywgXHJcbiAgICAgICAgWycweDc0YmI4NzhjM2M4NjM5NGFlMTM3ODA4MGU0OTcyOGU3YTYzZTY4YWMyOWQ4YjNkYTQ2ZDcyODM5YTA4MmFiY2YnLCBcclxuICAgICAgICB7XCJzaG93VHlwZVwiOiB0cnVlfV0pIGFzIFN1aU9iamVjdFJlc3BvbnNlW107ICBcclxuICAgIGNvbnNvbGUubG9nKHF1ZXJpZXNfaW5mbyk7ICovXHJcbiAgXHJcbiAgICBjb25zdCBjb2luID0gdHhiLnNwbGl0Q29pbnModHhiLmdhcywgW3R4Yi5wdXJlKDEwMDApXSk7XHJcblxyXG4gICAgXHJcbiAgICBsZXQgZGVtYW5kID0gdHhiLm1vdmVDYWxsKHtcclxuICAgICAgICB0YXJnZXQ6IERlbWFuZEZuKCdjcmVhdGUnKSBhcyBGbkNhbGxUeXBlLFxyXG4gICAgICAgIGFyZ3VtZW50czpbdHhiLnB1cmUoJ215IGRlbWFuZCcpLCAvLyBkZXNjXHJcbiAgICAgICAgY29pblswXSxcclxuICAgICAgICB0eGIub2JqZWN0KHBlcm1pc3Npb25pZCldLCAvLyBwZXJtaXNzaW9uXHJcbiAgICAgICAgdHlwZUFyZ3VtZW50czpbXCIweDI6OmNvaW46OkNvaW48MHgyOjpzdWk6OlNVST5cIl0sXHJcbiAgICB9KTsgXHJcbiAgICBjb25zdCBwcml2a2V5ID0gZnJvbUhFWChTRU5ERVJfUFJJVik7XHJcbiAgICBjb25zdCBrZXlwYWlyID0gRWQyNTUxOUtleXBhaXIuZnJvbVNlY3JldEtleShwcml2a2V5KTtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0geyBzaG93SW5wdXQ6IHRydWUsXHJcbiAgICAgICAgc2hvd0VmZmVjdHM6IHRydWUsXHJcbiAgICAgICAgc2hvd0V2ZW50czogdHJ1ZSxcclxuICAgICAgICBzaG93QmFsYW5jZUNoYW5nZXM6IHRydWUsXHJcbiAgICAgICAgc2hvd09iamVjdENoYW5nZXM6IHRydWV9O1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjbGllbnQuc2lnbkFuZEV4ZWN1dGVUcmFuc2FjdGlvbkJsb2NrKHtcclxuICAgICAgICB0cmFuc2FjdGlvbkJsb2NrOiB0eGIsIFxyXG4gICAgICAgIHNpZ25lcjoga2V5cGFpcixcclxuICAgICAgICBvcHRpb25zXHJcbiAgICB9KTtcclxufVxyXG4gIFxyXG5jb25zdCBzaW1wbGVfZ3VhcmRfdGVzdCA9IGFzeW5jICgpID0+IHtcclxuICAgIGNvbnN0IGNsaWVudCA9ICBuZXcgU3VpQ2xpZW50KHsgdXJsOiBnZXRGdWxsbm9kZVVybChDb25maWdfRW50cnlQb2ludCkgfSk7ICBcclxuICAgIGNvbnN0IHR4YiA9IG5ldyBUcmFuc2FjdGlvbkJsb2NrKCk7XHJcblxyXG4gICAgLy8gbmV3IGd1YXJkXHJcbiAgICBsZXQgc2Vuc2VfbWFrZXIgPSBuZXcgU2Vuc2VNYWtlcigpO1xyXG4gICAgc2Vuc2VfbWFrZXIuYWRkX3BhcmFtKERhdGFfVHlwZS5UWVBFX0NPTlRFWFRfU0lHTkVSKTtcclxuICAgIHNlbnNlX21ha2VyLmFkZF9wYXJhbShEYXRhX1R5cGUuVFlQRV9TVEFUSUNfYWRkcmVzcywgQUREUik7XHJcbiAgICBzZW5zZV9tYWtlci5hZGRfbG9naWMoRGF0YV9UeXBlLlRZUEVfTE9HSUNfT1BFUkFUT1JfRVFVQUwpO1xyXG4gICAgY29uc3Qgc2Vuc2UxID0gc2Vuc2VfbWFrZXIubWFrZShmYWxzZSwgR3VhcmRfU2Vuc2VfQmluZGVyLkFORCkgYXMgR3VhcmRfU2Vuc2U7XHJcbiAgICBjb25zdCBzZW5zZTIgPSBzZW5zZV9tYWtlci5tYWtlKGZhbHNlLCBHdWFyZF9TZW5zZV9CaW5kZXIuT1IpIGFzIEd1YXJkX1NlbnNlO1xyXG5cclxuICAgIGxldCBndWFyZF9kYXRhMSAgPSB7XHJcbiAgICAgICAgZGVzY3JpcHRpb246IFwic29tZSB3b3Jkcy5cIixcclxuICAgICAgICBzZW5zZXM6W3NlbnNlMSwgc2Vuc2UyXSwgXHJcbiAgICB9O1xyXG4gICAgbGV0IGd1YXJkX2RhdGEyICA9IHtcclxuICAgICAgICBkZXNjcmlwdGlvbjogXCJ4eHh4XCIsXHJcbiAgICAgICAgc2Vuc2VzOltzZW5zZTEsIHNlbnNlMl0sIFxyXG4gICAgfTtcclxuICAgIGNyZWF0ZV9ndWFyZCh0eGIsIGd1YXJkX2RhdGExKTtcclxuICAgIGNyZWF0ZV9ndWFyZCh0eGIsIGd1YXJkX2RhdGEyKTtcclxuICAgIGNvbnN0IHByaXZrZXkgPSBmcm9tSEVYKFNFTkRFUl9QUklWKTtcclxuICAgIGNvbnN0IGtleXBhaXIgPSBFZDI1NTE5S2V5cGFpci5mcm9tU2VjcmV0S2V5KHByaXZrZXkpO1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSB7IHNob3dFZmZlY3RzOiB0cnVlfTtcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY2xpZW50LnNpZ25BbmRFeGVjdXRlVHJhbnNhY3Rpb25CbG9jayh7XHJcbiAgICAgICAgdHJhbnNhY3Rpb25CbG9jazogdHhiLCBcclxuICAgICAgICBzaWduZXI6IGtleXBhaXIsXHJcbiAgICAgICAgb3B0aW9uc1xyXG4gICAgfSk7XHJcbiAgICB2YXIgZ3VhcmQxID0gcmVzcG9uc2UuZWZmZWN0cz8uY3JlYXRlZFswXS5yZWZlcmVuY2Uub2JqZWN0SWQ7ICBcclxuICAgIHZhciBndWFyZDIgPSByZXNwb25zZS5lZmZlY3RzPy5jcmVhdGVkWzFdLnJlZmVyZW5jZS5vYmplY3RJZDtcclxuICAgIGNvbnNvbGUubG9nKCdndWFyZDE6ICcgKyBndWFyZDEpOyBcclxuICAgIGNvbnNvbGUubG9nKCdndWFyZDI6ICcgKyBndWFyZDIpOyBcclxuXHJcbiAgICBjb25zdCBndWFyZF9xdWVyeSA9IHtndWFyZF9pZHM6W2d1YXJkMSwgZ3VhcmQyXSwgb2JqZWN0czpbXX07XHJcbiAgICBjb25zdCB0eGIyID0gbmV3IFRyYW5zYWN0aW9uQmxvY2soKTtcclxuICAgIGxldCBwYXNzcG9ydCA9IHZlcmlmeSh0eGIyLCBndWFyZF9xdWVyeSBhcyBHdWFyZF9RdWVyeV9PYmplY3RfUmVzdWx0KSBhcyBUcmFuc2FjdGlvblJlc3VsdCA7XHJcbiAgICBkZXN0cm95KHR4YjIsIHBhc3Nwb3J0KTtcclxuXHJcbiAgICBjb25zb2xlLmxvZyhhd2FpdCBjbGllbnQuc2lnbkFuZEV4ZWN1dGVUcmFuc2FjdGlvbkJsb2NrKHtcclxuICAgICAgICB0cmFuc2FjdGlvbkJsb2NrOiB0eGIyLCBcclxuICAgICAgICBzaWduZXI6IGtleXBhaXIsXHJcbiAgICAgICAgb3B0aW9uc1xyXG4gICAgfSkpO1xyXG59XHJcblxyXG5jb25zdCBxdWVyeV9ndWFyZF90ZXN0ID0gYXN5bmMgKHBlcm1pc3Npb25pZDpzdHJpbmdbXSkgPT4geyAgLy8gXHJcbiAgICBjb25zdCBjbGllbnQgPSAgbmV3IFN1aUNsaWVudCh7IHVybDogZ2V0RnVsbG5vZGVVcmwoQ29uZmlnX0VudHJ5UG9pbnQpIH0pOyAgXHJcbiAgICBjb25zdCB0eGIgPSBuZXcgVHJhbnNhY3Rpb25CbG9jaygpO1xyXG5cclxuICAgIC8vIG5ldyBndWFyZFxyXG4gICAgbGV0IHNlbnNlX21ha2VyID0gbmV3IFNlbnNlTWFrZXIoKTtcclxuICAgIHNlbnNlX21ha2VyLmFkZF9jbWQocGVybWlzc2lvbmlkWzBdLCAwKTsgLy8gY3JlYXRvciAtPiBhZGRyZXNzXHJcbiAgICBzZW5zZV9tYWtlci5hZGRfY21kKHBlcm1pc3Npb25pZFsxXSwgMSk7IC8vIHBlcm1pc3Npb246aXNfYWRtaW4gKyBhZGRyZXNzIC0+IGJvb2wgXHJcblxyXG4gICAgY29uc3Qgc2Vuc2UxID0gc2Vuc2VfbWFrZXIubWFrZShmYWxzZSwgR3VhcmRfU2Vuc2VfQmluZGVyLkFORCkgYXMgR3VhcmRfU2Vuc2U7XHJcbiAgICBcclxuICAgIGxldCBtYWtlcjIgPSBuZXcgU2Vuc2VNYWtlcigpO1xyXG4gICAgbWFrZXIyLmFkZF9wYXJhbShEYXRhX1R5cGUuVFlQRV9DT05URVhUX1NJR05FUik7XHJcbiAgICBtYWtlcjIuYWRkX3BhcmFtKERhdGFfVHlwZS5UWVBFX1NUQVRJQ19hZGRyZXNzLCBBRERSKTtcclxuICAgIG1ha2VyMi5hZGRfbG9naWMoRGF0YV9UeXBlLlRZUEVfTE9HSUNfT1BFUkFUT1JfRVFVQUwpO1xyXG5cclxuICAgIGNvbnN0IHNlbnNlMiA9IG1ha2VyMi5tYWtlKHRydWUsIEd1YXJkX1NlbnNlX0JpbmRlci5BTkQpIGFzICBHdWFyZF9TZW5zZTtcclxuICAgIGNvbnN0IHNlbnNlMyA9IHNlbnNlMTtcclxuXHJcbiAgICBsZXQgZ3VhcmRfZGF0YTEgID0ge1xyXG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIjFcIixcclxuICAgICAgICBzZW5zZXM6W3NlbnNlMSwgc2Vuc2UyLCBzZW5zZTNdLCBcclxuICAgIH07XHJcbiAgICBsZXQgZ3VhcmRfZGF0YTIgID0ge1xyXG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIjJcIixcclxuICAgICAgICBzZW5zZXM6W3NlbnNlMSwgc2Vuc2UyXSwgXHJcbiAgICB9OyAgICBcclxuXHJcbiAgICBjcmVhdGVfZ3VhcmQodHhiLCBndWFyZF9kYXRhMSk7XHJcbiAgICBjcmVhdGVfZ3VhcmQodHhiLCBndWFyZF9kYXRhMik7XHJcblxyXG4gICAgY29uc3QgcHJpdmtleSA9IGZyb21IRVgoU0VOREVSX1BSSVYpO1xyXG4gICAgY29uc3Qga2V5cGFpciA9IEVkMjU1MTlLZXlwYWlyLmZyb21TZWNyZXRLZXkocHJpdmtleSk7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IHsgc2hvd0VmZmVjdHM6IHRydWUgfTtcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY2xpZW50LnNpZ25BbmRFeGVjdXRlVHJhbnNhY3Rpb25CbG9jayh7XHJcbiAgICAgICAgdHJhbnNhY3Rpb25CbG9jazogdHhiLCBcclxuICAgICAgICBzaWduZXI6IGtleXBhaXIsXHJcbiAgICAgICAgb3B0aW9uc1xyXG4gICAgfSk7XHJcbiAgICB2YXIgZ3VhcmQxID0gcmVzcG9uc2UuZWZmZWN0cz8uY3JlYXRlZFswXS5yZWZlcmVuY2Uub2JqZWN0SWQgYXMgc3RyaW5nOyAgXHJcbiAgICB2YXIgZ3VhcmQyID0gcmVzcG9uc2UuZWZmZWN0cz8uY3JlYXRlZFsxXS5yZWZlcmVuY2Uub2JqZWN0SWQgYXMgc3RyaW5nO1xyXG4gICAgY29uc29sZS5sb2coJ2d1YXJkMTogJyArIGd1YXJkMSk7IFxyXG4gICAgY29uc29sZS5sb2coJ2d1YXJkMjogJyArIGd1YXJkMik7IFxyXG5cclxuICAgIC8vIHF1ZXJ5IG9iamVjdHNcclxuICAgIGNvbnN0IGd1YXJkX3F1ZXJ5ID0gYXdhaXQgcnBjX2d1YXJkX3F1ZXJ5X29iamVjdHMoQUREUiwgW2d1YXJkMSwgZ3VhcmQyXSkgOyAvLyBndWFyZHMuLi5cclxuICAgIGlmIChndWFyZF9xdWVyeSA9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnZ3VhcmRfcXVlcnkgZXJyb3InKTtcclxuICAgICAgICByZXR1cm4gXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgdHhiMiA9IG5ldyBUcmFuc2FjdGlvbkJsb2NrKCk7XHJcbiAgICBsZXQgcGFzc3BvcnQgPSB2ZXJpZnkodHhiMiwgZ3VhcmRfcXVlcnkgYXMgR3VhcmRfUXVlcnlfT2JqZWN0X1Jlc3VsdCkgYXMgVHJhbnNhY3Rpb25SZXN1bHQgO1xyXG4gICAgZGVzdHJveSh0eGIyLCBwYXNzcG9ydCk7XHJcblxyXG4gICAgY29uc29sZS5sb2coYXdhaXQgY2xpZW50LnNpZ25BbmRFeGVjdXRlVHJhbnNhY3Rpb25CbG9jayh7XHJcbiAgICAgICAgdHJhbnNhY3Rpb25CbG9jazogdHhiMiwgXHJcbiAgICAgICAgc2lnbmVyOiBrZXlwYWlyLFxyXG4gICAgICAgIG9wdGlvbnNcclxuICAgIH0pKTtcclxufVxyXG5jb25zdCBuZXdndWFyZDMgPSBhc3luYyAoKSA9PiB7IFxyXG4gICAgY29uc3QgY2xpZW50ID0gIG5ldyBTdWlDbGllbnQoeyB1cmw6IGdldEZ1bGxub2RlVXJsKENvbmZpZ19FbnRyeVBvaW50KSB9KTsgIFxyXG4gICAgY29uc3QgdHhiID0gbmV3IFRyYW5zYWN0aW9uQmxvY2soKTtcclxuXHJcbiAgICB0eGIubW92ZUNhbGwoeyBcclxuICAgICAgICB0YXJnZXQ6R3VhcmRGbignY3JlYXRvcl9ndWFyZCcpIGFzIEZuQ2FsbFR5cGUsXHJcbiAgICAgICAgYXJndW1lbnRzOltdXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBwcml2a2V5ID0gZnJvbUhFWChTRU5ERVJfUFJJVik7XHJcbiAgICBjb25zdCBrZXlwYWlyID0gRWQyNTUxOUtleXBhaXIuZnJvbVNlY3JldEtleShwcml2a2V5KTtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0geyBzaG93RWZmZWN0czogdHJ1ZSAgfTtcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY2xpZW50LnNpZ25BbmRFeGVjdXRlVHJhbnNhY3Rpb25CbG9jayh7XHJcbiAgICAgICAgdHJhbnNhY3Rpb25CbG9jazogdHhiLCBcclxuICAgICAgICBzaWduZXI6IGtleXBhaXIsXHJcbiAgICAgICAgb3B0aW9uc1xyXG4gICAgfSk7XHJcbiAgICBndWFyZGlkID0gcmVzcG9uc2UuZWZmZWN0cz8uY3JlYXRlZFswXS5yZWZlcmVuY2Uub2JqZWN0SWQ7ICBcclxuICAgIGNvbnNvbGUubG9nKCdndWFyZCBpZDogJyArIGd1YXJkaWQpO1xyXG59XHJcbm1haW4oKS50aGVuKGNvbnNvbGUubG9nKS5jYXRjaChjb25zb2xlLmVycm9yKTtcclxuLy92LmZvckVhY2goKGl0ZW0gOiBudW1iZXIpID0+IGNvbnNvbGUubG9nKGl0ZW0pKTtcclxuXHJcbiIsICJpbXBvcnQgeyBiY3MsIEJDUywgdG9IRVgsIGZyb21IRVgsIGdldFN1aU1vdmVDb25maWcgfSBmcm9tICdAbXlzdGVuL2Jjcyc7XHJcbmltcG9ydCB7IElucHV0cyB9IGZyb20gXCJAbXlzdGVuL3N1aS5qcy90cmFuc2FjdGlvbnNcIjtcclxuaW1wb3J0IHsgY2FwaXRhbGl6ZSB9IGZyb20gJy4vdXRpbCc7XHJcblxyXG5leHBvcnQgZW51bSBFTlRSWVBPSU5UIHtcclxuICAgIG1haW5uZXQgPSAnbWFpbm5ldCcsXHJcbiAgICB0ZXN0bmV0ID0gJ3Rlc3RuZXQnLFxyXG4gICAgZGV2bmV0ID0gJ2Rldm5ldCcsXHJcbiAgICBsb2NhbG5ldCA9ICdsb2NhbG5ldCdcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IENvbmZpZ19FbnRyeVBvaW50OkVOVFJZUE9JTlQgPSBFTlRSWVBPSU5ULmxvY2FsbmV0O1xyXG5cclxuXHJcbmV4cG9ydCBsZXQgUEFDS0FHRSA9IFwiMHg3N2I4M2FlODE5MDQxNTQxNDJlNDg2ODM3MzE4MDAyODU5MzJmZjQ5MzE3Y2RlMjQxYTJkZDgwNDYwZjVkZDM0XCI7IC8vIGFkZHJlc3MsIE5PVCBpZFxyXG4vLyB3b3dvayBkZWZhdWx0IGV2ZXJ5IGd1YXJkIGFkZHJlc3NcclxuZXhwb3J0IGNvbnN0IEVWRVJZT05FX0dVQVJEID0gXCIweDUxNjI3YmUxMDIxMWZhODFmNWQzMGU1NjhmYzBlMzIyOWE3NDZiMTJmMWI4YzFiN2QwYWJhYjNiNjI2ODBjMzVcIjtcclxuZXhwb3J0IGNvbnN0IFNFTkRFUl9QUklWID0gXCIweGM5YmJjMzBmNzJlZjdkOWFhNjc0YTNiZTE0NDhiOTI2NzE0MWE2NzZiNTlmM2Y0MzE1MjMxNjE3YTViYmMwZThcIjtcclxuZXhwb3J0IGNvbnN0IEFERFIgPSBcIjB4ZTM4NmJiOWUwMWIzNTI4Yjc1ZjM3NTFhZDhhMWU0MThiMjA3YWQ5NzlmZWEzNjQwODdkZWVmNTI1MGE3M2QzZlwiO1xyXG5cclxuXHJcbmV4cG9ydCBlbnVtIE1PRFVMRVMge1xyXG4gICAgbWFjaGluZSA9ICdtYWNoaW5lJyxcclxuICAgIG5vZGUgPSAnbm9kZScsXHJcbiAgICBwcm9ncmVzcyA9ICdwcm9ncmVzcycsXHJcbiAgICBjb21tdW5pdHkgPSAnY29tbXVuaXR5JyxcclxuICAgIHJlcG9zaXRvcnkgPSAncmVwb3NpdG9yeScsXHJcbiAgICBwZXJtaXNzaW9uID0gJ3Blcm1pc3Npb24nLFxyXG4gICAgcGFzc3BvcnQgPSAncGFzc3BvcnQnLFxyXG4gICAgZ3VhcmQgPSAnZ3VhcmQnLFxyXG4gICAgdm90ZSA9ICd2b3RlJyxcclxuICAgIGRlbWFuZCA9ICdkZW1hbmQnLFxyXG4gICAgb3JkZXIgPSAnb3JkZXInLFxyXG4gICAgcmV3YXJkID0gJ3Jld2FyZCcsXHJcbiAgICBzZXJ2aWNlID0gJ3NlcnZpY2UnLFxyXG4gICAgd293b2sgPSAnd293b2snLFxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgT0JKRUNUU19UWVBFX1BSRUZJWCA9IChPYmplY3Qua2V5cyhNT0RVTEVTKSBhcyBBcnJheTxrZXlvZiB0eXBlb2YgTU9EVUxFUz4pLm1hcCgoa2V5KSA9PiB7IHJldHVybiBQQUNLQUdFICsgJzo6JyArIGtleSArICc6Oic7IH0pXHJcbmV4cG9ydCBjb25zdCBPQkpFQ1RTX1RZUEUgPSAoT2JqZWN0LmtleXMoTU9EVUxFUykgYXMgQXJyYXk8a2V5b2YgdHlwZW9mIE1PRFVMRVM+KS5tYXAoKGtleSkgPT4geyBsZXQgaSA9IFBBQ0tBR0UgKyAnOjonICsga2V5ICsgJzo6JzsgcmV0dXJuIGkgKyBjYXBpdGFsaXplKGtleSk7IH0pXHJcblxyXG5leHBvcnQgdHlwZSBGbkNhbGxUeXBlID0gYCR7c3RyaW5nfTo6JHtzdHJpbmd9Ojoke3N0cmluZ31gO1xyXG5leHBvcnQgY29uc3QgTWFjaGluZUZuID0gKGZuOmFueSkgPT4geyByZXR1cm4gYCR7UEFDS0FHRX06OiR7TU9EVUxFUy5tYWNoaW5lfTo6JHtmbn1gfTtcclxuZXhwb3J0IGNvbnN0IE5vZGVGbiA9IChmbjogYW55KSA9PiB7IHJldHVybiBgJHtQQUNLQUdFfTo6JHtNT0RVTEVTLm5vZGV9Ojoke2ZufWB9O1xyXG5leHBvcnQgY29uc3QgUHJvZ3Jlc3NGbiA9IChmbjphbnkpID0+IHsgcmV0dXJuIGAke1BBQ0tBR0V9Ojoke01PRFVMRVMucHJvZ3Jlc3N9Ojoke2ZufWB9O1xyXG5leHBvcnQgY29uc3QgQ29tbXVuaXR5Rm4gPSAoZm46IGFueSkgPT4geyByZXR1cm4gYCR7UEFDS0FHRX06OiR7TU9EVUxFUy5jb21tdW5pdHl9Ojoke2ZufWB9O1xyXG5leHBvcnQgY29uc3QgUmVwb3NpdG9yeUZuID0gKGZuOmFueSkgPT4geyByZXR1cm4gYCR7UEFDS0FHRX06OiR7TU9EVUxFUy5yZXBvc2l0b3J5fTo6JHtmbn1gfTtcclxuZXhwb3J0IGNvbnN0IFBlcm1pc3Npb25GbiA9IChmbjogYW55KSA9PiB7IHJldHVybiBgJHtQQUNLQUdFfTo6JHtNT0RVTEVTLnBlcm1pc3Npb259Ojoke2ZufWB9O1xyXG5leHBvcnQgY29uc3QgUGFzc3BvcnRGbiA9IChmbjphbnkpID0+IHsgcmV0dXJuIGAke1BBQ0tBR0V9Ojoke01PRFVMRVMucGFzc3BvcnR9Ojoke2ZufWB9O1xyXG5leHBvcnQgY29uc3QgR3VhcmRGbiA9IChmbjogYW55KSA9PiB7IHJldHVybiBgJHtQQUNLQUdFfTo6JHtNT0RVTEVTLmd1YXJkfTo6JHtmbn1gfTtcclxuZXhwb3J0IGNvbnN0IFZvdGVGbiA9IChmbjphbnkpID0+IHsgcmV0dXJuIGAke1BBQ0tBR0V9Ojoke01PRFVMRVMudm90ZX06OiR7Zm59YH07XHJcbmV4cG9ydCBjb25zdCBEZW1hbmRGbiA9IChmbjogYW55KSA9PiB7IHJldHVybiBgJHtQQUNLQUdFfTo6JHtNT0RVTEVTLmRlbWFuZH06OiR7Zm59YH07XHJcbmV4cG9ydCBjb25zdCBPcmRlckZuID0gKGZuOmFueSkgPT4geyByZXR1cm4gYCR7UEFDS0FHRX06OiR7TU9EVUxFUy5vcmRlcn06OiR7Zm59YH07XHJcbmV4cG9ydCBjb25zdCBSZXdhcmRGbiA9IChmbjogYW55KSA9PiB7IHJldHVybiBgJHtQQUNLQUdFfTo6JHtNT0RVTEVTLnJld2FyZH06OiR7Zm59YH07XHJcbmV4cG9ydCBjb25zdCBTZXJ2aWNlRm4gPSAoZm46IGFueSkgPT4geyByZXR1cm4gYCR7UEFDS0FHRX06OiR7TU9EVUxFUy5zZXJ2aWNlfTo6JHtmbn1gfTtcclxuZXhwb3J0IGNvbnN0IFdvd29rRm4gPSAoZm46IGFueSkgPT4geyByZXR1cm4gYCR7UEFDS0FHRX06OiR7TU9EVUxFUy53b3dva306OiR7Zm59YH07XHJcblxyXG5leHBvcnQgY29uc3QgQ0xPQ0tfT0JKRUNUID0gSW5wdXRzLlNoYXJlZE9iamVjdFJlZih7XHJcbiAgICBvYmplY3RJZDpcIjB4NlwiLFxyXG4gICAgbXV0YWJsZTogZmFsc2UsXHJcbiAgICBpbml0aWFsU2hhcmVkVmVyc2lvbjogMSxcclxufSk7XHJcblxyXG5leHBvcnQgZW51bSBEYXRhX1R5cGUge1xyXG4gICAgVFlQRV9EWU5BTUlDX1FVRVJZID0gMSxcclxuICAgIFRZUEVfTE9HSUNfT1BFUkFUT1JfVTEyOF9HUkVBVEVSID0gMTEsXHJcbiAgICBUWVBFX0xPR0lDX09QRVJBVE9SX1UxMjhfR1JFQVRFUl9FUVVBTCA9IDEyLFxyXG4gICAgVFlQRV9MT0dJQ19PUEVSQVRPUl9VMTI4X0xFU1NFUiA9IDEzLFxyXG4gICAgVFlQRV9MT0dJQ19PUEVSQVRPUl9VMTI4X0xFU1NFUl9FUVVBTCA9IDE0LFxyXG4gICAgVFlQRV9MT0dJQ19PUEVSQVRPUl9VMTI4X0VRVUFMID0gMTUsXHJcbiAgICBUWVBFX0xPR0lDX09QRVJBVE9SX0VRVUFMID0gMTYsIC8vIFRZUEUmREFUQSh2ZWN0b3I8dTg+KSBNVVNUIEJFIEVRVUFMXHJcbiAgICBUWVBFX0xPR0lDX09QRVJBVE9SX0hBU19TVUJTVFJJTkcgPSAxNywgLy8gU1VCU1RSSU5HXHJcbiAgICBUWVBFX0xPR0lDX0FMV0FZU19UUlVFID0gMTgsIC8vIGF3YXlzIHRydWVcclxuICAgIC8vIFRZUEVfTE9HSUNfT1BFUkFUT1JfVkVDVThfQ09OVEFJTlMgPSAxOCwgLy8gU1VCIFZFQzxVOD5cclxuICAgIFRZUEVfQ09OVEVYVF9TSUdORVIgID0gNjAsXHJcbiAgICBUWVBFX0NPTlRFWFRfQ1VSUkVOVF9QUk9HUkVTUyA9IDYxLFxyXG4gICAgVFlQRV9DT05URVhUX0NVUlJFTlRfQ0xPQ0sgPSA2MixcclxuICAgIFRZUEVfU1RBVElDX2Jvb2wgPSAxMDAsXHJcbiAgICBUWVBFX1NUQVRJQ19hZGRyZXNzID0gMTAxLFxyXG4gICAgVFlQRV9TVEFUSUNfdTY0ID0gMTAyLFxyXG4gICAgVFlQRV9TVEFUSUNfdTggPSAxMDMsXHJcbiAgICBUWVBFX1NUQVRJQ191MTI4ID0gMTA0LFxyXG4gICAgVFlQRV9TVEFUSUNfdmVjX3U4ID0gMTA1LFxyXG4gICAgVFlQRV9TVEFUSUNfdmVjX2FkZHJlc3MgPSAxMDYsXHJcbiAgICBUWVBFX1NUQVRJQ192ZWNfYm9vbCA9IDEwNyxcclxuICAgIFRZUEVfU1RBVElDX3ZlY192ZWNfdTggPSAxMDgsXHJcbiAgICBUWVBFX1NUQVRJQ192ZWNfdTY0ID0gMTA5LFxyXG4gICAgVFlQRV9TVEFUSUNfdmVjX3UxMjggPSAxMTAsXHJcbiAgICBUWVBFX1NUQVRJQ19vcHRpb25fYWRkcmVzcyA9IDExMSxcclxuICAgIFRZUEVfU1RBVElDX29wdGlvbl9ib29sID0gMTEyLFxyXG4gICAgVFlQRV9TVEFUSUNfb3B0aW9uX3U4ID0gMTEzLFxyXG4gICAgVFlQRV9TVEFUSUNfb3B0aW9uX3U2NCA9IDExNCxcclxuICAgIFRZUEVfU1RBVElDX29wdGlvbl91MTI4ID0gMTE1LFxyXG4gICAgVFlQRV9TVEFUSUNfYnlfdmFsdWVfc3BlY2lmaWVkID0gMTI2LFxyXG4gICAgVFlQRV9TVEFUSUNfZXJyb3IgPSAxMjcsXHJcbn1cclxuXHJcblxyXG5leHBvcnQgY2xhc3MgQ29uZmlnIHtcclxuICAgIHByb3RlY3RlZCBuZXR3b3JrID0gRU5UUllQT0lOVC5sb2NhbG5ldDtcclxuXHJcbiAgICBwcm90ZWN0ZWQgY29uZmlnID0ge1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG4gICAgcHJvdGVjdGVkIHBhY2thZ2UgPSBcIjB4NzdiODNhZTgxOTA0MTU0MTQyZTQ4NjgzNzMxODAwMjg1OTMyZmY0OTMxN2NkZTI0MWEyZGQ4MDQ2MGY1ZGQzNFwiO1xyXG4gICAgcHJvdGVjdGVkIHNpZ25lciA9IFwiMHhlMzg2YmI5ZTAxYjM1MjhiNzVmMzc1MWFkOGExZTQxOGIyMDdhZDk3OWZlYTM2NDA4N2RlZWY1MjUwYTczZDNmXCI7XHJcbn1cclxuXHJcblxyXG5cclxuXHJcblxyXG4iLCAiXHJcbmV4cG9ydCBmdW5jdGlvbiB1bGViRGVjb2RlKGFycjogbnVtYmVyW10gfCBVaW50OEFycmF5KToge1xyXG5cdHZhbHVlOiBudW1iZXI7XHJcblx0bGVuZ3RoOiBudW1iZXI7XHJcbn0ge1xyXG5cdGxldCB0b3RhbCA9IDA7XHJcblx0bGV0IHNoaWZ0ID0gMDtcclxuXHRsZXQgbGVuID0gMDtcclxuXHJcblx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnN0YW50LWNvbmRpdGlvblxyXG5cdHdoaWxlICh0cnVlKSB7XHJcblx0XHRsZXQgYnl0ZSA9IGFycltsZW5dO1xyXG5cdFx0bGVuICs9IDE7XHJcblx0XHR0b3RhbCB8PSAoYnl0ZSAmIDB4N2YpIDw8IHNoaWZ0O1xyXG5cdFx0aWYgKChieXRlICYgMHg4MCkgPT09IDApIHtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHR9XHJcblx0XHRzaGlmdCArPSA3O1xyXG5cdH1cclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdHZhbHVlOiB0b3RhbCxcclxuXHRcdGxlbmd0aDogbGVuLFxyXG5cdH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjb25jYXRlbmF0ZShyZXN1bHRDb25zdHJ1Y3RvcjphbnksIC4uLmFycmF5czphbnlbXSkge1xyXG4gICAgbGV0IHRvdGFsTGVuZ3RoID0gMDtcclxuICAgIGZvciAoY29uc3QgYXJyIG9mIGFycmF5cykge1xyXG4gICAgICAgIHRvdGFsTGVuZ3RoICs9IGFyci5sZW5ndGg7XHJcbiAgICB9XHJcbiAgICBjb25zdCByZXN1bHQgPSBuZXcgcmVzdWx0Q29uc3RydWN0b3IodG90YWxMZW5ndGgpO1xyXG4gICAgbGV0IG9mZnNldCA9IDA7XHJcbiAgICBmb3IgKGNvbnN0IGFyciBvZiBhcnJheXMpIHtcclxuICAgICAgICByZXN1bHQuc2V0KGFyciwgb2Zmc2V0KTtcclxuICAgICAgICBvZmZzZXQgKz0gYXJyLmxlbmd0aDtcclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBhcnJheV9lcXVhbChhcnIxOiBhbnlbXSwgYXJyMjogYW55W10pIHtcclxuICAgIC8vIEFycmF5LnNvbWUoKTogXHU2NzA5XHU0RTAwXHU5ODc5XHU0RTBEXHU2RUUxXHU4REIzXHVGRjBDXHU4RkQ0XHU1NkRFZmFsc2VcclxuICAgIGlmIChhcnIxLmxlbmd0aCAhPT0gYXJyMi5sZW5ndGgpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuICFhcnIxLnNvbWUoKGl0ZW0pID0+ICFhcnIyLmluY2x1ZGVzKGl0ZW0pKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGFycmF5X3VuaXF1ZShhcnI6YW55W10pIDogYW55W10ge1xyXG4gICAgdmFyIG5ld0FyciA9IFtdO1xyXG4gICAgZm9yKHZhciBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGlmKG5ld0Fyci5pbmRleE9mKGFycltpXSkgPT0gLTEpIHtcclxuICAgICAgICAgICAgbmV3QXJyLnB1c2goYXJyW2ldKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbmV3QXJyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2FwaXRhbGl6ZSAoczpzdHJpbmcpIDogc3RyaW5nIHsgXHJcbiAgICByZXR1cm4gcyAmJiBzWzBdLnRvVXBwZXJDYXNlKCkgKyBzLnNsaWNlKDEpXHJcbn1cclxuXHJcbi8vIGZvcjogXCIweHNkamZrc2tmPDB4Mjo6c3VpOjpjb2luPHh4eD4sIDB4ZmRmZmY8Pj5cIlxyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2Vfb2JqZWN0X3R5cGUob2JqZWN0X2RhdGE6c3RyaW5nKSA6IHN0cmluZ1tdIHtcclxuICAgIHZhciBvYmplY3RfdHlwZSA6IHN0cmluZ1tdID0gW107XHJcbiAgICBsZXQgdHlwZV9wb3MgPSBvYmplY3RfZGF0YS5pbmRleE9mKCc8Jyk7XHJcbiAgICBpZiAodHlwZV9wb3MgPj0gMCkgeyBcclxuICAgICAgICBsZXQgdCA9IG9iamVjdF9kYXRhLnNsaWNlKCh0eXBlX3BvcysxKSwgb2JqZWN0X2RhdGEubGVuZ3RoLTEpO1xyXG4gICAgICAgIG9iamVjdF90eXBlID0gdC5zcGxpdCgnLCcpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG9iamVjdF90eXBlO1xyXG59IiwgImltcG9ydCB7IFN1aUNsaWVudCwgZ2V0RnVsbG5vZGVVcmwgfSBmcm9tICdAbXlzdGVuL3N1aS5qcy9jbGllbnQnO1xyXG5pbXBvcnQgeyBUcmFuc2FjdGlvbkJsb2NrLCBJbnB1dHMgfSBmcm9tICdAbXlzdGVuL3N1aS5qcy90cmFuc2FjdGlvbnMnO1xyXG5pbXBvcnQgeyBCQ1MsIGdldFN1aU1vdmVDb25maWcsIHRvSEVYLCBmcm9tSEVYLCBCY3NSZWFkZXIgfSBmcm9tICdAbXlzdGVuL2Jjcyc7XHJcbmltcG9ydCB7IEd1YXJkRm4sIEZuQ2FsbFR5cGUsIERhdGFfVHlwZSwgTU9EVUxFU30gZnJvbSAnLi9jb25maWcnO1xyXG5pbXBvcnQgeyBjb25jYXRlbmF0ZSwgYXJyYXlfZXF1YWwsIHVsZWJEZWNvZGUgfSBmcm9tICcuL3V0aWwnO1xyXG5cclxuZXhwb3J0IGVudW0gR3VhcmRfU2Vuc2VfQmluZGVyIHtcclxuICAgIEFORCA9IDEsIC8vIGZpcnN0IHNlbnNlIG9mIGd1YXJkIGFsd2F5cyBBTkQ7IGZvciBjb21iaW5pbmcgb3RoZXIgZ3VhcmRzXHJcbiAgICBPUiA9IDIsXHJcbn1cclxuXHJcbmV4cG9ydCB0eXBlIEd1YXJkX1NlbnNlID0geyBcclxuICAgIGlucHV0OiBVaW50OEFycmF5OyBcclxuICAgIG5vdEFmdGVyU2Vuc2U6IGJvb2xlYW47IFxyXG4gICAgYmluZGVyOkd1YXJkX1NlbnNlX0JpbmRlciA7XHJcbn07XHJcblxyXG5leHBvcnQgdHlwZSBHdWFyZF9EYXRhID0ge1xyXG4gICAgZGVzY3JpcHRpb246IHN0cmluZztcclxuICAgIHNlbnNlczogR3VhcmRfU2Vuc2VbXTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZV9ndWFyZCh0eGI6VHJhbnNhY3Rpb25CbG9jaywgZGF0YTpHdWFyZF9EYXRhKSB7XHJcbiAgICB2YXIgZ3VhcmQgPSB0eGIubW92ZUNhbGwoe1xyXG4gICAgICAgIHRhcmdldDogR3VhcmRGbignbmV3JykgYXMgRm5DYWxsVHlwZSxcclxuICAgICAgICBhcmd1bWVudHM6IFtcclxuICAgICAgICAgICAgdHhiLnB1cmUoZGF0YS5kZXNjcmlwdGlvbiAsIEJDUy5TVFJJTkcpLFxyXG4gICAgICAgIF0sICBcclxuICAgIH0pO1xyXG4gICAgZGF0YT8uc2Vuc2VzLmZvckVhY2goKHNlbnNlOiBHdWFyZF9TZW5zZSkgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHNlbnNlLmlucHV0KTtcclxuICAgICAgICB0eGIubW92ZUNhbGwoe1xyXG4gICAgICAgICAgICB0YXJnZXQ6IEd1YXJkRm4oJ3NlbnNlX2FkZCcpIGFzIEZuQ2FsbFR5cGUsXHJcbiAgICAgICAgICAgIGFyZ3VtZW50czpbXHJcbiAgICAgICAgICAgICAgICBndWFyZCxcclxuICAgICAgICAgICAgICAgIHR4Yi5wdXJlKFtdLnNsaWNlLmNhbGwoc2Vuc2UuaW5wdXQpKSxcclxuICAgICAgICAgICAgICAgIHR4Yi5wdXJlKHNlbnNlLm5vdEFmdGVyU2Vuc2UsIEJDUy5CT09MKSxcclxuICAgICAgICAgICAgICAgIHR4Yi5wdXJlKHNlbnNlLmJpbmRlciwgQkNTLlU4KSxcclxuICAgICAgICAgICAgXVxyXG4gICAgICAgIH0pXHJcbiAgICB9KTtcclxuICAgIHR4Yi5tb3ZlQ2FsbCh7XHJcbiAgICAgICAgdGFyZ2V0Okd1YXJkRm4oXCJjcmVhdGVcIikgYXMgRm5DYWxsVHlwZSxcclxuICAgICAgICBhcmd1bWVudHM6W2d1YXJkXVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzaWduZXJfZ3VhcmQodHhiOlRyYW5zYWN0aW9uQmxvY2spIHtcclxuICAgIHR4Yi5tb3ZlQ2FsbCh7XHJcbiAgICAgICAgdGFyZ2V0OiBHdWFyZEZuKCdjcmVhdG9yX2d1YXJkJykgYXMgRm5DYWxsVHlwZSxcclxuICAgICAgICBhcmd1bWVudHM6IFtdXHJcbiAgICB9KTsgLy8geyBraW5kOiAnUmVzdWx0JywgaW5kZXg6IDAgfSwgcmVmIHRvIGFkZHJlc3MgY291bGQgdXNlZCBieSBQVEJcclxufVxyXG5cclxuZXhwb3J0IHR5cGUgU2Vuc2VfQ21kX1R5cGUgPSB7XHJcbiAgICBtb2R1bGU6TU9EVUxFUywgXHJcbiAgICBuYW1lOnN0cmluZywgXHJcbiAgICBjbWQ6bnVtYmVyLCBcclxuICAgIHBhcmFtczpEYXRhX1R5cGVbXSwgXHJcbiAgICByZXN1bHQ6RGF0YV9UeXBlXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgU2Vuc2VfQ21kOmFueSA9IFtcclxuICAgIFtNT0RVTEVTLnBlcm1pc3Npb24sICdjcmVhdG9yJywgMSwgW10sIERhdGFfVHlwZS5UWVBFX1NUQVRJQ19hZGRyZXNzXSxcclxuICAgIFtNT0RVTEVTLnBlcm1pc3Npb24sICdpc19hZG1pbicsIDIsIFtEYXRhX1R5cGUuVFlQRV9TVEFUSUNfYWRkcmVzc10sIERhdGFfVHlwZS5UWVBFX1NUQVRJQ19ib29sXSxcclxuICAgIFtNT0RVTEVTLnBlcm1pc3Npb24sICdoYXNfcmlnaHRzJywgMywgW0RhdGFfVHlwZS5UWVBFX1NUQVRJQ19hZGRyZXNzLCBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfdTY0XSwgRGF0YV9UeXBlLlRZUEVfU1RBVElDX2Jvb2xdLFxyXG4gICAgW01PRFVMRVMucGVybWlzc2lvbiwgJ2NvbnRhaW5zX2FkZHJlc3MnLCA0LCBbRGF0YV9UeXBlLlRZUEVfU1RBVElDX2FkZHJlc3NdLCBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfYm9vbF0sXHJcbiAgICBbTU9EVUxFUy5wZXJtaXNzaW9uLCAnY29udGFpbnNfaW5kZXgnLCA1LCBbRGF0YV9UeXBlLlRZUEVfU1RBVElDX2FkZHJlc3MsIERhdGFfVHlwZS5UWVBFX1NUQVRJQ191NjRdLCBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfYm9vbF0sXHJcbiAgICBbTU9EVUxFUy5wZXJtaXNzaW9uLCAnY29udGFpbnNfZ3VhcmQnLCA2LCBbRGF0YV9UeXBlLlRZUEVfU1RBVElDX2FkZHJlc3MsIERhdGFfVHlwZS5UWVBFX1NUQVRJQ191NjRdLCBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfYm9vbF0sXHJcbiAgICBbTU9EVUxFUy5yZXBvc2l0b3J5LCAncGVybWlzc2lvbicsIDEsIFtdLCBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfYWRkcmVzc10sXHJcbiAgICBbTU9EVUxFUy5yZXBvc2l0b3J5LCAncG9saWN5X2NvbnRhaW5zJywgMiwgW0RhdGFfVHlwZS5UWVBFX1NUQVRJQ192ZWNfdThdLCBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfYm9vbF0sXHJcbiAgICBbTU9EVUxFUy5yZXBvc2l0b3J5LCAncG9saWN5X2hhc19wZXJtaXNzaW9uX2luZGV4JywgMywgW0RhdGFfVHlwZS5UWVBFX1NUQVRJQ192ZWNfdThdLCBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfYm9vbF0sXHJcbiAgICBbTU9EVUxFUy5yZXBvc2l0b3J5LCAncG9saWN5X3Blcm1pc3Npb25faW5kZXgnLCA0LCBbRGF0YV9UeXBlLlRZUEVfU1RBVElDX3ZlY191OF0sIERhdGFfVHlwZS5UWVBFX1NUQVRJQ191NjRdLFxyXG4gICAgW01PRFVMRVMucmVwb3NpdG9yeSwgJ3BvbGljeV92YWx1ZV90eXBlJywgNSwgW0RhdGFfVHlwZS5UWVBFX1NUQVRJQ192ZWNfdThdLCBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfdThdLFxyXG4gICAgW01PRFVMRVMucmVwb3NpdG9yeSwgJ2NvbnRhaW5zX2lkJywgNiwgW0RhdGFfVHlwZS5UWVBFX1NUQVRJQ19hZGRyZXNzXSwgRGF0YV9UeXBlLlRZUEVfU1RBVElDX2Jvb2xdLCAgIFxyXG4gICAgW01PRFVMRVMucmVwb3NpdG9yeSwgJ2NvbnRhaW5zX3ZhbHVlJywgNywgW0RhdGFfVHlwZS5UWVBFX1NUQVRJQ19hZGRyZXNzLCBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfdmVjX3U4XSwgRGF0YV9UeXBlLlRZUEVfU1RBVElDX2Jvb2xdLFxyXG4gICAgW01PRFVMRVMucmVwb3NpdG9yeSwgJ3ZhbHVlX3dpdGhvdXRfdHlwZScsIDgsIFtEYXRhX1R5cGUuVFlQRV9TVEFUSUNfYWRkcmVzcywgRGF0YV9UeXBlLlRZUEVfU1RBVElDX3ZlY191OF0sIERhdGFfVHlwZS5UWVBFX1NUQVRJQ192ZWNfdThdLCAgICAgICBcclxuICAgIFtNT0RVTEVTLnJlcG9zaXRvcnksICd2YWx1ZScsIDksIFtEYXRhX1R5cGUuVFlQRV9TVEFUSUNfYWRkcmVzcywgRGF0YV9UeXBlLlRZUEVfU1RBVElDX3ZlY191OF0sIERhdGFfVHlwZS5UWVBFX1NUQVRJQ192ZWNfdThdLFxyXG4gICAgW01PRFVMRVMucmVwb3NpdG9yeSwgJ3R5cGUnLCAxMCwgW10sIERhdGFfVHlwZS5UWVBFX1NUQVRJQ191OF0sICAgXHJcbiAgICBbTU9EVUxFUy5yZXBvc2l0b3J5LCAncG9saWN5X21vZGUnLCAxMSwgW10sIERhdGFfVHlwZS5UWVBFX1NUQVRJQ191OF0sICAgXHJcbl1cclxuXHJcbmV4cG9ydCBjbGFzcyBTZW5zZU1ha2VyIHtcclxuICAgIHByb3RlY3RlZCBkYXRhIDogVWludDhBcnJheVtdID0gW107XHJcbiAgICBwcm90ZWN0ZWQgdHlwZV92YWxpZGF0b3IgOiBEYXRhX1R5cGVbXSA9IFtdO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkgeyB9XHJcbiAgICAvLyBzZXJpYWxpemUgY29uc3QgJiBkYXRhXHJcbiAgICBhZGRfcGFyYW0odHlwZTpEYXRhX1R5cGUsIHBhcmFtPzphbnkpIDogYm9vbGVhbiB7XHJcbiAgICAgICAgY29uc3QgYmNzID0gbmV3IEJDUyhnZXRTdWlNb3ZlQ29uZmlnKCkpO1xyXG4gICAgICAgIHN3aXRjaCh0eXBlKSAge1xyXG4gICAgICAgIGNhc2UgRGF0YV9UeXBlLlRZUEVfU1RBVElDX2FkZHJlc3M6IFxyXG4gICAgICAgICAgICB0aGlzLmRhdGEucHVzaChiY3Muc2VyKEJDUy5VOCwgdHlwZSkudG9CeXRlcygpKTtcclxuICAgICAgICAgICAgdGhpcy5kYXRhLnB1c2goYmNzLnNlcihCQ1MuQUREUkVTUywgcGFyYW0pLnRvQnl0ZXMoKSk7XHJcbiAgICAgICAgICAgIHRoaXMudHlwZV92YWxpZGF0b3IucHVzaCh0eXBlKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfYm9vbDpcclxuICAgICAgICAgICAgdGhpcy5kYXRhLnB1c2goYmNzLnNlcihCQ1MuVTgsIHR5cGUpLnRvQnl0ZXMoKSk7XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YS5wdXNoKGJjcy5zZXIoQkNTLkJPT0wsIHBhcmFtKS50b0J5dGVzKCkpO1xyXG4gICAgICAgICAgICB0aGlzLnR5cGVfdmFsaWRhdG9yLnB1c2godHlwZSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgRGF0YV9UeXBlLlRZUEVfU1RBVElDX3U4OlxyXG4gICAgICAgICAgICB0aGlzLmRhdGEucHVzaChiY3Muc2VyKEJDUy5VOCwgdHlwZSkudG9CeXRlcygpKTtcclxuICAgICAgICAgICAgdGhpcy5kYXRhLnB1c2goYmNzLnNlcihCQ1MuVTgsIHBhcmFtKS50b0J5dGVzKCkpO1xyXG4gICAgICAgICAgICB0aGlzLnR5cGVfdmFsaWRhdG9yLnB1c2godHlwZSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgRGF0YV9UeXBlLlRZUEVfU1RBVElDX3U2NDogXHJcbiAgICAgICAgICAgIHRoaXMuZGF0YS5wdXNoKGJjcy5zZXIoQkNTLlU4LCB0eXBlKS50b0J5dGVzKCkpO1xyXG4gICAgICAgICAgICB0aGlzLmRhdGEucHVzaChiY3Muc2VyKEJDUy5VNjQsIHBhcmFtKS50b0J5dGVzKCkpO1xyXG4gICAgICAgICAgICB0aGlzLnR5cGVfdmFsaWRhdG9yLnB1c2godHlwZSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgRGF0YV9UeXBlLlRZUEVfU1RBVElDX3ZlY191ODpcclxuICAgICAgICAgICAgdGhpcy5kYXRhLnB1c2goYmNzLnNlcihCQ1MuVTgsIHR5cGUpLnRvQnl0ZXMoKSk7XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YS5wdXNoKGJjcy5zZXIoXCJ2ZWN0b3I8dTg+XCIsIHBhcmFtKS50b0J5dGVzKCkpO1xyXG4gICAgICAgICAgICB0aGlzLnR5cGVfdmFsaWRhdG9yLnB1c2godHlwZSk7XHJcbiAgICAgICAgICAgIC8vIHRoaXMuZGF0YVt0aGlzLmRhdGEubGVuZ3RoLTFdLmZvckVhY2goKGl0ZW0gOiBudW1iZXIpID0+IGNvbnNvbGUubG9nKGl0ZW0pKVxyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIERhdGFfVHlwZS5UWVBFX0NPTlRFWFRfU0lHTkVSOlxyXG4gICAgICAgICAgICB0aGlzLmRhdGEucHVzaChiY3Muc2VyKEJDUy5VOCwgdHlwZSkudG9CeXRlcygpKTtcclxuICAgICAgICAgICAgdGhpcy50eXBlX3ZhbGlkYXRvci5wdXNoKERhdGFfVHlwZS5UWVBFX1NUQVRJQ19hZGRyZXNzKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9DT05URVhUX0NVUlJFTlRfQ0xPQ0s6XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YS5wdXNoKGJjcy5zZXIoQkNTLlU4LCB0eXBlKS50b0J5dGVzKCkpO1xyXG4gICAgICAgICAgICB0aGlzLnR5cGVfdmFsaWRhdG9yLnB1c2goRGF0YV9UeXBlLlRZUEVfU1RBVElDX3U2NCk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgRGF0YV9UeXBlLlRZUEVfQ09OVEVYVF9DVVJSRU5UX1BST0dSRVNTOlxyXG4gICAgICAgICAgICB0aGlzLmRhdGEucHVzaChiY3Muc2VyKEJDUy5VOCwgdHlwZSkudG9CeXRlcygpKTtcclxuICAgICAgICAgICAgdGhpcy50eXBlX3ZhbGlkYXRvci5wdXNoKERhdGFfVHlwZS5UWVBFX1NUQVRJQ19hZGRyZXNzKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICBhZGRfY21kKG9iamVjdF9hZGRyZXNzOnN0cmluZywgc2Vuc2VfaW5kZXg6bnVtYmVyKSA6IGJvb2xlYW4ge1xyXG4gICAgICAgIGlmIChzZW5zZV9pbmRleCA+PSBTZW5zZV9DbWQubGVuZ3RoKSB7IHJldHVybiBmYWxzZTsgfVxyXG4gICAgICAgIGxldCBvZmZzZXQgPSB0aGlzLnR5cGVfdmFsaWRhdG9yLmxlbmd0aCAtIFNlbnNlX0NtZFtzZW5zZV9pbmRleF1bM10ubGVuZ3RoO1xyXG4gICAgICAgIGlmIChvZmZzZXQgPCAwKSB7IFxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7IFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IHR5cGVzID0gdGhpcy50eXBlX3ZhbGlkYXRvci5zbGljZShvZmZzZXQpO1xyXG4gICAgICAgIGlmICghYXJyYXlfZXF1YWwodHlwZXMsIFNlbnNlX0NtZFtzZW5zZV9pbmRleF1bM10pKSB7IC8vIHR5cGUgdmFsaWRhdGUgXHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTsgXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IGJjcyA9IG5ldyBCQ1MoZ2V0U3VpTW92ZUNvbmZpZygpKTtcclxuICAgICAgICB0aGlzLmRhdGEucHVzaChiY3Muc2VyKEJDUy5VOCwgRGF0YV9UeXBlLlRZUEVfRFlOQU1JQ19RVUVSWSkudG9CeXRlcygpKTsgLy8gVFlQRVxyXG4gICAgICAgIHRoaXMuZGF0YS5wdXNoKGJjcy5zZXIoQkNTLkFERFJFU1MsIG9iamVjdF9hZGRyZXNzKS50b0J5dGVzKCkpOyAvLyBvYmplY3QgYWRkcmVzc1xyXG4gICAgICAgIHRoaXMuZGF0YS5wdXNoKGJjcy5zZXIoQkNTLlU4LCBTZW5zZV9DbWRbc2Vuc2VfaW5kZXhdWzJdKS50b0J5dGVzKCkpOyAvLyBjbWRcclxuXHJcbiAgICAgICAgdGhpcy50eXBlX3ZhbGlkYXRvci5zcGxpY2Uob2Zmc2V0LCBTZW5zZV9DbWRbc2Vuc2VfaW5kZXhdWzNdLmxlbmd0aCk7IC8vIGRlbGV0ZSB0eXBlIHN0YWNrXHJcbiAgICAgICAgdGhpcy50eXBlX3ZhbGlkYXRvci5wdXNoKFNlbnNlX0NtZFtzZW5zZV9pbmRleF1bNF0pOyAvLyBhZGQgdGhlIHJldHVybiB2YWx1ZSB0eXBlIHRvIHR5cGUgc3RhY2tcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnR5cGVfdmFsaWRhdG9yKVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgYWRkX2xvZ2ljKHR5cGU6RGF0YV9UeXBlKSA6IGJvb2xlYW4ge1xyXG4gICAgICAgIHN3aXRjaCAodHlwZSkge1xyXG4gICAgICAgICAgICBjYXNlIERhdGFfVHlwZS5UWVBFX0xPR0lDX09QRVJBVE9SX1UxMjhfR1JFQVRFUjpcclxuICAgICAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9MT0dJQ19PUEVSQVRPUl9VMTI4X0dSRUFURVJfRVFVQUw6XHJcbiAgICAgICAgICAgIGNhc2UgRGF0YV9UeXBlLlRZUEVfTE9HSUNfT1BFUkFUT1JfVTEyOF9MRVNTRVI6XHJcbiAgICAgICAgICAgIGNhc2UgRGF0YV9UeXBlLlRZUEVfTE9HSUNfT1BFUkFUT1JfVTEyOF9MRVNTRVJfRVFVQUw6XHJcbiAgICAgICAgICAgIGNhc2UgRGF0YV9UeXBlLlRZUEVfTE9HSUNfT1BFUkFUT1JfVTEyOF9FUVVBTDpcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnR5cGVfdmFsaWRhdG9yLmxlbmd0aCA8IDIpICB7IHJldHVybiBmYWxzZTsgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFtYXRjaF91MTI4KHRoaXMudHlwZV92YWxpZGF0b3JbdGhpcy50eXBlX3ZhbGlkYXRvci5sZW5ndGggLSAxXSkpIHsgcmV0dXJuIGZhbHNlOyB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIW1hdGNoX3UxMjgodGhpcy50eXBlX3ZhbGlkYXRvclt0aGlzLnR5cGVfdmFsaWRhdG9yLmxlbmd0aCAtIDJdKSkgeyByZXR1cm4gZmFsc2U7IH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIERhdGFfVHlwZS5UWVBFX0xPR0lDX09QRVJBVE9SX0VRVUFMOlxyXG4gICAgICAgICAgICBjYXNlIERhdGFfVHlwZS5UWVBFX0xPR0lDX09QRVJBVE9SX0hBU19TVUJTVFJJTkc6XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50eXBlX3ZhbGlkYXRvci5sZW5ndGggPCAyKSAgeyByZXR1cm4gZmFsc2U7IH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBiY3MgPSBuZXcgQkNTKGdldFN1aU1vdmVDb25maWcoKSk7XHJcbiAgICAgICAgdGhpcy5kYXRhLnB1c2goYmNzLnNlcihCQ1MuVTgsIHR5cGUpLnRvQnl0ZXMoKSk7IC8vIFRZUEUgICAgIFxyXG4gICAgICAgIHRoaXMudHlwZV92YWxpZGF0b3Iuc3BsaWNlKHRoaXMudHlwZV92YWxpZGF0b3IubGVuZ3RoIC0gMik7IC8vIGRlbGV0ZSB0eXBlIHN0YWNrICAgXHJcbiAgICAgICAgdGhpcy50eXBlX3ZhbGlkYXRvci5wdXNoKERhdGFfVHlwZS5UWVBFX1NUQVRJQ19ib29sKTsgLy8gYWRkIGJvb2wgdG8gdHlwZSBzdGFja1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIG1ha2UoYk5vdEFmdGVyU2Vuc2U6Ym9vbGVhbiwgYmluZGVyOkd1YXJkX1NlbnNlX0JpbmRlcikgOiB1bmRlZmluZWQgfCBHdWFyZF9TZW5zZSB7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLnR5cGVfdmFsaWRhdG9yKTtcclxuICAgICAgICAvL3RoaXMuZGF0YS5mb3JFYWNoKCh2YWx1ZTpVaW50OEFycmF5KSA9PiBjb25zb2xlLmxvZyh2YWx1ZSkpO1xyXG4gICAgICAgIGlmICh0aGlzLnR5cGVfdmFsaWRhdG9yLmxlbmd0aCAhPSAxIHx8IHRoaXMudHlwZV92YWxpZGF0b3JbMF0gIT0gRGF0YV9UeXBlLlRZUEVfU1RBVElDX2Jvb2wpIHsgXHJcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgfSAvLyBFUlJPUlxyXG5cclxuICAgICAgICBsZXQgaW5wdXQgPSBjb25jYXRlbmF0ZShVaW50OEFycmF5LCAuLi50aGlzLmRhdGEpIGFzIFVpbnQ4QXJyYXk7XHJcbiAgICAgICAgY29uc3Qgc2Vuc2U6R3VhcmRfU2Vuc2UgPSB7aW5wdXQ6aW5wdXQsIG5vdEFmdGVyU2Vuc2U6Yk5vdEFmdGVyU2Vuc2UsIGJpbmRlcjpiaW5kZXJ9O1xyXG4gICAgICAgIHJldHVybiBzZW5zZTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gbWF0Y2hfdTEyOCh0eXBlOkRhdGFfVHlwZSkgOiBib29sZWFuIHtcclxuICAgIGlmICh0eXBlID09IERhdGFfVHlwZS5UWVBFX1NUQVRJQ19vcHRpb25fdTggfHwgXHJcbiAgICAgICAgdHlwZSA9PSBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfb3B0aW9uX3U2NCB8fCBcclxuICAgICAgICB0eXBlID09IERhdGFfVHlwZS5UWVBFX1NUQVRJQ19vcHRpb25fdTEyOCApIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn1cclxuXHJcbi8vIHBhcnNlIGd1YXJkIHNlbnNlcyBpbnB1dCBieXRlcyBvZiBhIGd1YXJkLCByZXR1cm4gW29iamVjdGlkc10gZm9yICdxdWVyeV9jbWQnIFxyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2Vfc2Vuc2VfYnNjKGNoYWluX3NlbnNlX2JzYzpVaW50OEFycmF5KSAgOiB1bmRlZmluZWQgfCBzdHJpbmdbXSB7XHJcbiAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgIHZhciBhcnJheSA9IFtdLnNsaWNlLmNhbGwoY2hhaW5fc2Vuc2VfYnNjLnJldmVyc2UoKSk7XHJcbiAgICBjb25zdCBiY3MgPSBuZXcgQkNTKGdldFN1aU1vdmVDb25maWcoKSk7XHJcbiAgICB2YXIgcmVzdWx0ID0gW107XHJcbiAgICB3aGlsZSAoYXJyYXkubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHZhciB0eXBlIDogdW5rbm93biA9IGFycmF5LnNoaWZ0KCkgO1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHR5cGUpO1xyXG4gICAgICAgIHN3aXRjaCAodHlwZSBhcyBEYXRhX1R5cGUpIHtcclxuICAgICAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9DT05URVhUX1NJR05FUjpcclxuICAgICAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9DT05URVhUX0NVUlJFTlRfQ0xPQ0s6XHJcbiAgICAgICAgICAgIGNhc2UgRGF0YV9UeXBlLlRZUEVfQ09OVEVYVF9DVVJSRU5UX1BST0dSRVNTOlxyXG4gICAgICAgICAgICBjYXNlIERhdGFfVHlwZS5UWVBFX0xPR0lDX09QRVJBVE9SX1UxMjhfR1JFQVRFUjpcclxuICAgICAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9MT0dJQ19PUEVSQVRPUl9VMTI4X0dSRUFURVJfRVFVQUw6XHJcbiAgICAgICAgICAgIGNhc2UgRGF0YV9UeXBlLlRZUEVfTE9HSUNfT1BFUkFUT1JfVTEyOF9MRVNTRVI6XHJcbiAgICAgICAgICAgIGNhc2UgRGF0YV9UeXBlLlRZUEVfTE9HSUNfT1BFUkFUT1JfVTEyOF9MRVNTRVJfRVFVQUw6XHJcbiAgICAgICAgICAgIGNhc2UgRGF0YV9UeXBlLlRZUEVfTE9HSUNfT1BFUkFUT1JfVTEyOF9FUVVBTDpcclxuICAgICAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9MT0dJQ19PUEVSQVRPUl9FUVVBTDpcclxuICAgICAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9MT0dJQ19PUEVSQVRPUl9IQVNfU1VCU1RSSU5HOlxyXG4gICAgICAgICAgICBicmVhazsgICAgXHJcbiAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfYWRkcmVzczogXHJcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJzB4JyArIGJjcy5kZShCQ1MuQUREUkVTUywgIFVpbnQ4QXJyYXkuZnJvbShhcnJheSkpLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgICAgICBhcnJheS5zcGxpY2UoMCwgMzIpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIERhdGFfVHlwZS5UWVBFX1NUQVRJQ19ib29sOlxyXG4gICAgICAgIGNhc2UgRGF0YV9UeXBlLlRZUEVfU1RBVElDX3U4OlxyXG4gICAgICAgICAgICBhcnJheS5zcGxpY2UoMCwgMSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgRGF0YV9UeXBlLlRZUEVfU1RBVElDX3U2NDogXHJcbiAgICAgICAgICAgIGFycmF5LnNwbGljZSgwLCA4KTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfdTEyODogXHJcbiAgICAgICAgICAgIGFycmF5LnNwbGljZSgwLCAxNik7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgRGF0YV9UeXBlLlRZUEVfU1RBVElDX3ZlY191ODpcclxuICAgICAgICAgICAgbGV0IHt2YWx1ZSwgbGVuZ3RofSA9IHVsZWJEZWNvZGUoVWludDhBcnJheS5mcm9tKGFycmF5KSk7XHJcbiAgICAgICAgICAgIGFycmF5LnNwbGljZSgwLCB2YWx1ZStsZW5ndGgpO1xyXG4gICAgICAgICAgICBicmVhazsgICAgIFxyXG4gICAgICAgIGNhc2UgRGF0YV9UeXBlLlRZUEVfRFlOQU1JQ19RVUVSWTpcclxuICAgICAgICAgICAgcmVzdWx0LnB1c2goJzB4JyArIGJjcy5kZShCQ1MuQUREUkVTUywgIFVpbnQ4QXJyYXkuZnJvbShhcnJheSkpLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgICAgICBhcnJheS5zcGxpY2UoMCwgMzMpOyAvLyBhZGRyZXNzICsgY21kXHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdwYXJzZV9zZW5zZV9ic2M6dW5kZWZpbmVkJyk7XHJcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7IC8vIGVycm9yXHJcbiAgICAgICAgfVxyXG4gICAgfSBcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcblxyXG4iLCAiaW1wb3J0IHsgU3VpQ2xpZW50LCBnZXRGdWxsbm9kZVVybCwgU3VpT2JqZWN0UmVzcG9uc2UgfSBmcm9tICdAbXlzdGVuL3N1aS5qcy9jbGllbnQnO1xyXG5pbXBvcnQgeyBUcmFuc2FjdGlvbkJsb2NrLCBJbnB1dHMsIHR5cGUgVHJhbnNhY3Rpb25PYmplY3RJbnB1dCB9IGZyb20gJ0BteXN0ZW4vc3VpLmpzL3RyYW5zYWN0aW9ucyc7XHJcbmltcG9ydCB7IEVkMjU1MTlLZXlwYWlyIH0gZnJvbSAnQG15c3Rlbi9zdWkuanMva2V5cGFpcnMvZWQyNTUxOSc7XHJcbmltcG9ydCB7IEJDUywgZ2V0U3VpTW92ZUNvbmZpZywgdG9IRVgsIGZyb21IRVgsIEJjc1JlYWRlciB9IGZyb20gJ0BteXN0ZW4vYmNzJztcclxuaW1wb3J0IHsgRU5UUllQT0lOVCwgR3VhcmRGbiwgRm5DYWxsVHlwZSwgT0JKRUNUU19UWVBFLCBPQkpFQ1RTX1RZUEVfUFJFRklYLCBNT0RVTEVTLCBQQUNLQUdFLCBDb25maWdfRW50cnlQb2ludH0gZnJvbSAnLi9jb25maWcnO1xyXG5pbXBvcnQgeyBwYXJzZV9zZW5zZV9ic2MgfSBmcm9tICcuL2d1YXJkJztcclxuaW1wb3J0IHsgY29uY2F0ZW5hdGUsIGFycmF5X3VuaXF1ZSwgY2FwaXRhbGl6ZSwgcGFyc2Vfb2JqZWN0X3R5cGUgfSBmcm9tICcuL3V0aWwnO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBRdWVyeSB7XHJcblxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgTUFYX0dVQVJEID0gNDtcclxuZXhwb3J0IHR5cGUgR3VhcmRfUXVlcnlfT2JqZWN0ID0ge1xyXG4gICAgdGFyZ2V0OiBGbkNhbGxUeXBlLFxyXG4gICAgb2JqZWN0OiBUcmFuc2FjdGlvbk9iamVjdElucHV0LFxyXG4gICAgdHlwZXM6IHN0cmluZ1tdLFxyXG59XHJcbmV4cG9ydCB0eXBlIEd1YXJkX1F1ZXJ5X09iamVjdF9SZXN1bHQgPSB7XHJcbiAgICBndWFyZF9pZHM6IHN0cmluZ1tdLFxyXG4gICAgb2JqZWN0czogR3VhcmRfUXVlcnlfT2JqZWN0W10sXHJcbn1cclxuXHJcbi8vIHF1ZXJ5IGd1YXJkIG9iamVjdHMgdGhhdCBjb3VsZCBjYWxsICdxdWVyeV9jbWQnIGZvciBwYXNzcG9ydCB2ZXJpZnlpbmdcclxuLy8gMS4gYXdhaXQgc2Vuc2VzX3ZlYywgZ2V0IHNlbnNlcyBmb3IgZ3VhcmRzXHJcbi8vIDIuIHBhcnNlIHNlbnNlcyB0byBmaW5kIGFsbCBndWFyZF9xdWVyeSBjYWxscyBhbmQgb2JqZWN0aWRzXHJcbi8vIDMuIGF3YWl0IGFsbCBndWFyZF9xdWVyeSBvYmplY3RzIGluZm9tYXRpb25cclxuZXhwb3J0IGNvbnN0IHJwY19ndWFyZF9xdWVyeV9vYmplY3RzID0gYXN5bmMgKHNlbmRlcl9hZGRyOnN0cmluZywgZ3VhcmRfaWRzOnN0cmluZ1tdKSA6IFxyXG4gICAgUHJvbWlzZTxHdWFyZF9RdWVyeV9PYmplY3RfUmVzdWx0IHwgdW5kZWZpbmVkID4gPT4ge1xyXG4gICAgaWYgKGd1YXJkX2lkcy5sZW5ndGggPT0gMCkgeyByZXR1cm4ge2d1YXJkX2lkczpndWFyZF9pZHMsIG9iamVjdHM6W119IH1cclxuICAgIGlmIChndWFyZF9pZHMubGVuZ3RoID4gTUFYX0dVQVJEKSB7IFxyXG4gICAgICAgIHJldHVybiB1bmRlZmluZWQgO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNsaWVudCA9ICBuZXcgU3VpQ2xpZW50KHsgdXJsOiBnZXRGdWxsbm9kZVVybChDb25maWdfRW50cnlQb2ludCkgfSk7ICBcclxuICAgIGNvbnN0IHR4YiA9IG5ldyBUcmFuc2FjdGlvbkJsb2NrKCk7XHJcbiAgICBcclxuICAgIC8vIGd1YXJkOjpzZW5zZXNfdmVjIC0+IHNlbnNlcyBieXRlc1xyXG4gICAgZm9yIChsZXQgaSA9IDA7ICBpIDwgZ3VhcmRfaWRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdHhiLm1vdmVDYWxsKHtcclxuICAgICAgICAgICAgdGFyZ2V0Okd1YXJkRm4oJ3NlbnNlc192ZWMnKSBhcyBGbkNhbGxUeXBlLFxyXG4gICAgICAgICAgICBhcmd1bWVudHM6IFt0eGIub2JqZWN0KGd1YXJkX2lkc1tpXSldXHJcbiAgICAgICAgfSk7ICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICB2YXIgb2JqZWN0c19pbmZvID0gYXdhaXQgY2xpZW50LmRldkluc3BlY3RUcmFuc2FjdGlvbkJsb2NrKHtzZW5kZXI6c2VuZGVyX2FkZHIsIHRyYW5zYWN0aW9uQmxvY2s6dHhifSk7XHJcbiAgICB2YXIgb2JqZWN0czpzdHJpbmdbXSA9IFtdO1xyXG4gICAgY29uc3QgYmNzID0gbmV3IEJDUyhnZXRTdWlNb3ZlQ29uZmlnKCkpO1xyXG5cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgKG9iamVjdHNfaW5mby5yZXN1bHRzIGFzIGFueVtdKT8ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBsZXQgcmV0ID0gKG9iamVjdHNfaW5mby5yZXN1bHRzIGFzIGFueVtdKVtpXS5yZXR1cm5WYWx1ZXMgYXMgYW55W107XHJcbiAgICAgICAgdmFyIGJ1ZiA9IG5ldyBVaW50OEFycmF5OyBcclxuICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IHJldC5sZW5ndGg7IGsrKykgeyAvLyBbZGF0YSwgJ3ZlY3Rvcjx1OD4nXVxyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXRba10pO1xyXG4gICAgICAgICAgICAvLyBsaXN0IG9mIG9iamVjdHMgdG8gJ3F1ZXJ5X2NtZCdcclxuICAgICAgICAgICAgb2JqZWN0cyA9IG9iamVjdHMuY29uY2F0KChwYXJzZV9zZW5zZV9ic2MobmV3IFVpbnQ4QXJyYXkoYmNzLmRlKFwidmVjdG9yPHU4PlwiLCBVaW50OEFycmF5LmZyb20ocmV0W2tdWzBdKSkpLnJldmVyc2UoKSkpIGFzIHN0cmluZ1tdKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKG9iamVjdHMgPT0gdW5kZWZpbmVkIHx8IG9iamVjdHMubGVuZ3RoID09IDApIHJldHVybiB7Z3VhcmRfaWRzOmd1YXJkX2lkcywgb2JqZWN0czpbXX07XHJcbiAgICBjb25zb2xlLmxvZyhvYmplY3RzKVxyXG5cclxuICAgIC8vIHVuaXF1ZSBvYmplY3RzIGZvciBxdWVyeSBvYmplY3QgaW5mb21hdGlvblxyXG4gICAgdmFyIHF1ZXJpZXMgPSBhcnJheV91bmlxdWUob2JqZWN0cyBhcyBzdHJpbmdbXSk7IFxyXG4gICAgdmFyIHF1ZXJpZXNfaW5mbyAgPSBhd2FpdCBjbGllbnQuY2FsbCgnc3VpX211bHRpR2V0T2JqZWN0cycsIFtxdWVyaWVzLCB7XCJzaG93VHlwZVwiOiB0cnVlfV0pIGFzIFN1aU9iamVjdFJlc3BvbnNlW107ICBcclxuXHJcbiAgICAvLyBbW2ZuLCBvYmpyZWZdXSBmb3IgJ3F1ZXJ5X2NtZCdcclxuICAgIGxldCByZXN1bHQgOiBHdWFyZF9RdWVyeV9PYmplY3RbXSA9IFtdOyBsZXQgYkZvdW5kIDogYm9vbGVhbjtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgb2JqZWN0cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGJGb3VuZCA9IGZhbHNlO1xyXG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgcXVlcmllc19pbmZvLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgIGlmIChxdWVyaWVzX2luZm9bal0uZGF0YT8ub2JqZWN0SWQgPT0gb2JqZWN0c1tpXSkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBPQkpFQ1RTX1RZUEUubGVuZ3RoOyBrKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocXVlcmllc19pbmZvW2pdLmRhdGE/LnR5cGU/LmluY2x1ZGVzKE9CSkVDVFNfVFlQRVtrXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGZuID0gT0JKRUNUU19UWVBFX1BSRUZJWFtrXSArICdndWFyZF9xdWVyeScgYXMgRm5DYWxsVHlwZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG9iaiA9IElucHV0cy5TaGFyZWRPYmplY3RSZWYoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0SWQ6IG9iamVjdHNbaV0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtdXRhYmxlOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluaXRpYWxTaGFyZWRWZXJzaW9uOiBxdWVyaWVzX2luZm9bal0uZGF0YSEudmVyc2lvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSkgYXMgVHJhbnNhY3Rpb25PYmplY3RJbnB1dDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHR5cGVzID0gcGFyc2Vfb2JqZWN0X3R5cGUocXVlcmllc19pbmZvW2pdLmRhdGE/LnR5cGUgYXMgc3RyaW5nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goe3RhcmdldDpmbiwgb2JqZWN0Om9iaiwgdHlwZXM6dHlwZXN9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coaSArICcgICBpZDogJyArIG9iamVjdHNbaV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiRm91bmQgPSB0cnVlOyBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGJGb3VuZCkgYnJlYWs7ICAgICAgIFxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWJGb3VuZCkgcmV0dXJuIHVuZGVmaW5lZDsgLy8gc29tZSBvYmplY3Qgbm90IG1hdGNoIGluZm9cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge2d1YXJkX2lkczpndWFyZF9pZHMsIG9iamVjdHM6cmVzdWx0fTsgXHJcbn0iLCAiXHJcbmltcG9ydCB7IFN1aUNsaWVudCwgZ2V0RnVsbG5vZGVVcmwsIFN1aU9iamVjdFJlc3BvbnNlIH0gZnJvbSAnQG15c3Rlbi9zdWkuanMvY2xpZW50JztcclxuaW1wb3J0IHsgVHJhbnNhY3Rpb25CbG9jaywgSW5wdXRzLCB0eXBlIFRyYW5zYWN0aW9uUmVzdWx0IH0gZnJvbSAnQG15c3Rlbi9zdWkuanMvdHJhbnNhY3Rpb25zJztcclxuaW1wb3J0IHsgRWQyNTUxOUtleXBhaXIgfSBmcm9tICdAbXlzdGVuL3N1aS5qcy9rZXlwYWlycy9lZDI1NTE5JztcclxuaW1wb3J0IHsgQkNTLCBnZXRTdWlNb3ZlQ29uZmlnLCB0b0hFWCwgZnJvbUhFWCwgQmNzUmVhZGVyIH0gZnJvbSAnQG15c3Rlbi9iY3MnO1xyXG5pbXBvcnQgeyBDb25maWdfRW50cnlQb2ludCwgQ0xPQ0tfT0JKRUNULCBQYXNzcG9ydEZuLCBHdWFyZEZuLCBGbkNhbGxUeXBlLCBEYXRhX1R5cGUsIE1PRFVMRVMsIFNFTkRFUl9QUklWLCBBRERSLCBQQUNLQUdFLCBTZXJ2aWNlRm4sIFBlcm1pc3Npb25GbiwgRGVtYW5kRm59IGZyb20gJy4vY29uZmlnJztcclxuaW1wb3J0IHsgU2Vuc2VNYWtlciwgR3VhcmRfU2Vuc2VfQmluZGVyLCBjcmVhdGVfZ3VhcmQsIHBhcnNlX3NlbnNlX2JzYywgR3VhcmRfU2Vuc2UgfSBmcm9tICcuL2d1YXJkJztcclxuaW1wb3J0IHsgY29uY2F0ZW5hdGUsIGFycmF5X3VuaXF1ZSwgY2FwaXRhbGl6ZSwgcGFyc2Vfb2JqZWN0X3R5cGV9IGZyb20gJy4vdXRpbCc7XHJcbmltcG9ydCB7IEd1YXJkX1F1ZXJ5X09iamVjdF9SZXN1bHQsIHJwY19ndWFyZF9xdWVyeV9vYmplY3RzIH0gZnJvbSAnLi9xdWVyeSdcclxuaW1wb3J0IHsgdmVyaWZ5LCBkZXN0cm95LCAgfSBmcm9tICcuL3Bhc3Nwb3J0J1xyXG5cclxuZXhwb3J0IGVudW0gUGVybWlzc2lvbkluZGV4IHtcclxuICAgIHJlcG9zaXRvcnlfZGVzY3JpcHRpb25fc2V0ID0gMTAxLFxyXG4gICAgcmVwb3NpdG9yeV9wb2xpY3lfbW9kZV9zZXQgPSAxMDIsXHJcbiAgICByZXBvc2l0b3J5X3BvbGljeV9hZGQgPSAxMDYsXHJcbiAgICByZXBvc2l0b3J5X3BvbGljeV9yZW1vdmUgPSAxMDcsXHJcbiAgICByZXBvc2l0b3J5X3BvbGljeV9yZW1vdmVfYWxsID0gMTA3LFxyXG4gICAgcmVwb3NpdG9yeV9wb2xpY3lfZGVzY3JpcHRpb25fc2V0ID0gMTA5LFxyXG4gICAgcmVwb3NpdG9yeV9wb2xpY3lfb3BlbmZ1bmNpbmRleF9zZXQgPSAxMTAsXHJcblxyXG59XHJcbmV4cG9ydCB0eXBlIFBlcm1pc3Npb25fSW5kZXggPSB7XHJcbiAgICBpbmRleDpQZXJtaXNzaW9uSW5kZXg7XHJcbiAgICBndWFyZD86c3RyaW5nO1xyXG59XHJcbmV4cG9ydCB0eXBlIFBlcm1pc3Npb25fRW50aXR5ID0ge1xyXG4gICAgd2hvOnN0cmluZztcclxuICAgIHBlcm1pc3Npb25zOlBlcm1pc3Npb25fSW5kZXhbXTtcclxufVxyXG5cclxuZXhwb3J0IHR5cGUgUGVybWlzc2lvbl9EYXRhID0ge1xyXG4gICAgZGVzY3JpcHRpb246IHN0cmluZztcclxuICAgIGVudGl0aWVzOiBQZXJtaXNzaW9uX0VudGl0eVtdO1xyXG4gICAgYWRtaW46IHN0cmluZ1tdO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlX3Blcm1pc3Npb24odHhiOlRyYW5zYWN0aW9uQmxvY2ssIGRhdGE6UGVybWlzc2lvbl9EYXRhKSB7XHJcbiAgICBsZXQgcGVybWlzc2lvbiA9IHR4Yi5tb3ZlQ2FsbCh7XHJcbiAgICAgICAgdGFyZ2V0OiBQZXJtaXNzaW9uRm4oJ25ldycpIGFzIEZuQ2FsbFR5cGUsXHJcbiAgICAgICAgYXJndW1lbnRzOiBbdHhiLnB1cmUoZGF0YS5kZXNjcmlwdGlvbildXHJcbiAgICB9KTtcclxuICAgICAgICBcclxuICAgIGxldCBndWFyZHM6YW55W10gID0gW107XHJcbiAgICBjb25zb2xlLmxvZyhkYXRhLmVudGl0aWVzKTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5lbnRpdGllcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGxldCBlbnRpdHkgPSBkYXRhLmVudGl0aWVzW2ldO1xyXG4gICAgICAgIGxldCBpbmRleGVzID0gW107XHJcblxyXG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgIGVudGl0eS5wZXJtaXNzaW9ucy5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICBsZXQgaW5kZXggPSBlbnRpdHkucGVybWlzc2lvbnNbal07XHJcbiAgICAgICAgICAgIGlmIChpbmRleD8uZ3VhcmQgJiYgaW5kZXguZ3VhcmQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZ3VhcmRzLnB1c2goe3dobzplbnRpdHkud2hvLCBpbmRleDppbmRleC5pbmRleCwgZ3VhcmQ6aW5kZXguZ3VhcmR9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpbmRleGVzLnB1c2goaW5kZXguaW5kZXgpOyAgICAgICAgICAgIFxyXG4gICAgICAgIH0gICAgXHJcbiAgICAgICAgaWYgKGluZGV4ZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgIHR4Yi5tb3ZlQ2FsbCh7XHJcbiAgICAgICAgICAgICAgICB0YXJnZXQ6UGVybWlzc2lvbkZuKCdhZGRfYmF0Y2gnKSBhcyBGbkNhbGxUeXBlLFxyXG4gICAgICAgICAgICAgICAgYXJndW1lbnRzOltwZXJtaXNzaW9uLCB0eGIucHVyZShlbnRpdHkud2hvLCBCQ1MuQUREUkVTUyksIHR4Yi5wdXJlKHBlcm1pc3Npb24sICd2ZWN0b3I8dTY0PicpXVxyXG4gICAgICAgICAgICB9KSAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGNvbnNvbGUubG9nKGd1YXJkcyk7XHJcbiAgICAvLyBzZXQgZ3VhcmRzXHJcbiAgICBndWFyZHMuZm9yRWFjaCgoe3dobywgaW5kZXgsIGd1YXJkfSkgPT4ge1xyXG4gICAgICAgIHR4Yi5tb3ZlQ2FsbCh7XHJcbiAgICAgICAgICAgIHRhcmdldDpQZXJtaXNzaW9uRm4oJ2d1YXJkX3NldCcpIGFzIEZuQ2FsbFR5cGUsXHJcbiAgICAgICAgICAgIGFyZ3VtZW50czpbIHBlcm1pc3Npb24sIHR4Yi5wdXJlKHdobywgQkNTLkFERFJFU1MpLCB0eGIucHVyZShpbmRleCwgQkNTLlU2NCksIHR4Yi5vYmplY3QoZ3VhcmQpXVxyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG5cclxuICAgIC8vIGFkbWluc1xyXG4gICAgdHhiLm1vdmVDYWxsKHtcclxuICAgICAgICB0YXJnZXQ6UGVybWlzc2lvbkZuKCdhZG1pbl9hZGRfYmF0Y2gnKSAgYXMgRm5DYWxsVHlwZSxcclxuICAgICAgICBhcmd1bWVudHM6WyBwZXJtaXNzaW9uLCB0eGIucHVyZShkYXRhLmFkbWluLCAndmVjdG9yPGFkZHJlc3M+JyldXHJcbiAgICB9KTtcclxuICAgIHR4Yi5tb3ZlQ2FsbCh7XHJcbiAgICAgICAgdGFyZ2V0OlBlcm1pc3Npb25GbignY3JlYXRlJykgIGFzIEZuQ2FsbFR5cGUsXHJcbiAgICAgICAgYXJndW1lbnRzOlsgcGVybWlzc2lvbiBdICAgICAgICBcclxuICAgIH0pXHJcbn0iXSwKICAibWFwcGluZ3MiOiAiO0FBQUEsU0FBUyxhQUFBQSxZQUFXLGtCQUFBQyx1QkFBeUM7QUFDN0QsU0FBUyxvQkFBQUMseUJBQXdEO0FBQ2pFLFNBQVMsc0JBQXNCO0FBQy9CLFNBQVMsT0FBQUMsTUFBOEIsV0FBQUMsZ0JBQTBCOzs7QUNGakUsU0FBUyxjQUFjOzs7QUN5RGhCLFNBQVMsV0FBWSxHQUFtQjtBQUMzQyxTQUFPLEtBQUssRUFBRSxDQUFDLEVBQUUsWUFBWSxJQUFJLEVBQUUsTUFBTSxDQUFDO0FBQzlDOzs7QURqRE8sSUFBTSxvQkFBK0I7QUFHckMsSUFBSSxVQUFVO0FBR2QsSUFBTSxjQUFjO0FBQ3BCLElBQU0sT0FBTztBQUdiLElBQUssVUFBTCxrQkFBS0MsYUFBTDtBQUNILEVBQUFBLFNBQUEsYUFBVTtBQUNWLEVBQUFBLFNBQUEsVUFB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ZUFBZTtBQU1uQixJQUFNLE9BQU8sWUFBWTtBQVdyQixNQUFJLGdCQUFnQixNQUFNLFdBQVcsZUFBZTtBQUNwRCxVQUFRLElBQUksWUFBWTtBQU01QjtBQUVBLElBQU0sa0JBQW1DO0FBQUEsRUFDckMsYUFBYTtBQUFBLEVBQ2IsT0FBTyxDQUFDLE1BQU0sc0VBQXNFLG9FQUFvRTtBQUFBLEVBQ3hKLFVBQVU7QUFBQSxJQUNOLEVBQUMsS0FBSSxzRUFBc0UsYUFBWTtBQUFBLE1BQ25GLEVBQUMsdUNBQTJDO0FBQUEsTUFDNUMsRUFBQyw0Q0FBZ0Q7QUFBQSxJQUNyRCxFQUFDO0FBQUEsSUFDRCxFQUFDLEtBQUksc0VBQXNFLGFBQVk7QUFBQSxNQUNuRixFQUFDLDBDQUE4QztBQUFBLE1BQy9DLEVBQUMsMkNBQWdELE9BQU0scUVBQW9FO0FBQUEsSUFDL0gsRUFBQztBQUFBLElBQ0QsRUFBQyxLQUFLLE1BQU0sYUFBWSxDQUFDLEVBQUM7QUFBQSxFQUM5QjtBQUNKO0FBRUEsSUFBTSxhQUFhLE9BQU8sU0FBMkM7QUFDakUsUUFBTSxTQUFVLElBQUlFLFdBQVUsRUFBRSxLQUFLQyxnQkFBZSxpQkFBaUIsRUFBRSxDQUFDO0FBQ3hFLFFBQU0sTUFBTSxJQUFJQyxrQkFBaUI7QUFFakMsb0JBQWtCLEtBQUssSUFBSTtBQUUzQixRQUFNLFVBQVVDLFNBQVEsV0FBVztBQUNuQyxRQUFNLFVBQVUsZUFBZSxjQUFjLE9BQU87QUFFcEQsUUFBTSxVQUFVLEVBQUUsYUFBYSxLQUFLO0FBQ3BDLFFBQU0sV0FBVyxNQUFNLE9BQU8sK0JBQStCO0FBQUEsSUFDekQsa0JBQWtCO0FBQUEsSUFDbEIsUUFBUTtBQUFBLElBQ1I7QUFBQSxFQUNKLENBQUM7QUFDRCxNQUFJQyxnQkFBZSxTQUFTLFNBQVMsUUFBUSxDQUFDLEVBQUUsVUFBVTtBQUMxRCxVQUFRLElBQUksbUJBQW1CQSxhQUFZO0FBQzNDLFNBQU9BO0FBQ1g7QUFnU0EsS0FBSyxFQUFFLEtBQUssUUFBUSxHQUFHLEVBQUUsTUFBTSxRQUFRLEtBQUs7IiwKICAibmFtZXMiOiBbIlN1aUNsaWVudCIsICJnZXRGdWxsbm9kZVVybCIsICJUcmFuc2FjdGlvbkJsb2NrIiwgIkJDUyIsICJmcm9tSEVYIiwgIk1PRFVMRVMiLCAiSW5wdXRzIiwgIkJDUyIsICJnZXRTdWlNb3ZlQ29uZmlnIiwgIkJDUyIsICJwZXJtaXNzaW9uIiwgIkJDUyIsICJTdWlDbGllbnQiLCAiZ2V0RnVsbG5vZGVVcmwiLCAiVHJhbnNhY3Rpb25CbG9jayIsICJmcm9tSEVYIiwgInBlcm1pc3Npb25pZCJdCn0K

	
process.argv = [process.argv[0], ...process.argv.slice(3)];

		import __esrun_url from 'url';

		import { createRequire as __esrun_createRequire } from "module";

		const __esrun_fileUrl = __esrun_url.pathToFileURL("\wowok\test\node_modules\.bin\esrun-1709189068216.tmp.mjs");

		const require = __esrun_createRequire(__esrun_fileUrl);
// src/index.ts
import { SuiClient as SuiClient2, getFullnodeUrl as getFullnodeUrl2 } from "../../node_modules/@mysten/sui.js/dist/esm/client/index.js";
import { TransactionBlock as TransactionBlock2 } from "../../node_modules/@mysten/sui.js/dist/esm/builder/export.js";
import { Ed25519Keypair } from "../../node_modules/@mysten/sui.js/dist/esm/keypairs/ed25519/index.js";
import { BCS as BCS4, fromHEX as fromHEX4 } from "../../node_modules/@mysten/bcs/dist/esm/index.js";

// src/config.ts
import { Inputs } from "../../node_modules/@mysten/sui.js/dist/esm/builder/export.js";

// src/util.ts
function capitalize(s) {
  return s && s[0].toUpperCase() + s.slice(1);
}

// src/config.ts
var Config_EntryPoint = "localnet" /* localnet */;
var PACKAGE = "0x77b83ae81904154142e48683731800285932ff49317cde241a2dd80460f5dd34";
var SENDER_PRIV = "0xc9bbc30f72ef7d9aa674a3be1448b9267141a676b59f3f4315231617a5bbc0e8";
var ADDR = "0xe386bb9e01b3528b75f3751ad8a1e418b207ad979fea364087deef5250a73d3f";
var MODULES = /* @__PURE__ */ ((MODULES5) => {
  MODULES5["machine"] = "machine";
  MODULES5["node"] = "node";
  MODULES5["progress"] = "progress";
  MODULES5["community"] = "community";
  MODULES5["repository"] = "repository";
  MODULES5["permission"] = "permission";
  MODULES5["passport"] = "passport";
  MODULES5["guard"] = "guard";
  MODULES5["vote"] = "vote";
  MODULES5["demand"] = "demand";
  MODULES5["order"] = "order";
  MODULES5["reward"] = "reward";
  MODULES5["service"] = "service";
  MODULES5["wowok"] = "wowok";
  return MODULES5;
})(MODULES || {});
var OBJECTS_TYPE_PREFIX = Object.keys(MODULES).map((key) => {
  return PACKAGE + "::" + key + "::";
});
var OBJECTS_TYPE = Object.keys(MODULES).map((key) => {
  let i = PACKAGE + "::" + key + "::";
  return i + capitalize(key);
});
var PermissionFn = (fn) => {
  return `${PACKAGE}::${"permission" /* permission */}::${fn}`;
};
var CLOCK_OBJECT = Inputs.SharedObjectRef({
  objectId: "0x6",
  mutable: false,
  initialSharedVersion: 1
});

// src/guard.ts
import { BCS, getSuiMoveConfig } from "../../node_modules/@mysten/bcs/dist/esm/index.js";
var Sense_Cmd = [
  ["permission" /* permission */, "creator", 1, [], 101 /* TYPE_STATIC_address */],
  ["permission" /* permission */, "is_admin", 2, [101 /* TYPE_STATIC_address */], 100 /* TYPE_STATIC_bool */],
  ["permission" /* permission */, "has_rights", 3, [101 /* TYPE_STATIC_address */, 102 /* TYPE_STATIC_u64 */], 100 /* TYPE_STATIC_bool */],
  ["permission" /* permission */, "contains_address", 4, [101 /* TYPE_STATIC_address */], 100 /* TYPE_STATIC_bool */],
  ["permission" /* permission */, "contains_index", 5, [101 /* TYPE_STATIC_address */, 102 /* TYPE_STATIC_u64 */], 100 /* TYPE_STATIC_bool */],
  ["permission" /* permission */, "contains_guard", 6, [101 /* TYPE_STATIC_address */, 102 /* TYPE_STATIC_u64 */], 100 /* TYPE_STATIC_bool */],
  ["repository" /* repository */, "permission", 1, [], 101 /* TYPE_STATIC_address */],
  ["repository" /* repository */, "policy_contains", 2, [105 /* TYPE_STATIC_vec_u8 */], 100 /* TYPE_STATIC_bool */],
  ["repository" /* repository */, "policy_has_permission_index", 3, [105 /* TYPE_STATIC_vec_u8 */], 100 /* TYPE_STATIC_bool */],
  ["repository" /* repository */, "policy_permission_index", 4, [105 /* TYPE_STATIC_vec_u8 */], 102 /* TYPE_STATIC_u64 */],
  ["repository" /* repository */, "policy_value_type", 5, [105 /* TYPE_STATIC_vec_u8 */], 103 /* TYPE_STATIC_u8 */],
  ["repository" /* repository */, "contains_id", 6, [101 /* TYPE_STATIC_address */], 100 /* TYPE_STATIC_bool */],
  ["repository" /* repository */, "contains_value", 7, [101 /* TYPE_STATIC_address */, 105 /* TYPE_STATIC_vec_u8 */], 100 /* TYPE_STATIC_bool */],
  ["repository" /* repository */, "value_without_type", 8, [101 /* TYPE_STATIC_address */, 105 /* TYPE_STATIC_vec_u8 */], 105 /* TYPE_STATIC_vec_u8 */],
  ["repository" /* repository */, "value", 9, [101 /* TYPE_STATIC_address */, 105 /* TYPE_STATIC_vec_u8 */], 105 /* TYPE_STATIC_vec_u8 */],
  ["repository" /* repository */, "type", 10, [], 103 /* TYPE_STATIC_u8 */],
  ["repository" /* repository */, "policy_mode", 11, [], 103 /* TYPE_STATIC_u8 */]
];

// src/query.ts
import { SuiClient, getFullnodeUrl } from "../../node_modules/@mysten/sui.js/dist/esm/client/index.js";
import { TransactionBlock, Inputs as Inputs2 } from "../../node_modules/@mysten/sui.js/dist/esm/builder/export.js";
import { BCS as BCS2, getSuiMoveConfig as getSuiMoveConfig2 } from "../../node_modules/@mysten/bcs/dist/esm/index.js";

// src/permission.ts
import { BCS as BCS3 } from "../../node_modules/@mysten/bcs/dist/esm/index.js";
function create_permission(txb, data) {
  let permission2 = txb.moveCall({
    target: PermissionFn("new"),
    arguments: [txb.pure(data.description)]
  });
  let guards = [];
  console.log(data.entities);
  data.entities.forEach((entity) => {
    let permission_index = [];
    for (let i = 0; i < entity.permissions.length; i++) {
      let index = entity.permissions[i].index;
      if (index?.guard && index.guard.length > 0) {
        guards.push({ who: entity.who, index: index.index, guard: index.guard });
      }
      permission_index.push(index.index);
    }
    if (permission_index.length > 0) {
      txb.moveCall({
        target: PermissionFn("add_batch"),
        arguments: [permission2, txb.pure(entity.who, BCS3.ADDRESS), txb.pure(permission2, "vector<u64>")]
      });
    }
  });
  console.log("22222");
  guards.forEach(({ who, index, guard }) => {
    txb.moveCall({
      target: PermissionFn("guard_set"),
      arguments: [permission2, txb.pure(who, BCS3.ADDRESS), txb.pure(index, BCS3.U64), txb.object(guard)]
    });
  });
  txb.moveCall({
    target: PermissionFn("admin_add_batch"),
    arguments: [permission2, txb.pure(data.admin, "vector<address>")]
  });
  txb.moveCall({
    target: PermissionFn("create"),
    arguments: [permission2]
  });
}

// src/index.ts
var main = async () => {
  let permissionid1 = await permission(permission_data);
};
var permission_data = {
  description: "permission 1",
  admin: [ADDR, "0x26bd78c2f9766b95ebc3f2ccd70922092a79eda49815a91258aa44d68ccf098d", "0xc009bca7fa6e6cedafa1edb4812dc361e81bed605c87edbdd6af917e3e0d9ab3"],
  entities: [
    { who: "0x26bd78c2f9766b95ebc3f2ccd70922092a79eda49815a91258aa44d68ccf098d", permissions: [
      { index: 106 /* repository_policy_add */ },
      { index: 101 /* repository_description_set */ }
    ] },
    { who: "0xc009bca7fa6e6cedafa1edb4812dc361e81bed605c87edbdd6af917e3e0d9ab3", permissions: [
      { index: 107 /* repository_policy_remove */ },
      { index: 107 /* repository_policy_remove */, guard: "0x51627be10211fa81f5d30e568fc0e3229a746b12f1b8c1b7d0abab3b62680c35" }
    ] },
    { who: ADDR, permissions: [] }
  ]
};
var permission = async (data) => {
  const client = new SuiClient2({ url: getFullnodeUrl2(Config_EntryPoint) });
  const txb = new TransactionBlock2();
  create_permission(txb, data);
  const privkey = fromHEX4(SENDER_PRIV);
  const keypair = Ed25519Keypair.fromSecretKey(privkey);
  const options = { showEffects: true };
  const response = await client.signAndExecuteTransactionBlock({
    transactionBlock: txb,
    signer: keypair,
    options
  });
  let permissionid = response.effects?.created[0].reference.objectId;
  console.log("permissionid: " + permissionid);
  return permissionid;
};
main().then(console.log).catch(console.error);
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL2luZGV4LnRzIiwgInNyYy9jb25maWcudHMiLCAic3JjL3V0aWwudHMiLCAic3JjL2d1YXJkLnRzIiwgInNyYy9xdWVyeS50cyIsICJzcmMvcGVybWlzc2lvbi50cyJdLAogICJzb3VyY2VSb290IjogIkQ6XFx3b3dva1xcdGVzdCIsCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBTdWlDbGllbnQsIGdldEZ1bGxub2RlVXJsLCBTdWlPYmplY3RSZXNwb25zZSB9IGZyb20gJ0BteXN0ZW4vc3VpLmpzL2NsaWVudCc7XHJcbmltcG9ydCB7IFRyYW5zYWN0aW9uQmxvY2ssIElucHV0cywgdHlwZSBUcmFuc2FjdGlvblJlc3VsdCB9IGZyb20gJ0BteXN0ZW4vc3VpLmpzL3RyYW5zYWN0aW9ucyc7XHJcbmltcG9ydCB7IEVkMjU1MTlLZXlwYWlyIH0gZnJvbSAnQG15c3Rlbi9zdWkuanMva2V5cGFpcnMvZWQyNTUxOSc7XHJcbmltcG9ydCB7IEJDUywgZ2V0U3VpTW92ZUNvbmZpZywgdG9IRVgsIGZyb21IRVgsIEJjc1JlYWRlciB9IGZyb20gJ0BteXN0ZW4vYmNzJztcclxuaW1wb3J0IHsgQ29uZmlnX0VudHJ5UG9pbnQsIENMT0NLX09CSkVDVCwgUGFzc3BvcnRGbiwgR3VhcmRGbiwgRm5DYWxsVHlwZSwgRGF0YV9UeXBlLCBNT0RVTEVTLCBTRU5ERVJfUFJJViwgQUREUiwgUEFDS0FHRSwgU2VydmljZUZuLCBQZXJtaXNzaW9uRm4sIERlbWFuZEZufSBmcm9tICcuL2NvbmZpZyc7XHJcbmltcG9ydCB7IFNlbnNlTWFrZXIsIEd1YXJkX1NlbnNlX0JpbmRlciwgY3JlYXRlX2d1YXJkLCBwYXJzZV9zZW5zZV9ic2MsIEd1YXJkX1NlbnNlIH0gZnJvbSAnLi9ndWFyZCc7XHJcbmltcG9ydCB7IGNvbmNhdGVuYXRlLCBhcnJheV91bmlxdWUsIGNhcGl0YWxpemUsIHBhcnNlX29iamVjdF90eXBlfSBmcm9tICcuL3V0aWwnO1xyXG5pbXBvcnQgeyBHdWFyZF9RdWVyeV9PYmplY3RfUmVzdWx0LCBycGNfZ3VhcmRfcXVlcnlfb2JqZWN0cyB9IGZyb20gJy4vcXVlcnknXHJcbmltcG9ydCB7IHZlcmlmeSwgZGVzdHJveSwgIH0gZnJvbSAnLi9wYXNzcG9ydCdcclxuaW1wb3J0IHsgUGVybWlzc2lvbl9EYXRhLCBjcmVhdGVfcGVybWlzc2lvbiwgUGVybWlzc2lvbkluZGV4IH0gZnJvbSAnLi9wZXJtaXNzaW9uJ1xyXG5cclxudmFyIHBlcm1pc3Npb25pZCA9ICcweDY2YzA5Y2RiMDE1NmZmNWRjZGM3MGVmM2QyYTZhMjliNWUzNmM0NmIyOGM4YjdjZjk0NjFmNWE4M2I2MjFiNzQnO1xyXG52YXIgc2VydmljZWlkID0gJzB4OGJjOGNlNzhiMDU2ZDY5YzIyMGJmMjY0MTcyNjIzYzI5MGNlMTlkZTMzYjVlNDhkZmVlZGM4NzU4MGEwODU5Nyc7XHJcbnZhciBkZW1hbmRpZCA9ICcweDU1OTJhMTA4NmViZGIxMTAzYjkzMWE5MDA5ZmJmYzYxODIxNzk1NDI5NWE0NjE0ZmZjZWYxYjUxNTY3MTQxN2YnO1xyXG52YXIgZ3VhcmRpZCA9ICcweGMyZTk4MDYzZGI4NDBhNTg3Nzg1N2IwOTVlM2Y0N2EyZjIyYzBiODRkZjk4NDM4YmM5NWM2YjhjNjQ0YzYyYTMnO1xyXG52YXIgcGFzc3BvcnRpZCA9ICcweDVmOTE2MzQwYzcyOWQ3ZGFhZDA5NjkxNjk2Mzc5ZTcxMDUwMjI4OTdjZWEyZDYwNTIwYTk3YjQzN2M3ZWI0MGMnO1xyXG5cclxuY29uc3QgbWFpbiA9IGFzeW5jICgpID0+IHtcclxuICAgIC8vIGNvbnNvbGUubG9nKGF3YWl0IHNpbXBsZV9ndWFyZF90ZXN0KCkpO1xyXG4gICAgLy8gY29uc29sZS5sb2coYXdhaXQgcnBjX2d1YXJkX29iamVjdHMoQ29uZmlnX0VudHJ5UG9pbnQsIEFERFIsICcweDVhZTgxYTNlYzg4NzQ2Yzc5ZDc1ZDk2ZDUxNDg5MGE2NzBjOTYzMzYxMzMyZTVjZGY5YTNlMTI4YjMzMjEyNTAnKSlcclxuICAgIC8vIGNvbnNvbGUubG9nKGF3YWl0IHNlcnZpY2UoKSk7XHJcblxyXG4gICAgLy8gY29uc29sZS5sb2coYXdhaXQgZGVtYW5kKCkpO1xyXG4gICAgLy8gY29uc29sZS5sb2coYXdhaXQgbmV3Z3VhcmQoKSlcclxuICAgIC8vIGNvbnNvbGUubG9nKGF3YWl0IGRlbWFuZF9ndWFyZCgpKTtcclxuICAgIC8vIGNvbnNvbGUubG9nKGF3YWl0IHBhc3Nwb3J0KCkpXHJcbiAgICAvLyBjb25zb2xlLmxvZyhhd2FpdCBkZW1hbmRfcHJlc2VudCgpKVxyXG4gICAgLy8gY29uc29sZS5sb2coYXdhaXQgcGFzc3BvcnRfdmVyaWZ5KCkpIFxyXG4gICAgbGV0IHBlcm1pc3Npb25pZDEgPSBhd2FpdCBwZXJtaXNzaW9uKHBlcm1pc3Npb25fZGF0YSk7XHJcbiAgICAvLyBsZXQgcGVybWlzc2lvbmlkMiA9IGF3YWl0IHBlcm1pc3Npb24oKTtcclxuICAgIC8vIGNvbnNvbGUubG9nKGF3YWl0IHF1ZXJ5X2d1YXJkX3Rlc3QoW3Blcm1pc3Npb25pZDEsIHBlcm1pc3Npb25pZDJdKSk7XHJcbiAgICAvKmNvbnNvbGUubG9nKGF3YWl0IG5ld2d1YXJkMigpKVxyXG4gICAgY29uc29sZS5sb2coYXdhaXQgcGFzc3BvcnQoKSlcclxuICAgIGNvbnNvbGUubG9nKGF3YWl0IHBhc3Nwb3J0X3ZlcmlmeSgpKSovXHJcbn1cclxuXHJcbmNvbnN0IHBlcm1pc3Npb25fZGF0YSA6IFBlcm1pc3Npb25fRGF0YT0ge1xyXG4gICAgZGVzY3JpcHRpb246ICdwZXJtaXNzaW9uIDEnLFxyXG4gICAgYWRtaW46IFtBRERSLCAnMHgyNmJkNzhjMmY5NzY2Yjk1ZWJjM2YyY2NkNzA5MjIwOTJhNzllZGE0OTgxNWE5MTI1OGFhNDRkNjhjY2YwOThkJywgJzB4YzAwOWJjYTdmYTZlNmNlZGFmYTFlZGI0ODEyZGMzNjFlODFiZWQ2MDVjODdlZGJkZDZhZjkxN2UzZTBkOWFiMyddLFxyXG4gICAgZW50aXRpZXM6IFtcclxuICAgICAgICB7d2hvOicweDI2YmQ3OGMyZjk3NjZiOTVlYmMzZjJjY2Q3MDkyMjA5MmE3OWVkYTQ5ODE1YTkxMjU4YWE0NGQ2OGNjZjA5OGQnLCBwZXJtaXNzaW9uczpbXHJcbiAgICAgICAgICAgIHtpbmRleDpQZXJtaXNzaW9uSW5kZXgucmVwb3NpdG9yeV9wb2xpY3lfYWRkfSwgXHJcbiAgICAgICAgICAgIHtpbmRleDpQZXJtaXNzaW9uSW5kZXgucmVwb3NpdG9yeV9kZXNjcmlwdGlvbl9zZXR9LFxyXG4gICAgICAgIF19LFxyXG4gICAgICAgIHt3aG86JzB4YzAwOWJjYTdmYTZlNmNlZGFmYTFlZGI0ODEyZGMzNjFlODFiZWQ2MDVjODdlZGJkZDZhZjkxN2UzZTBkOWFiMycsIHBlcm1pc3Npb25zOltcclxuICAgICAgICAgICAge2luZGV4OlBlcm1pc3Npb25JbmRleC5yZXBvc2l0b3J5X3BvbGljeV9yZW1vdmV9LCBcclxuICAgICAgICAgICAge2luZGV4OlBlcm1pc3Npb25JbmRleC5yZXBvc2l0b3J5X3BvbGljeV9yZW1vdmUsIGd1YXJkOicweDUxNjI3YmUxMDIxMWZhODFmNWQzMGU1NjhmYzBlMzIyOWE3NDZiMTJmMWI4YzFiN2QwYWJhYjNiNjI2ODBjMzUnfSxcclxuICAgICAgICBdfSxcclxuICAgICAgICB7d2hvOiBBRERSLCBwZXJtaXNzaW9uczpbXX0sXHJcbiAgICBdXHJcbn1cclxuXHJcbmNvbnN0IHBlcm1pc3Npb24gPSBhc3luYyAoZGF0YTpQZXJtaXNzaW9uX0RhdGEpIDogUHJvbWlzZTxzdHJpbmc+ID0+IHsgXHJcbiAgICBjb25zdCBjbGllbnQgPSAgbmV3IFN1aUNsaWVudCh7IHVybDogZ2V0RnVsbG5vZGVVcmwoQ29uZmlnX0VudHJ5UG9pbnQpIH0pOyAgXHJcbiAgICBjb25zdCB0eGIgPSBuZXcgVHJhbnNhY3Rpb25CbG9jaygpO1xyXG4gICAgXHJcbiAgICBjcmVhdGVfcGVybWlzc2lvbih0eGIsIGRhdGEpO1xyXG5cclxuICAgIGNvbnN0IHByaXZrZXkgPSBmcm9tSEVYKFNFTkRFUl9QUklWKTtcclxuICAgIGNvbnN0IGtleXBhaXIgPSBFZDI1NTE5S2V5cGFpci5mcm9tU2VjcmV0S2V5KHByaXZrZXkpO1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSB7IHNob3dFZmZlY3RzOiB0cnVlIH07XHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNsaWVudC5zaWduQW5kRXhlY3V0ZVRyYW5zYWN0aW9uQmxvY2soe1xyXG4gICAgICAgIHRyYW5zYWN0aW9uQmxvY2s6IHR4YiwgXHJcbiAgICAgICAgc2lnbmVyOiBrZXlwYWlyLFxyXG4gICAgICAgIG9wdGlvbnNcclxuICAgIH0pO1xyXG4gICAgbGV0IHBlcm1pc3Npb25pZCA9IHJlc3BvbnNlLmVmZmVjdHM/LmNyZWF0ZWRbMF0ucmVmZXJlbmNlLm9iamVjdElkIGFzIHN0cmluZzsgIFxyXG4gICAgY29uc29sZS5sb2coXCJwZXJtaXNzaW9uaWQ6IFwiICsgcGVybWlzc2lvbmlkKTsgIFxyXG4gICAgcmV0dXJuIHBlcm1pc3Npb25pZCAgICBcclxufVxyXG5cclxuY29uc3Qgc2VydmljZSA9IGFzeW5jICgpID0+IHsgLy8gMHg2YTY0ZjRmZGRkOGYxZWNlYzkyMGEyMjk4NjFjM2M0MjU3MzM0MjExMTU1MDYwNTI5ZWVkZDk5ZDliZGYxZTNhXHJcbiAgICBjb25zdCBjbGllbnQgPSAgbmV3IFN1aUNsaWVudCh7IHVybDogZ2V0RnVsbG5vZGVVcmwoQ29uZmlnX0VudHJ5UG9pbnQpIH0pOyAgXHJcbiAgICBjb25zdCB0eGIgPSBuZXcgVHJhbnNhY3Rpb25CbG9jaygpO1xyXG4gICAgXHJcbiAgICBsZXQgc2VydmljZSA9IHR4Yi5tb3ZlQ2FsbCh7XHJcbiAgICAgICAgdGFyZ2V0OiBTZXJ2aWNlRm4oJ25ldycpIGFzIEZuQ2FsbFR5cGUsXHJcbiAgICAgICAgYXJndW1lbnRzOlt0eGIucHVyZSgnc2VydmljZSAuLi4nKSwgLy8gZGVzY3JpcFxyXG4gICAgICAgICAgICB0eGIucHVyZShBRERSKSwgLy8gcGF5ZWVcclxuICAgICAgICAgICAgdHhiLnB1cmUoWzBdLCBCQ1MuVTgpLCAvLyBlbmRwb2ludFxyXG4gICAgICAgICAgICB0eGIub2JqZWN0KHBlcm1pc3Npb25pZCkgLy8gcGVybVxyXG4gICAgICAgIF0sIFxyXG4gICAgICAgIHR5cGVBcmd1bWVudHM6W1wiMHgyOjpzdWk6OlNVSVwiXVxyXG4gICAgfSk7XHJcbiAgICB0eGIubW92ZUNhbGwoe1xyXG4gICAgICAgIHRhcmdldDpTZXJ2aWNlRm4oJ2NyZWF0ZScpIGFzIEZuQ2FsbFR5cGUsXHJcbiAgICAgICAgYXJndW1lbnRzOlsgc2VydmljZSBdLFxyXG4gICAgICAgIHR5cGVBcmd1bWVudHM6W1wiMHgyOjpzdWk6OlNVSVwiXVxyXG4gICAgfSk7XHJcbiAgICBjb25zdCBwcml2a2V5ID0gZnJvbUhFWChTRU5ERVJfUFJJVik7XHJcbiAgICBjb25zdCBrZXlwYWlyID0gRWQyNTUxOUtleXBhaXIuZnJvbVNlY3JldEtleShwcml2a2V5KTtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0geyBzaG93SW5wdXQ6IHRydWUsXHJcbiAgICAgICAgc2hvd0VmZmVjdHM6IHRydWUsXHJcbiAgICAgICAgc2hvd0V2ZW50czogdHJ1ZSxcclxuICAgICAgICBzaG93QmFsYW5jZUNoYW5nZXM6IHRydWUsXHJcbiAgICAgICAgc2hvd09iamVjdENoYW5nZXM6IHRydWV9O1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjbGllbnQuc2lnbkFuZEV4ZWN1dGVUcmFuc2FjdGlvbkJsb2NrKHtcclxuICAgICAgICB0cmFuc2FjdGlvbkJsb2NrOiB0eGIsIFxyXG4gICAgICAgIHNpZ25lcjoga2V5cGFpcixcclxuICAgICAgICBvcHRpb25zXHJcbiAgICB9KTtcclxufVxyXG5jb25zdCBwYXNzcG9ydCA9IGFzeW5jICgpID0+IHtcclxuICAgIGNvbnN0IGNsaWVudCA9ICBuZXcgU3VpQ2xpZW50KHsgdXJsOiBnZXRGdWxsbm9kZVVybChDb25maWdfRW50cnlQb2ludCkgfSk7ICBcclxuICAgIGNvbnN0IHR4YiA9IG5ldyBUcmFuc2FjdGlvbkJsb2NrKCk7XHJcblxyXG4gICAgdmFyIHBhc3Nwb3J0ID0gdHhiLm1vdmVDYWxsKHtcclxuICAgICAgICB0YXJnZXQ6IFBhc3Nwb3J0Rm4oJ25ldycpIGFzIEZuQ2FsbFR5cGUsXHJcbiAgICAgICAgYXJndW1lbnRzOiBbIHR4Yi5vYmplY3QoZ3VhcmRpZCksIHR4Yi5vYmplY3QoQ0xPQ0tfT0JKRUNUKV1cclxuICAgIH0pOyAvKlxyXG4gICAgdHhiLm1vdmVDYWxsKHtcclxuICAgICAgICB0YXJnZXQ6IFBhc3Nwb3J0Rm4oJ2d1YXJkX2FkZCcpIGFzIEZuQ2FsbFR5cGUsXHJcbiAgICAgICAgYXJndW1lbnRzOiBbIHBhc3Nwb3J0LCB0eGIub2JqZWN0KGd1YXJkaWQpXVxyXG4gICAgfSlcclxuKi9cclxuICAgIHR4Yi5tb3ZlQ2FsbCh7XHJcbiAgICAgICAgdGFyZ2V0OiBQYXNzcG9ydEZuKCdkZXN0cm95JykgYXMgRm5DYWxsVHlwZSxcclxuICAgICAgICBhcmd1bWVudHM6IFsgcGFzc3BvcnQgXSAgICAgICAgXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgY29uc3QgcHJpdmtleSA9IGZyb21IRVgoU0VOREVSX1BSSVYpO1xyXG4gICAgY29uc3Qga2V5cGFpciA9IEVkMjU1MTlLZXlwYWlyLmZyb21TZWNyZXRLZXkocHJpdmtleSk7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IHsgc2hvd0VmZmVjdHM6IHRydWUsfTtcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY2xpZW50LnNpZ25BbmRFeGVjdXRlVHJhbnNhY3Rpb25CbG9jayh7XHJcbiAgICAgICAgdHJhbnNhY3Rpb25CbG9jazogdHhiLCBcclxuICAgICAgICBzaWduZXI6IGtleXBhaXIsXHJcbiAgICAgICAgb3B0aW9uc1xyXG4gICAgfSk7XHJcbiAgICBwYXNzcG9ydGlkID0gcmVzcG9uc2UuZWZmZWN0cz8uY3JlYXRlZFswXS5yZWZlcmVuY2Uub2JqZWN0SWQ7ICBcclxuICAgIGNvbnNvbGUubG9nKFwicGFzc3BvcnRpZDogXCIgKyBwYXNzcG9ydGlkKTtcclxufVxyXG5jb25zdCBkZW1hbmRfcHJlc2VudCA9IGFzeW5jICgpID0+IHtcclxuICAgIGNvbnN0IGNsaWVudCA9ICBuZXcgU3VpQ2xpZW50KHsgdXJsOiBnZXRGdWxsbm9kZVVybChDb25maWdfRW50cnlQb2ludCkgfSk7ICBcclxuICAgIGNvbnN0IHR4YiA9IG5ldyBUcmFuc2FjdGlvbkJsb2NrKCk7XHJcblxyXG4gICAgdHhiLm1vdmVDYWxsKHtcclxuICAgICAgICB0YXJnZXQ6RGVtYW5kRm4oJ3ByZXNlbnRfd2l0aF9wYXNzcG9ydCcpIGFzIEZuQ2FsbFR5cGUsXHJcbiAgICAgICAgYXJndW1lbnRzOltcclxuICAgICAgICAgICAgdHhiLm9iamVjdChwYXNzcG9ydGlkKSxcclxuICAgICAgICAgICAgdHhiLm9iamVjdChkZW1hbmRpZCksIC8vIGRlbWFuZFxyXG4gICAgICAgICAgICB0eGIub2JqZWN0KHNlcnZpY2VpZCksIC8vIHNlcnZpY2VcclxuICAgICAgICAgICAgdHhiLnB1cmUoJ2hlbGxvJylcclxuICAgICAgICBdLFxyXG4gICAgICAgIHR5cGVBcmd1bWVudHM6W1wiMHgyOjpjb2luOjpDb2luPDB4Mjo6c3VpOjpTVUk+XCIsIFwiMHgyOjpzdWk6OlNVSVwiXSxcclxuICAgIH0pICBcclxuICAgIFxyXG4gICAgY29uc3QgcHJpdmtleSA9IGZyb21IRVgoU0VOREVSX1BSSVYpO1xyXG4gICAgY29uc3Qga2V5cGFpciA9IEVkMjU1MTlLZXlwYWlyLmZyb21TZWNyZXRLZXkocHJpdmtleSk7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IHsgc2hvd0lucHV0OiB0cnVlLFxyXG4gICAgICAgIHNob3dFZmZlY3RzOiB0cnVlLFxyXG4gICAgICAgIHNob3dFdmVudHM6IHRydWUsXHJcbiAgICAgICAgc2hvd0JhbGFuY2VDaGFuZ2VzOiB0cnVlLFxyXG4gICAgICAgIHNob3dPYmplY3RDaGFuZ2VzOiB0cnVlfTtcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY2xpZW50LnNpZ25BbmRFeGVjdXRlVHJhbnNhY3Rpb25CbG9jayh7XHJcbiAgICAgICAgdHJhbnNhY3Rpb25CbG9jazogdHhiLCBcclxuICAgICAgICBzaWduZXI6IGtleXBhaXIsXHJcbiAgICAgICAgb3B0aW9uc1xyXG4gICAgfSk7XHJcbiAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XHJcbn1cclxuY29uc3QgZGVtYW5kX2d1YXJkID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgY29uc3QgY2xpZW50ID0gIG5ldyBTdWlDbGllbnQoeyB1cmw6IGdldEZ1bGxub2RlVXJsKENvbmZpZ19FbnRyeVBvaW50KSB9KTsgIFxyXG4gICAgY29uc3QgdHhiID0gbmV3IFRyYW5zYWN0aW9uQmxvY2soKTtcclxuXHJcbiAgICB0eGIubW92ZUNhbGwoe1xyXG4gICAgICAgIHRhcmdldDpEZW1hbmRGbignZ3VhcmRfc2V0JykgYXMgRm5DYWxsVHlwZSxcclxuICAgICAgICBhcmd1bWVudHM6W3R4Yi5vYmplY3QoZGVtYW5kaWQpLCBcclxuICAgICAgICAgICAgdHhiLm9iamVjdChndWFyZGlkKSwgLy8gZ3VhcmRcclxuICAgICAgICAgICAgdHhiLm9iamVjdChwZXJtaXNzaW9uaWQpXSwgLy8gcGVybWlzc2lvblxyXG4gICAgICAgIHR5cGVBcmd1bWVudHM6W1wiMHgyOjpjb2luOjpDb2luPDB4Mjo6c3VpOjpTVUk+XCJdLFxyXG4gICAgfSk7IFxyXG5cclxuICAgIGNvbnN0IHByaXZrZXkgPSBmcm9tSEVYKFNFTkRFUl9QUklWKTtcclxuICAgIGNvbnN0IGtleXBhaXIgPSBFZDI1NTE5S2V5cGFpci5mcm9tU2VjcmV0S2V5KHByaXZrZXkpO1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSB7IHNob3dJbnB1dDogdHJ1ZSxcclxuICAgICAgICBzaG93RWZmZWN0czogdHJ1ZSxcclxuICAgICAgICBzaG93RXZlbnRzOiB0cnVlLFxyXG4gICAgICAgIHNob3dCYWxhbmNlQ2hhbmdlczogdHJ1ZSxcclxuICAgICAgICBzaG93T2JqZWN0Q2hhbmdlczogdHJ1ZX07XHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNsaWVudC5zaWduQW5kRXhlY3V0ZVRyYW5zYWN0aW9uQmxvY2soe1xyXG4gICAgICAgIHRyYW5zYWN0aW9uQmxvY2s6IHR4YiwgXHJcbiAgICAgICAgc2lnbmVyOiBrZXlwYWlyLFxyXG4gICAgICAgIG9wdGlvbnNcclxuICAgIH0pO1xyXG4gICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xyXG59XHJcblxyXG5jb25zdCBkZW1hbmQgPSBhc3luYyAoKSA9PiB7IFxyXG4gICAgY29uc3QgY2xpZW50ID0gIG5ldyBTdWlDbGllbnQoeyB1cmw6IGdldEZ1bGxub2RlVXJsKENvbmZpZ19FbnRyeVBvaW50KSB9KTsgIFxyXG4gICAgY29uc3QgdHhiID0gbmV3IFRyYW5zYWN0aW9uQmxvY2soKTtcclxuICAgIFxyXG5cclxuLyogIHZhciBxdWVyaWVzX2luZm8gID0gYXdhaXQgY2xpZW50LmNhbGwoJ3N1aV9nZXRPYmplY3QnLCBcclxuICAgICAgICBbJzB4NzRiYjg3OGMzYzg2Mzk0YWUxMzc4MDgwZTQ5NzI4ZTdhNjNlNjhhYzI5ZDhiM2RhNDZkNzI4MzlhMDgyYWJjZicsIFxyXG4gICAgICAgIHtcInNob3dUeXBlXCI6IHRydWV9XSkgYXMgU3VpT2JqZWN0UmVzcG9uc2VbXTsgIFxyXG4gICAgY29uc29sZS5sb2cocXVlcmllc19pbmZvKTsgKi9cclxuICBcclxuICAgIGNvbnN0IGNvaW4gPSB0eGIuc3BsaXRDb2lucyh0eGIuZ2FzLCBbdHhiLnB1cmUoMTAwMCldKTtcclxuXHJcbiAgICBcclxuICAgIGxldCBkZW1hbmQgPSB0eGIubW92ZUNhbGwoe1xyXG4gICAgICAgIHRhcmdldDogRGVtYW5kRm4oJ2NyZWF0ZScpIGFzIEZuQ2FsbFR5cGUsXHJcbiAgICAgICAgYXJndW1lbnRzOlt0eGIucHVyZSgnbXkgZGVtYW5kJyksIC8vIGRlc2NcclxuICAgICAgICBjb2luWzBdLFxyXG4gICAgICAgIHR4Yi5vYmplY3QocGVybWlzc2lvbmlkKV0sIC8vIHBlcm1pc3Npb25cclxuICAgICAgICB0eXBlQXJndW1lbnRzOltcIjB4Mjo6Y29pbjo6Q29pbjwweDI6OnN1aTo6U1VJPlwiXSxcclxuICAgIH0pOyBcclxuICAgIGNvbnN0IHByaXZrZXkgPSBmcm9tSEVYKFNFTkRFUl9QUklWKTtcclxuICAgIGNvbnN0IGtleXBhaXIgPSBFZDI1NTE5S2V5cGFpci5mcm9tU2VjcmV0S2V5KHByaXZrZXkpO1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSB7IHNob3dJbnB1dDogdHJ1ZSxcclxuICAgICAgICBzaG93RWZmZWN0czogdHJ1ZSxcclxuICAgICAgICBzaG93RXZlbnRzOiB0cnVlLFxyXG4gICAgICAgIHNob3dCYWxhbmNlQ2hhbmdlczogdHJ1ZSxcclxuICAgICAgICBzaG93T2JqZWN0Q2hhbmdlczogdHJ1ZX07XHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNsaWVudC5zaWduQW5kRXhlY3V0ZVRyYW5zYWN0aW9uQmxvY2soe1xyXG4gICAgICAgIHRyYW5zYWN0aW9uQmxvY2s6IHR4YiwgXHJcbiAgICAgICAgc2lnbmVyOiBrZXlwYWlyLFxyXG4gICAgICAgIG9wdGlvbnNcclxuICAgIH0pO1xyXG59XHJcbiAgXHJcbmNvbnN0IHNpbXBsZV9ndWFyZF90ZXN0ID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgY29uc3QgY2xpZW50ID0gIG5ldyBTdWlDbGllbnQoeyB1cmw6IGdldEZ1bGxub2RlVXJsKENvbmZpZ19FbnRyeVBvaW50KSB9KTsgIFxyXG4gICAgY29uc3QgdHhiID0gbmV3IFRyYW5zYWN0aW9uQmxvY2soKTtcclxuXHJcbiAgICAvLyBuZXcgZ3VhcmRcclxuICAgIGxldCBzZW5zZV9tYWtlciA9IG5ldyBTZW5zZU1ha2VyKCk7XHJcbiAgICBzZW5zZV9tYWtlci5hZGRfcGFyYW0oRGF0YV9UeXBlLlRZUEVfQ09OVEVYVF9TSUdORVIpO1xyXG4gICAgc2Vuc2VfbWFrZXIuYWRkX3BhcmFtKERhdGFfVHlwZS5UWVBFX1NUQVRJQ19hZGRyZXNzLCBBRERSKTtcclxuICAgIHNlbnNlX21ha2VyLmFkZF9sb2dpYyhEYXRhX1R5cGUuVFlQRV9MT0dJQ19PUEVSQVRPUl9FUVVBTCk7XHJcbiAgICBjb25zdCBzZW5zZTEgPSBzZW5zZV9tYWtlci5tYWtlKGZhbHNlLCBHdWFyZF9TZW5zZV9CaW5kZXIuQU5EKSBhcyBHdWFyZF9TZW5zZTtcclxuICAgIGNvbnN0IHNlbnNlMiA9IHNlbnNlX21ha2VyLm1ha2UoZmFsc2UsIEd1YXJkX1NlbnNlX0JpbmRlci5PUikgYXMgR3VhcmRfU2Vuc2U7XHJcblxyXG4gICAgbGV0IGd1YXJkX2RhdGExICA9IHtcclxuICAgICAgICBkZXNjcmlwdGlvbjogXCJzb21lIHdvcmRzLlwiLFxyXG4gICAgICAgIHNlbnNlczpbc2Vuc2UxLCBzZW5zZTJdLCBcclxuICAgIH07XHJcbiAgICBsZXQgZ3VhcmRfZGF0YTIgID0ge1xyXG4gICAgICAgIGRlc2NyaXB0aW9uOiBcInh4eHhcIixcclxuICAgICAgICBzZW5zZXM6W3NlbnNlMSwgc2Vuc2UyXSwgXHJcbiAgICB9O1xyXG4gICAgY3JlYXRlX2d1YXJkKHR4YiwgZ3VhcmRfZGF0YTEpO1xyXG4gICAgY3JlYXRlX2d1YXJkKHR4YiwgZ3VhcmRfZGF0YTIpO1xyXG4gICAgY29uc3QgcHJpdmtleSA9IGZyb21IRVgoU0VOREVSX1BSSVYpO1xyXG4gICAgY29uc3Qga2V5cGFpciA9IEVkMjU1MTlLZXlwYWlyLmZyb21TZWNyZXRLZXkocHJpdmtleSk7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IHsgc2hvd0VmZmVjdHM6IHRydWV9O1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjbGllbnQuc2lnbkFuZEV4ZWN1dGVUcmFuc2FjdGlvbkJsb2NrKHtcclxuICAgICAgICB0cmFuc2FjdGlvbkJsb2NrOiB0eGIsIFxyXG4gICAgICAgIHNpZ25lcjoga2V5cGFpcixcclxuICAgICAgICBvcHRpb25zXHJcbiAgICB9KTtcclxuICAgIHZhciBndWFyZDEgPSByZXNwb25zZS5lZmZlY3RzPy5jcmVhdGVkWzBdLnJlZmVyZW5jZS5vYmplY3RJZDsgIFxyXG4gICAgdmFyIGd1YXJkMiA9IHJlc3BvbnNlLmVmZmVjdHM/LmNyZWF0ZWRbMV0ucmVmZXJlbmNlLm9iamVjdElkO1xyXG4gICAgY29uc29sZS5sb2coJ2d1YXJkMTogJyArIGd1YXJkMSk7IFxyXG4gICAgY29uc29sZS5sb2coJ2d1YXJkMjogJyArIGd1YXJkMik7IFxyXG5cclxuICAgIGNvbnN0IGd1YXJkX3F1ZXJ5ID0ge2d1YXJkX2lkczpbZ3VhcmQxLCBndWFyZDJdLCBvYmplY3RzOltdfTtcclxuICAgIGNvbnN0IHR4YjIgPSBuZXcgVHJhbnNhY3Rpb25CbG9jaygpO1xyXG4gICAgbGV0IHBhc3Nwb3J0ID0gdmVyaWZ5KHR4YjIsIGd1YXJkX3F1ZXJ5IGFzIEd1YXJkX1F1ZXJ5X09iamVjdF9SZXN1bHQpIGFzIFRyYW5zYWN0aW9uUmVzdWx0IDtcclxuICAgIGRlc3Ryb3kodHhiMiwgcGFzc3BvcnQpO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKGF3YWl0IGNsaWVudC5zaWduQW5kRXhlY3V0ZVRyYW5zYWN0aW9uQmxvY2soe1xyXG4gICAgICAgIHRyYW5zYWN0aW9uQmxvY2s6IHR4YjIsIFxyXG4gICAgICAgIHNpZ25lcjoga2V5cGFpcixcclxuICAgICAgICBvcHRpb25zXHJcbiAgICB9KSk7XHJcbn1cclxuXHJcbmNvbnN0IHF1ZXJ5X2d1YXJkX3Rlc3QgPSBhc3luYyAocGVybWlzc2lvbmlkOnN0cmluZ1tdKSA9PiB7ICAvLyBcclxuICAgIGNvbnN0IGNsaWVudCA9ICBuZXcgU3VpQ2xpZW50KHsgdXJsOiBnZXRGdWxsbm9kZVVybChDb25maWdfRW50cnlQb2ludCkgfSk7ICBcclxuICAgIGNvbnN0IHR4YiA9IG5ldyBUcmFuc2FjdGlvbkJsb2NrKCk7XHJcblxyXG4gICAgLy8gbmV3IGd1YXJkXHJcbiAgICBsZXQgc2Vuc2VfbWFrZXIgPSBuZXcgU2Vuc2VNYWtlcigpO1xyXG4gICAgc2Vuc2VfbWFrZXIuYWRkX2NtZChwZXJtaXNzaW9uaWRbMF0sIDApOyAvLyBjcmVhdG9yIC0+IGFkZHJlc3NcclxuICAgIHNlbnNlX21ha2VyLmFkZF9jbWQocGVybWlzc2lvbmlkWzFdLCAxKTsgLy8gcGVybWlzc2lvbjppc19hZG1pbiArIGFkZHJlc3MgLT4gYm9vbCBcclxuXHJcbiAgICBjb25zdCBzZW5zZTEgPSBzZW5zZV9tYWtlci5tYWtlKGZhbHNlLCBHdWFyZF9TZW5zZV9CaW5kZXIuQU5EKSBhcyBHdWFyZF9TZW5zZTtcclxuICAgIFxyXG4gICAgbGV0IG1ha2VyMiA9IG5ldyBTZW5zZU1ha2VyKCk7XHJcbiAgICBtYWtlcjIuYWRkX3BhcmFtKERhdGFfVHlwZS5UWVBFX0NPTlRFWFRfU0lHTkVSKTtcclxuICAgIG1ha2VyMi5hZGRfcGFyYW0oRGF0YV9UeXBlLlRZUEVfU1RBVElDX2FkZHJlc3MsIEFERFIpO1xyXG4gICAgbWFrZXIyLmFkZF9sb2dpYyhEYXRhX1R5cGUuVFlQRV9MT0dJQ19PUEVSQVRPUl9FUVVBTCk7XHJcblxyXG4gICAgY29uc3Qgc2Vuc2UyID0gbWFrZXIyLm1ha2UodHJ1ZSwgR3VhcmRfU2Vuc2VfQmluZGVyLkFORCkgYXMgIEd1YXJkX1NlbnNlO1xyXG4gICAgY29uc3Qgc2Vuc2UzID0gc2Vuc2UxO1xyXG5cclxuICAgIGxldCBndWFyZF9kYXRhMSAgPSB7XHJcbiAgICAgICAgZGVzY3JpcHRpb246IFwiMVwiLFxyXG4gICAgICAgIHNlbnNlczpbc2Vuc2UxLCBzZW5zZTIsIHNlbnNlM10sIFxyXG4gICAgfTtcclxuICAgIGxldCBndWFyZF9kYXRhMiAgPSB7XHJcbiAgICAgICAgZGVzY3JpcHRpb246IFwiMlwiLFxyXG4gICAgICAgIHNlbnNlczpbc2Vuc2UxLCBzZW5zZTJdLCBcclxuICAgIH07ICAgIFxyXG5cclxuICAgIGNyZWF0ZV9ndWFyZCh0eGIsIGd1YXJkX2RhdGExKTtcclxuICAgIGNyZWF0ZV9ndWFyZCh0eGIsIGd1YXJkX2RhdGEyKTtcclxuXHJcbiAgICBjb25zdCBwcml2a2V5ID0gZnJvbUhFWChTRU5ERVJfUFJJVik7XHJcbiAgICBjb25zdCBrZXlwYWlyID0gRWQyNTUxOUtleXBhaXIuZnJvbVNlY3JldEtleShwcml2a2V5KTtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0geyBzaG93RWZmZWN0czogdHJ1ZSB9O1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjbGllbnQuc2lnbkFuZEV4ZWN1dGVUcmFuc2FjdGlvbkJsb2NrKHtcclxuICAgICAgICB0cmFuc2FjdGlvbkJsb2NrOiB0eGIsIFxyXG4gICAgICAgIHNpZ25lcjoga2V5cGFpcixcclxuICAgICAgICBvcHRpb25zXHJcbiAgICB9KTtcclxuICAgIHZhciBndWFyZDEgPSByZXNwb25zZS5lZmZlY3RzPy5jcmVhdGVkWzBdLnJlZmVyZW5jZS5vYmplY3RJZCBhcyBzdHJpbmc7ICBcclxuICAgIHZhciBndWFyZDIgPSByZXNwb25zZS5lZmZlY3RzPy5jcmVhdGVkWzFdLnJlZmVyZW5jZS5vYmplY3RJZCBhcyBzdHJpbmc7XHJcbiAgICBjb25zb2xlLmxvZygnZ3VhcmQxOiAnICsgZ3VhcmQxKTsgXHJcbiAgICBjb25zb2xlLmxvZygnZ3VhcmQyOiAnICsgZ3VhcmQyKTsgXHJcblxyXG4gICAgLy8gcXVlcnkgb2JqZWN0c1xyXG4gICAgY29uc3QgZ3VhcmRfcXVlcnkgPSBhd2FpdCBycGNfZ3VhcmRfcXVlcnlfb2JqZWN0cyhBRERSLCBbZ3VhcmQxLCBndWFyZDJdKSA7IC8vIGd1YXJkcy4uLlxyXG4gICAgaWYgKGd1YXJkX3F1ZXJ5ID09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdndWFyZF9xdWVyeSBlcnJvcicpO1xyXG4gICAgICAgIHJldHVybiBcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB0eGIyID0gbmV3IFRyYW5zYWN0aW9uQmxvY2soKTtcclxuICAgIGxldCBwYXNzcG9ydCA9IHZlcmlmeSh0eGIyLCBndWFyZF9xdWVyeSBhcyBHdWFyZF9RdWVyeV9PYmplY3RfUmVzdWx0KSBhcyBUcmFuc2FjdGlvblJlc3VsdCA7XHJcbiAgICBkZXN0cm95KHR4YjIsIHBhc3Nwb3J0KTtcclxuXHJcbiAgICBjb25zb2xlLmxvZyhhd2FpdCBjbGllbnQuc2lnbkFuZEV4ZWN1dGVUcmFuc2FjdGlvbkJsb2NrKHtcclxuICAgICAgICB0cmFuc2FjdGlvbkJsb2NrOiB0eGIyLCBcclxuICAgICAgICBzaWduZXI6IGtleXBhaXIsXHJcbiAgICAgICAgb3B0aW9uc1xyXG4gICAgfSkpO1xyXG59XHJcbmNvbnN0IG5ld2d1YXJkMyA9IGFzeW5jICgpID0+IHsgXHJcbiAgICBjb25zdCBjbGllbnQgPSAgbmV3IFN1aUNsaWVudCh7IHVybDogZ2V0RnVsbG5vZGVVcmwoQ29uZmlnX0VudHJ5UG9pbnQpIH0pOyAgXHJcbiAgICBjb25zdCB0eGIgPSBuZXcgVHJhbnNhY3Rpb25CbG9jaygpO1xyXG5cclxuICAgIHR4Yi5tb3ZlQ2FsbCh7IFxyXG4gICAgICAgIHRhcmdldDpHdWFyZEZuKCdjcmVhdG9yX2d1YXJkJykgYXMgRm5DYWxsVHlwZSxcclxuICAgICAgICBhcmd1bWVudHM6W11cclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnN0IHByaXZrZXkgPSBmcm9tSEVYKFNFTkRFUl9QUklWKTtcclxuICAgIGNvbnN0IGtleXBhaXIgPSBFZDI1NTE5S2V5cGFpci5mcm9tU2VjcmV0S2V5KHByaXZrZXkpO1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSB7IHNob3dFZmZlY3RzOiB0cnVlICB9O1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjbGllbnQuc2lnbkFuZEV4ZWN1dGVUcmFuc2FjdGlvbkJsb2NrKHtcclxuICAgICAgICB0cmFuc2FjdGlvbkJsb2NrOiB0eGIsIFxyXG4gICAgICAgIHNpZ25lcjoga2V5cGFpcixcclxuICAgICAgICBvcHRpb25zXHJcbiAgICB9KTtcclxuICAgIGd1YXJkaWQgPSByZXNwb25zZS5lZmZlY3RzPy5jcmVhdGVkWzBdLnJlZmVyZW5jZS5vYmplY3RJZDsgIFxyXG4gICAgY29uc29sZS5sb2coJ2d1YXJkIGlkOiAnICsgZ3VhcmRpZCk7XHJcbn1cclxubWFpbigpLnRoZW4oY29uc29sZS5sb2cpLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG4vL3YuZm9yRWFjaCgoaXRlbSA6IG51bWJlcikgPT4gY29uc29sZS5sb2coaXRlbSkpO1xyXG5cclxuIiwgImltcG9ydCB7IGJjcywgQkNTLCB0b0hFWCwgZnJvbUhFWCwgZ2V0U3VpTW92ZUNvbmZpZyB9IGZyb20gJ0BteXN0ZW4vYmNzJztcclxuaW1wb3J0IHsgSW5wdXRzIH0gZnJvbSBcIkBteXN0ZW4vc3VpLmpzL3RyYW5zYWN0aW9uc1wiO1xyXG5pbXBvcnQgeyBjYXBpdGFsaXplIH0gZnJvbSAnLi91dGlsJztcclxuXHJcbmV4cG9ydCBlbnVtIEVOVFJZUE9JTlQge1xyXG4gICAgbWFpbm5ldCA9ICdtYWlubmV0JyxcclxuICAgIHRlc3RuZXQgPSAndGVzdG5ldCcsXHJcbiAgICBkZXZuZXQgPSAnZGV2bmV0JyxcclxuICAgIGxvY2FsbmV0ID0gJ2xvY2FsbmV0J1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgQ29uZmlnX0VudHJ5UG9pbnQ6RU5UUllQT0lOVCA9IEVOVFJZUE9JTlQubG9jYWxuZXQ7XHJcblxyXG5cclxuZXhwb3J0IGxldCBQQUNLQUdFID0gXCIweDc3YjgzYWU4MTkwNDE1NDE0MmU0ODY4MzczMTgwMDI4NTkzMmZmNDkzMTdjZGUyNDFhMmRkODA0NjBmNWRkMzRcIjsgLy8gYWRkcmVzcywgTk9UIGlkXHJcbi8vIHdvd29rIGRlZmF1bHQgZXZlcnkgZ3VhcmQgYWRkcmVzc1xyXG5leHBvcnQgY29uc3QgRVZFUllPTkVfR1VBUkQgPSBcIjB4NTE2MjdiZTEwMjExZmE4MWY1ZDMwZTU2OGZjMGUzMjI5YTc0NmIxMmYxYjhjMWI3ZDBhYmFiM2I2MjY4MGMzNVwiO1xyXG5leHBvcnQgY29uc3QgU0VOREVSX1BSSVYgPSBcIjB4YzliYmMzMGY3MmVmN2Q5YWE2NzRhM2JlMTQ0OGI5MjY3MTQxYTY3NmI1OWYzZjQzMTUyMzE2MTdhNWJiYzBlOFwiO1xyXG5leHBvcnQgY29uc3QgQUREUiA9IFwiMHhlMzg2YmI5ZTAxYjM1MjhiNzVmMzc1MWFkOGExZTQxOGIyMDdhZDk3OWZlYTM2NDA4N2RlZWY1MjUwYTczZDNmXCI7XHJcblxyXG5cclxuZXhwb3J0IGVudW0gTU9EVUxFUyB7XHJcbiAgICBtYWNoaW5lID0gJ21hY2hpbmUnLFxyXG4gICAgbm9kZSA9ICdub2RlJyxcclxuICAgIHByb2dyZXNzID0gJ3Byb2dyZXNzJyxcclxuICAgIGNvbW11bml0eSA9ICdjb21tdW5pdHknLFxyXG4gICAgcmVwb3NpdG9yeSA9ICdyZXBvc2l0b3J5JyxcclxuICAgIHBlcm1pc3Npb24gPSAncGVybWlzc2lvbicsXHJcbiAgICBwYXNzcG9ydCA9ICdwYXNzcG9ydCcsXHJcbiAgICBndWFyZCA9ICdndWFyZCcsXHJcbiAgICB2b3RlID0gJ3ZvdGUnLFxyXG4gICAgZGVtYW5kID0gJ2RlbWFuZCcsXHJcbiAgICBvcmRlciA9ICdvcmRlcicsXHJcbiAgICByZXdhcmQgPSAncmV3YXJkJyxcclxuICAgIHNlcnZpY2UgPSAnc2VydmljZScsXHJcbiAgICB3b3dvayA9ICd3b3dvaycsXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBPQkpFQ1RTX1RZUEVfUFJFRklYID0gKE9iamVjdC5rZXlzKE1PRFVMRVMpIGFzIEFycmF5PGtleW9mIHR5cGVvZiBNT0RVTEVTPikubWFwKChrZXkpID0+IHsgcmV0dXJuIFBBQ0tBR0UgKyAnOjonICsga2V5ICsgJzo6JzsgfSlcclxuZXhwb3J0IGNvbnN0IE9CSkVDVFNfVFlQRSA9IChPYmplY3Qua2V5cyhNT0RVTEVTKSBhcyBBcnJheTxrZXlvZiB0eXBlb2YgTU9EVUxFUz4pLm1hcCgoa2V5KSA9PiB7IGxldCBpID0gUEFDS0FHRSArICc6OicgKyBrZXkgKyAnOjonOyByZXR1cm4gaSArIGNhcGl0YWxpemUoa2V5KTsgfSlcclxuXHJcbmV4cG9ydCB0eXBlIEZuQ2FsbFR5cGUgPSBgJHtzdHJpbmd9Ojoke3N0cmluZ306OiR7c3RyaW5nfWA7XHJcbmV4cG9ydCBjb25zdCBNYWNoaW5lRm4gPSAoZm46YW55KSA9PiB7IHJldHVybiBgJHtQQUNLQUdFfTo6JHtNT0RVTEVTLm1hY2hpbmV9Ojoke2ZufWB9O1xyXG5leHBvcnQgY29uc3QgTm9kZUZuID0gKGZuOiBhbnkpID0+IHsgcmV0dXJuIGAke1BBQ0tBR0V9Ojoke01PRFVMRVMubm9kZX06OiR7Zm59YH07XHJcbmV4cG9ydCBjb25zdCBQcm9ncmVzc0ZuID0gKGZuOmFueSkgPT4geyByZXR1cm4gYCR7UEFDS0FHRX06OiR7TU9EVUxFUy5wcm9ncmVzc306OiR7Zm59YH07XHJcbmV4cG9ydCBjb25zdCBDb21tdW5pdHlGbiA9IChmbjogYW55KSA9PiB7IHJldHVybiBgJHtQQUNLQUdFfTo6JHtNT0RVTEVTLmNvbW11bml0eX06OiR7Zm59YH07XHJcbmV4cG9ydCBjb25zdCBSZXBvc2l0b3J5Rm4gPSAoZm46YW55KSA9PiB7IHJldHVybiBgJHtQQUNLQUdFfTo6JHtNT0RVTEVTLnJlcG9zaXRvcnl9Ojoke2ZufWB9O1xyXG5leHBvcnQgY29uc3QgUGVybWlzc2lvbkZuID0gKGZuOiBhbnkpID0+IHsgcmV0dXJuIGAke1BBQ0tBR0V9Ojoke01PRFVMRVMucGVybWlzc2lvbn06OiR7Zm59YH07XHJcbmV4cG9ydCBjb25zdCBQYXNzcG9ydEZuID0gKGZuOmFueSkgPT4geyByZXR1cm4gYCR7UEFDS0FHRX06OiR7TU9EVUxFUy5wYXNzcG9ydH06OiR7Zm59YH07XHJcbmV4cG9ydCBjb25zdCBHdWFyZEZuID0gKGZuOiBhbnkpID0+IHsgcmV0dXJuIGAke1BBQ0tBR0V9Ojoke01PRFVMRVMuZ3VhcmR9Ojoke2ZufWB9O1xyXG5leHBvcnQgY29uc3QgVm90ZUZuID0gKGZuOmFueSkgPT4geyByZXR1cm4gYCR7UEFDS0FHRX06OiR7TU9EVUxFUy52b3RlfTo6JHtmbn1gfTtcclxuZXhwb3J0IGNvbnN0IERlbWFuZEZuID0gKGZuOiBhbnkpID0+IHsgcmV0dXJuIGAke1BBQ0tBR0V9Ojoke01PRFVMRVMuZGVtYW5kfTo6JHtmbn1gfTtcclxuZXhwb3J0IGNvbnN0IE9yZGVyRm4gPSAoZm46YW55KSA9PiB7IHJldHVybiBgJHtQQUNLQUdFfTo6JHtNT0RVTEVTLm9yZGVyfTo6JHtmbn1gfTtcclxuZXhwb3J0IGNvbnN0IFJld2FyZEZuID0gKGZuOiBhbnkpID0+IHsgcmV0dXJuIGAke1BBQ0tBR0V9Ojoke01PRFVMRVMucmV3YXJkfTo6JHtmbn1gfTtcclxuZXhwb3J0IGNvbnN0IFNlcnZpY2VGbiA9IChmbjogYW55KSA9PiB7IHJldHVybiBgJHtQQUNLQUdFfTo6JHtNT0RVTEVTLnNlcnZpY2V9Ojoke2ZufWB9O1xyXG5leHBvcnQgY29uc3QgV293b2tGbiA9IChmbjogYW55KSA9PiB7IHJldHVybiBgJHtQQUNLQUdFfTo6JHtNT0RVTEVTLndvd29rfTo6JHtmbn1gfTtcclxuXHJcbmV4cG9ydCBjb25zdCBDTE9DS19PQkpFQ1QgPSBJbnB1dHMuU2hhcmVkT2JqZWN0UmVmKHtcclxuICAgIG9iamVjdElkOlwiMHg2XCIsXHJcbiAgICBtdXRhYmxlOiBmYWxzZSxcclxuICAgIGluaXRpYWxTaGFyZWRWZXJzaW9uOiAxLFxyXG59KTtcclxuXHJcbmV4cG9ydCBlbnVtIERhdGFfVHlwZSB7XHJcbiAgICBUWVBFX0RZTkFNSUNfUVVFUlkgPSAxLFxyXG4gICAgVFlQRV9MT0dJQ19PUEVSQVRPUl9VMTI4X0dSRUFURVIgPSAxMSxcclxuICAgIFRZUEVfTE9HSUNfT1BFUkFUT1JfVTEyOF9HUkVBVEVSX0VRVUFMID0gMTIsXHJcbiAgICBUWVBFX0xPR0lDX09QRVJBVE9SX1UxMjhfTEVTU0VSID0gMTMsXHJcbiAgICBUWVBFX0xPR0lDX09QRVJBVE9SX1UxMjhfTEVTU0VSX0VRVUFMID0gMTQsXHJcbiAgICBUWVBFX0xPR0lDX09QRVJBVE9SX1UxMjhfRVFVQUwgPSAxNSxcclxuICAgIFRZUEVfTE9HSUNfT1BFUkFUT1JfRVFVQUwgPSAxNiwgLy8gVFlQRSZEQVRBKHZlY3Rvcjx1OD4pIE1VU1QgQkUgRVFVQUxcclxuICAgIFRZUEVfTE9HSUNfT1BFUkFUT1JfSEFTX1NVQlNUUklORyA9IDE3LCAvLyBTVUJTVFJJTkdcclxuICAgIFRZUEVfTE9HSUNfQUxXQVlTX1RSVUUgPSAxOCwgLy8gYXdheXMgdHJ1ZVxyXG4gICAgLy8gVFlQRV9MT0dJQ19PUEVSQVRPUl9WRUNVOF9DT05UQUlOUyA9IDE4LCAvLyBTVUIgVkVDPFU4PlxyXG4gICAgVFlQRV9DT05URVhUX1NJR05FUiAgPSA2MCxcclxuICAgIFRZUEVfQ09OVEVYVF9DVVJSRU5UX1BST0dSRVNTID0gNjEsXHJcbiAgICBUWVBFX0NPTlRFWFRfQ1VSUkVOVF9DTE9DSyA9IDYyLFxyXG4gICAgVFlQRV9TVEFUSUNfYm9vbCA9IDEwMCxcclxuICAgIFRZUEVfU1RBVElDX2FkZHJlc3MgPSAxMDEsXHJcbiAgICBUWVBFX1NUQVRJQ191NjQgPSAxMDIsXHJcbiAgICBUWVBFX1NUQVRJQ191OCA9IDEwMyxcclxuICAgIFRZUEVfU1RBVElDX3UxMjggPSAxMDQsXHJcbiAgICBUWVBFX1NUQVRJQ192ZWNfdTggPSAxMDUsXHJcbiAgICBUWVBFX1NUQVRJQ192ZWNfYWRkcmVzcyA9IDEwNixcclxuICAgIFRZUEVfU1RBVElDX3ZlY19ib29sID0gMTA3LFxyXG4gICAgVFlQRV9TVEFUSUNfdmVjX3ZlY191OCA9IDEwOCxcclxuICAgIFRZUEVfU1RBVElDX3ZlY191NjQgPSAxMDksXHJcbiAgICBUWVBFX1NUQVRJQ192ZWNfdTEyOCA9IDExMCxcclxuICAgIFRZUEVfU1RBVElDX29wdGlvbl9hZGRyZXNzID0gMTExLFxyXG4gICAgVFlQRV9TVEFUSUNfb3B0aW9uX2Jvb2wgPSAxMTIsXHJcbiAgICBUWVBFX1NUQVRJQ19vcHRpb25fdTggPSAxMTMsXHJcbiAgICBUWVBFX1NUQVRJQ19vcHRpb25fdTY0ID0gMTE0LFxyXG4gICAgVFlQRV9TVEFUSUNfb3B0aW9uX3UxMjggPSAxMTUsXHJcbiAgICBUWVBFX1NUQVRJQ19ieV92YWx1ZV9zcGVjaWZpZWQgPSAxMjYsXHJcbiAgICBUWVBFX1NUQVRJQ19lcnJvciA9IDEyNyxcclxufVxyXG5cclxuXHJcbmV4cG9ydCBjbGFzcyBDb25maWcge1xyXG4gICAgcHJvdGVjdGVkIG5ldHdvcmsgPSBFTlRSWVBPSU5ULmxvY2FsbmV0O1xyXG5cclxuICAgIHByb3RlY3RlZCBjb25maWcgPSB7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcbiAgICBwcm90ZWN0ZWQgcGFja2FnZSA9IFwiMHg3N2I4M2FlODE5MDQxNTQxNDJlNDg2ODM3MzE4MDAyODU5MzJmZjQ5MzE3Y2RlMjQxYTJkZDgwNDYwZjVkZDM0XCI7XHJcbiAgICBwcm90ZWN0ZWQgc2lnbmVyID0gXCIweGUzODZiYjllMDFiMzUyOGI3NWYzNzUxYWQ4YTFlNDE4YjIwN2FkOTc5ZmVhMzY0MDg3ZGVlZjUyNTBhNzNkM2ZcIjtcclxufVxyXG5cclxuXHJcblxyXG5cclxuXHJcbiIsICJcclxuZXhwb3J0IGZ1bmN0aW9uIHVsZWJEZWNvZGUoYXJyOiBudW1iZXJbXSB8IFVpbnQ4QXJyYXkpOiB7XHJcblx0dmFsdWU6IG51bWJlcjtcclxuXHRsZW5ndGg6IG51bWJlcjtcclxufSB7XHJcblx0bGV0IHRvdGFsID0gMDtcclxuXHRsZXQgc2hpZnQgPSAwO1xyXG5cdGxldCBsZW4gPSAwO1xyXG5cclxuXHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc3RhbnQtY29uZGl0aW9uXHJcblx0d2hpbGUgKHRydWUpIHtcclxuXHRcdGxldCBieXRlID0gYXJyW2xlbl07XHJcblx0XHRsZW4gKz0gMTtcclxuXHRcdHRvdGFsIHw9IChieXRlICYgMHg3ZikgPDwgc2hpZnQ7XHJcblx0XHRpZiAoKGJ5dGUgJiAweDgwKSA9PT0gMCkge1xyXG5cdFx0XHRicmVhaztcclxuXHRcdH1cclxuXHRcdHNoaWZ0ICs9IDc7XHJcblx0fVxyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0dmFsdWU6IHRvdGFsLFxyXG5cdFx0bGVuZ3RoOiBsZW4sXHJcblx0fTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNvbmNhdGVuYXRlKHJlc3VsdENvbnN0cnVjdG9yOmFueSwgLi4uYXJyYXlzOmFueVtdKSB7XHJcbiAgICBsZXQgdG90YWxMZW5ndGggPSAwO1xyXG4gICAgZm9yIChjb25zdCBhcnIgb2YgYXJyYXlzKSB7XHJcbiAgICAgICAgdG90YWxMZW5ndGggKz0gYXJyLmxlbmd0aDtcclxuICAgIH1cclxuICAgIGNvbnN0IHJlc3VsdCA9IG5ldyByZXN1bHRDb25zdHJ1Y3Rvcih0b3RhbExlbmd0aCk7XHJcbiAgICBsZXQgb2Zmc2V0ID0gMDtcclxuICAgIGZvciAoY29uc3QgYXJyIG9mIGFycmF5cykge1xyXG4gICAgICAgIHJlc3VsdC5zZXQoYXJyLCBvZmZzZXQpO1xyXG4gICAgICAgIG9mZnNldCArPSBhcnIubGVuZ3RoO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGFycmF5X2VxdWFsKGFycjE6IGFueVtdLCBhcnIyOiBhbnlbXSkge1xyXG4gICAgLy8gQXJyYXkuc29tZSgpOiBcdTY3MDlcdTRFMDBcdTk4NzlcdTRFMERcdTZFRTFcdThEQjNcdUZGMENcdThGRDRcdTU2REVmYWxzZVxyXG4gICAgaWYgKGFycjEubGVuZ3RoICE9PSBhcnIyLmxlbmd0aCkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gIWFycjEuc29tZSgoaXRlbSkgPT4gIWFycjIuaW5jbHVkZXMoaXRlbSkpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYXJyYXlfdW5pcXVlKGFycjphbnlbXSkgOiBhbnlbXSB7XHJcbiAgICB2YXIgbmV3QXJyID0gW107XHJcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgaWYobmV3QXJyLmluZGV4T2YoYXJyW2ldKSA9PSAtMSkge1xyXG4gICAgICAgICAgICBuZXdBcnIucHVzaChhcnJbaV0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBuZXdBcnI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjYXBpdGFsaXplIChzOnN0cmluZykgOiBzdHJpbmcgeyBcclxuICAgIHJldHVybiBzICYmIHNbMF0udG9VcHBlckNhc2UoKSArIHMuc2xpY2UoMSlcclxufVxyXG5cclxuLy8gZm9yOiBcIjB4c2RqZmtza2Y8MHgyOjpzdWk6OmNvaW48eHh4PiwgMHhmZGZmZjw+PlwiXHJcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZV9vYmplY3RfdHlwZShvYmplY3RfZGF0YTpzdHJpbmcpIDogc3RyaW5nW10ge1xyXG4gICAgdmFyIG9iamVjdF90eXBlIDogc3RyaW5nW10gPSBbXTtcclxuICAgIGxldCB0eXBlX3BvcyA9IG9iamVjdF9kYXRhLmluZGV4T2YoJzwnKTtcclxuICAgIGlmICh0eXBlX3BvcyA+PSAwKSB7IFxyXG4gICAgICAgIGxldCB0ID0gb2JqZWN0X2RhdGEuc2xpY2UoKHR5cGVfcG9zKzEpLCBvYmplY3RfZGF0YS5sZW5ndGgtMSk7XHJcbiAgICAgICAgb2JqZWN0X3R5cGUgPSB0LnNwbGl0KCcsJyk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gb2JqZWN0X3R5cGU7XHJcbn0iLCAiaW1wb3J0IHsgU3VpQ2xpZW50LCBnZXRGdWxsbm9kZVVybCB9IGZyb20gJ0BteXN0ZW4vc3VpLmpzL2NsaWVudCc7XHJcbmltcG9ydCB7IFRyYW5zYWN0aW9uQmxvY2ssIElucHV0cyB9IGZyb20gJ0BteXN0ZW4vc3VpLmpzL3RyYW5zYWN0aW9ucyc7XHJcbmltcG9ydCB7IEJDUywgZ2V0U3VpTW92ZUNvbmZpZywgdG9IRVgsIGZyb21IRVgsIEJjc1JlYWRlciB9IGZyb20gJ0BteXN0ZW4vYmNzJztcclxuaW1wb3J0IHsgR3VhcmRGbiwgRm5DYWxsVHlwZSwgRGF0YV9UeXBlLCBNT0RVTEVTfSBmcm9tICcuL2NvbmZpZyc7XHJcbmltcG9ydCB7IGNvbmNhdGVuYXRlLCBhcnJheV9lcXVhbCwgdWxlYkRlY29kZSB9IGZyb20gJy4vdXRpbCc7XHJcblxyXG5leHBvcnQgZW51bSBHdWFyZF9TZW5zZV9CaW5kZXIge1xyXG4gICAgQU5EID0gMSwgLy8gZmlyc3Qgc2Vuc2Ugb2YgZ3VhcmQgYWx3YXlzIEFORDsgZm9yIGNvbWJpbmluZyBvdGhlciBndWFyZHNcclxuICAgIE9SID0gMixcclxufVxyXG5cclxuZXhwb3J0IHR5cGUgR3VhcmRfU2Vuc2UgPSB7IFxyXG4gICAgaW5wdXQ6IFVpbnQ4QXJyYXk7IFxyXG4gICAgbm90QWZ0ZXJTZW5zZTogYm9vbGVhbjsgXHJcbiAgICBiaW5kZXI6R3VhcmRfU2Vuc2VfQmluZGVyIDtcclxufTtcclxuXHJcbmV4cG9ydCB0eXBlIEd1YXJkX0RhdGEgPSB7XHJcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xyXG4gICAgc2Vuc2VzOiBHdWFyZF9TZW5zZVtdO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlX2d1YXJkKHR4YjpUcmFuc2FjdGlvbkJsb2NrLCBkYXRhOkd1YXJkX0RhdGEpIHtcclxuICAgIHZhciBndWFyZCA9IHR4Yi5tb3ZlQ2FsbCh7XHJcbiAgICAgICAgdGFyZ2V0OiBHdWFyZEZuKCduZXcnKSBhcyBGbkNhbGxUeXBlLFxyXG4gICAgICAgIGFyZ3VtZW50czogW1xyXG4gICAgICAgICAgICB0eGIucHVyZShkYXRhLmRlc2NyaXB0aW9uICwgQkNTLlNUUklORyksXHJcbiAgICAgICAgXSwgIFxyXG4gICAgfSk7XHJcbiAgICBkYXRhPy5zZW5zZXMuZm9yRWFjaCgoc2Vuc2U6IEd1YXJkX1NlbnNlKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coc2Vuc2UuaW5wdXQpO1xyXG4gICAgICAgIHR4Yi5tb3ZlQ2FsbCh7XHJcbiAgICAgICAgICAgIHRhcmdldDogR3VhcmRGbignc2Vuc2VfYWRkJykgYXMgRm5DYWxsVHlwZSxcclxuICAgICAgICAgICAgYXJndW1lbnRzOltcclxuICAgICAgICAgICAgICAgIGd1YXJkLFxyXG4gICAgICAgICAgICAgICAgdHhiLnB1cmUoW10uc2xpY2UuY2FsbChzZW5zZS5pbnB1dCkpLFxyXG4gICAgICAgICAgICAgICAgdHhiLnB1cmUoc2Vuc2Uubm90QWZ0ZXJTZW5zZSwgQkNTLkJPT0wpLFxyXG4gICAgICAgICAgICAgICAgdHhiLnB1cmUoc2Vuc2UuYmluZGVyLCBCQ1MuVTgpLFxyXG4gICAgICAgICAgICBdXHJcbiAgICAgICAgfSlcclxuICAgIH0pO1xyXG4gICAgdHhiLm1vdmVDYWxsKHtcclxuICAgICAgICB0YXJnZXQ6R3VhcmRGbihcImNyZWF0ZVwiKSBhcyBGbkNhbGxUeXBlLFxyXG4gICAgICAgIGFyZ3VtZW50czpbZ3VhcmRdXHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNpZ25lcl9ndWFyZCh0eGI6VHJhbnNhY3Rpb25CbG9jaykge1xyXG4gICAgdHhiLm1vdmVDYWxsKHtcclxuICAgICAgICB0YXJnZXQ6IEd1YXJkRm4oJ2NyZWF0b3JfZ3VhcmQnKSBhcyBGbkNhbGxUeXBlLFxyXG4gICAgICAgIGFyZ3VtZW50czogW11cclxuICAgIH0pOyAvLyB7IGtpbmQ6ICdSZXN1bHQnLCBpbmRleDogMCB9LCByZWYgdG8gYWRkcmVzcyBjb3VsZCB1c2VkIGJ5IFBUQlxyXG59XHJcblxyXG5leHBvcnQgdHlwZSBTZW5zZV9DbWRfVHlwZSA9IHtcclxuICAgIG1vZHVsZTpNT0RVTEVTLCBcclxuICAgIG5hbWU6c3RyaW5nLCBcclxuICAgIGNtZDpudW1iZXIsIFxyXG4gICAgcGFyYW1zOkRhdGFfVHlwZVtdLCBcclxuICAgIHJlc3VsdDpEYXRhX1R5cGVcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBTZW5zZV9DbWQ6YW55ID0gW1xyXG4gICAgW01PRFVMRVMucGVybWlzc2lvbiwgJ2NyZWF0b3InLCAxLCBbXSwgRGF0YV9UeXBlLlRZUEVfU1RBVElDX2FkZHJlc3NdLFxyXG4gICAgW01PRFVMRVMucGVybWlzc2lvbiwgJ2lzX2FkbWluJywgMiwgW0RhdGFfVHlwZS5UWVBFX1NUQVRJQ19hZGRyZXNzXSwgRGF0YV9UeXBlLlRZUEVfU1RBVElDX2Jvb2xdLFxyXG4gICAgW01PRFVMRVMucGVybWlzc2lvbiwgJ2hhc19yaWdodHMnLCAzLCBbRGF0YV9UeXBlLlRZUEVfU1RBVElDX2FkZHJlc3MsIERhdGFfVHlwZS5UWVBFX1NUQVRJQ191NjRdLCBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfYm9vbF0sXHJcbiAgICBbTU9EVUxFUy5wZXJtaXNzaW9uLCAnY29udGFpbnNfYWRkcmVzcycsIDQsIFtEYXRhX1R5cGUuVFlQRV9TVEFUSUNfYWRkcmVzc10sIERhdGFfVHlwZS5UWVBFX1NUQVRJQ19ib29sXSxcclxuICAgIFtNT0RVTEVTLnBlcm1pc3Npb24sICdjb250YWluc19pbmRleCcsIDUsIFtEYXRhX1R5cGUuVFlQRV9TVEFUSUNfYWRkcmVzcywgRGF0YV9UeXBlLlRZUEVfU1RBVElDX3U2NF0sIERhdGFfVHlwZS5UWVBFX1NUQVRJQ19ib29sXSxcclxuICAgIFtNT0RVTEVTLnBlcm1pc3Npb24sICdjb250YWluc19ndWFyZCcsIDYsIFtEYXRhX1R5cGUuVFlQRV9TVEFUSUNfYWRkcmVzcywgRGF0YV9UeXBlLlRZUEVfU1RBVElDX3U2NF0sIERhdGFfVHlwZS5UWVBFX1NUQVRJQ19ib29sXSxcclxuICAgIFtNT0RVTEVTLnJlcG9zaXRvcnksICdwZXJtaXNzaW9uJywgMSwgW10sIERhdGFfVHlwZS5UWVBFX1NUQVRJQ19hZGRyZXNzXSxcclxuICAgIFtNT0RVTEVTLnJlcG9zaXRvcnksICdwb2xpY3lfY29udGFpbnMnLCAyLCBbRGF0YV9UeXBlLlRZUEVfU1RBVElDX3ZlY191OF0sIERhdGFfVHlwZS5UWVBFX1NUQVRJQ19ib29sXSxcclxuICAgIFtNT0RVTEVTLnJlcG9zaXRvcnksICdwb2xpY3lfaGFzX3Blcm1pc3Npb25faW5kZXgnLCAzLCBbRGF0YV9UeXBlLlRZUEVfU1RBVElDX3ZlY191OF0sIERhdGFfVHlwZS5UWVBFX1NUQVRJQ19ib29sXSxcclxuICAgIFtNT0RVTEVTLnJlcG9zaXRvcnksICdwb2xpY3lfcGVybWlzc2lvbl9pbmRleCcsIDQsIFtEYXRhX1R5cGUuVFlQRV9TVEFUSUNfdmVjX3U4XSwgRGF0YV9UeXBlLlRZUEVfU1RBVElDX3U2NF0sXHJcbiAgICBbTU9EVUxFUy5yZXBvc2l0b3J5LCAncG9saWN5X3ZhbHVlX3R5cGUnLCA1LCBbRGF0YV9UeXBlLlRZUEVfU1RBVElDX3ZlY191OF0sIERhdGFfVHlwZS5UWVBFX1NUQVRJQ191OF0sXHJcbiAgICBbTU9EVUxFUy5yZXBvc2l0b3J5LCAnY29udGFpbnNfaWQnLCA2LCBbRGF0YV9UeXBlLlRZUEVfU1RBVElDX2FkZHJlc3NdLCBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfYm9vbF0sICAgXHJcbiAgICBbTU9EVUxFUy5yZXBvc2l0b3J5LCAnY29udGFpbnNfdmFsdWUnLCA3LCBbRGF0YV9UeXBlLlRZUEVfU1RBVElDX2FkZHJlc3MsIERhdGFfVHlwZS5UWVBFX1NUQVRJQ192ZWNfdThdLCBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfYm9vbF0sXHJcbiAgICBbTU9EVUxFUy5yZXBvc2l0b3J5LCAndmFsdWVfd2l0aG91dF90eXBlJywgOCwgW0RhdGFfVHlwZS5UWVBFX1NUQVRJQ19hZGRyZXNzLCBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfdmVjX3U4XSwgRGF0YV9UeXBlLlRZUEVfU1RBVElDX3ZlY191OF0sICAgICAgIFxyXG4gICAgW01PRFVMRVMucmVwb3NpdG9yeSwgJ3ZhbHVlJywgOSwgW0RhdGFfVHlwZS5UWVBFX1NUQVRJQ19hZGRyZXNzLCBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfdmVjX3U4XSwgRGF0YV9UeXBlLlRZUEVfU1RBVElDX3ZlY191OF0sXHJcbiAgICBbTU9EVUxFUy5yZXBvc2l0b3J5LCAndHlwZScsIDEwLCBbXSwgRGF0YV9UeXBlLlRZUEVfU1RBVElDX3U4XSwgICBcclxuICAgIFtNT0RVTEVTLnJlcG9zaXRvcnksICdwb2xpY3lfbW9kZScsIDExLCBbXSwgRGF0YV9UeXBlLlRZUEVfU1RBVElDX3U4XSwgICBcclxuXVxyXG5cclxuZXhwb3J0IGNsYXNzIFNlbnNlTWFrZXIge1xyXG4gICAgcHJvdGVjdGVkIGRhdGEgOiBVaW50OEFycmF5W10gPSBbXTtcclxuICAgIHByb3RlY3RlZCB0eXBlX3ZhbGlkYXRvciA6IERhdGFfVHlwZVtdID0gW107XHJcblxyXG4gICAgY29uc3RydWN0b3IoKSB7IH1cclxuICAgIC8vIHNlcmlhbGl6ZSBjb25zdCAmIGRhdGFcclxuICAgIGFkZF9wYXJhbSh0eXBlOkRhdGFfVHlwZSwgcGFyYW0/OmFueSkgOiBib29sZWFuIHtcclxuICAgICAgICBjb25zdCBiY3MgPSBuZXcgQkNTKGdldFN1aU1vdmVDb25maWcoKSk7XHJcbiAgICAgICAgc3dpdGNoKHR5cGUpICB7XHJcbiAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfYWRkcmVzczogXHJcbiAgICAgICAgICAgIHRoaXMuZGF0YS5wdXNoKGJjcy5zZXIoQkNTLlU4LCB0eXBlKS50b0J5dGVzKCkpO1xyXG4gICAgICAgICAgICB0aGlzLmRhdGEucHVzaChiY3Muc2VyKEJDUy5BRERSRVNTLCBwYXJhbSkudG9CeXRlcygpKTtcclxuICAgICAgICAgICAgdGhpcy50eXBlX3ZhbGlkYXRvci5wdXNoKHR5cGUpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIERhdGFfVHlwZS5UWVBFX1NUQVRJQ19ib29sOlxyXG4gICAgICAgICAgICB0aGlzLmRhdGEucHVzaChiY3Muc2VyKEJDUy5VOCwgdHlwZSkudG9CeXRlcygpKTtcclxuICAgICAgICAgICAgdGhpcy5kYXRhLnB1c2goYmNzLnNlcihCQ1MuQk9PTCwgcGFyYW0pLnRvQnl0ZXMoKSk7XHJcbiAgICAgICAgICAgIHRoaXMudHlwZV92YWxpZGF0b3IucHVzaCh0eXBlKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfdTg6XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YS5wdXNoKGJjcy5zZXIoQkNTLlU4LCB0eXBlKS50b0J5dGVzKCkpO1xyXG4gICAgICAgICAgICB0aGlzLmRhdGEucHVzaChiY3Muc2VyKEJDUy5VOCwgcGFyYW0pLnRvQnl0ZXMoKSk7XHJcbiAgICAgICAgICAgIHRoaXMudHlwZV92YWxpZGF0b3IucHVzaCh0eXBlKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfdTY0OiBcclxuICAgICAgICAgICAgdGhpcy5kYXRhLnB1c2goYmNzLnNlcihCQ1MuVTgsIHR5cGUpLnRvQnl0ZXMoKSk7XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YS5wdXNoKGJjcy5zZXIoQkNTLlU2NCwgcGFyYW0pLnRvQnl0ZXMoKSk7XHJcbiAgICAgICAgICAgIHRoaXMudHlwZV92YWxpZGF0b3IucHVzaCh0eXBlKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfdmVjX3U4OlxyXG4gICAgICAgICAgICB0aGlzLmRhdGEucHVzaChiY3Muc2VyKEJDUy5VOCwgdHlwZSkudG9CeXRlcygpKTtcclxuICAgICAgICAgICAgdGhpcy5kYXRhLnB1c2goYmNzLnNlcihcInZlY3Rvcjx1OD5cIiwgcGFyYW0pLnRvQnl0ZXMoKSk7XHJcbiAgICAgICAgICAgIHRoaXMudHlwZV92YWxpZGF0b3IucHVzaCh0eXBlKTtcclxuICAgICAgICAgICAgLy8gdGhpcy5kYXRhW3RoaXMuZGF0YS5sZW5ndGgtMV0uZm9yRWFjaCgoaXRlbSA6IG51bWJlcikgPT4gY29uc29sZS5sb2coaXRlbSkpXHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgRGF0YV9UeXBlLlRZUEVfQ09OVEVYVF9TSUdORVI6XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YS5wdXNoKGJjcy5zZXIoQkNTLlU4LCB0eXBlKS50b0J5dGVzKCkpO1xyXG4gICAgICAgICAgICB0aGlzLnR5cGVfdmFsaWRhdG9yLnB1c2goRGF0YV9UeXBlLlRZUEVfU1RBVElDX2FkZHJlc3MpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIERhdGFfVHlwZS5UWVBFX0NPTlRFWFRfQ1VSUkVOVF9DTE9DSzpcclxuICAgICAgICAgICAgdGhpcy5kYXRhLnB1c2goYmNzLnNlcihCQ1MuVTgsIHR5cGUpLnRvQnl0ZXMoKSk7XHJcbiAgICAgICAgICAgIHRoaXMudHlwZV92YWxpZGF0b3IucHVzaChEYXRhX1R5cGUuVFlQRV9TVEFUSUNfdTY0KTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9DT05URVhUX0NVUlJFTlRfUFJPR1JFU1M6XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YS5wdXNoKGJjcy5zZXIoQkNTLlU4LCB0eXBlKS50b0J5dGVzKCkpO1xyXG4gICAgICAgICAgICB0aGlzLnR5cGVfdmFsaWRhdG9yLnB1c2goRGF0YV9UeXBlLlRZUEVfU1RBVElDX2FkZHJlc3MpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICAgIGFkZF9jbWQob2JqZWN0X2FkZHJlc3M6c3RyaW5nLCBzZW5zZV9pbmRleDpudW1iZXIpIDogYm9vbGVhbiB7XHJcbiAgICAgICAgaWYgKHNlbnNlX2luZGV4ID49IFNlbnNlX0NtZC5sZW5ndGgpIHsgcmV0dXJuIGZhbHNlOyB9XHJcbiAgICAgICAgbGV0IG9mZnNldCA9IHRoaXMudHlwZV92YWxpZGF0b3IubGVuZ3RoIC0gU2Vuc2VfQ21kW3NlbnNlX2luZGV4XVszXS5sZW5ndGg7XHJcbiAgICAgICAgaWYgKG9mZnNldCA8IDApIHsgXHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTsgXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgdHlwZXMgPSB0aGlzLnR5cGVfdmFsaWRhdG9yLnNsaWNlKG9mZnNldCk7XHJcbiAgICAgICAgaWYgKCFhcnJheV9lcXVhbCh0eXBlcywgU2Vuc2VfQ21kW3NlbnNlX2luZGV4XVszXSkpIHsgLy8gdHlwZSB2YWxpZGF0ZSBcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlOyBcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgYmNzID0gbmV3IEJDUyhnZXRTdWlNb3ZlQ29uZmlnKCkpO1xyXG4gICAgICAgIHRoaXMuZGF0YS5wdXNoKGJjcy5zZXIoQkNTLlU4LCBEYXRhX1R5cGUuVFlQRV9EWU5BTUlDX1FVRVJZKS50b0J5dGVzKCkpOyAvLyBUWVBFXHJcbiAgICAgICAgdGhpcy5kYXRhLnB1c2goYmNzLnNlcihCQ1MuQUREUkVTUywgb2JqZWN0X2FkZHJlc3MpLnRvQnl0ZXMoKSk7IC8vIG9iamVjdCBhZGRyZXNzXHJcbiAgICAgICAgdGhpcy5kYXRhLnB1c2goYmNzLnNlcihCQ1MuVTgsIFNlbnNlX0NtZFtzZW5zZV9pbmRleF1bMl0pLnRvQnl0ZXMoKSk7IC8vIGNtZFxyXG5cclxuICAgICAgICB0aGlzLnR5cGVfdmFsaWRhdG9yLnNwbGljZShvZmZzZXQsIFNlbnNlX0NtZFtzZW5zZV9pbmRleF1bM10ubGVuZ3RoKTsgLy8gZGVsZXRlIHR5cGUgc3RhY2tcclxuICAgICAgICB0aGlzLnR5cGVfdmFsaWRhdG9yLnB1c2goU2Vuc2VfQ21kW3NlbnNlX2luZGV4XVs0XSk7IC8vIGFkZCB0aGUgcmV0dXJuIHZhbHVlIHR5cGUgdG8gdHlwZSBzdGFja1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMudHlwZV92YWxpZGF0b3IpXHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICBhZGRfbG9naWModHlwZTpEYXRhX1R5cGUpIDogYm9vbGVhbiB7XHJcbiAgICAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgRGF0YV9UeXBlLlRZUEVfTE9HSUNfT1BFUkFUT1JfVTEyOF9HUkVBVEVSOlxyXG4gICAgICAgICAgICBjYXNlIERhdGFfVHlwZS5UWVBFX0xPR0lDX09QRVJBVE9SX1UxMjhfR1JFQVRFUl9FUVVBTDpcclxuICAgICAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9MT0dJQ19PUEVSQVRPUl9VMTI4X0xFU1NFUjpcclxuICAgICAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9MT0dJQ19PUEVSQVRPUl9VMTI4X0xFU1NFUl9FUVVBTDpcclxuICAgICAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9MT0dJQ19PUEVSQVRPUl9VMTI4X0VRVUFMOlxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudHlwZV92YWxpZGF0b3IubGVuZ3RoIDwgMikgIHsgcmV0dXJuIGZhbHNlOyB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIW1hdGNoX3UxMjgodGhpcy50eXBlX3ZhbGlkYXRvclt0aGlzLnR5cGVfdmFsaWRhdG9yLmxlbmd0aCAtIDFdKSkgeyByZXR1cm4gZmFsc2U7IH1cclxuICAgICAgICAgICAgICAgIGlmICghbWF0Y2hfdTEyOCh0aGlzLnR5cGVfdmFsaWRhdG9yW3RoaXMudHlwZV92YWxpZGF0b3IubGVuZ3RoIC0gMl0pKSB7IHJldHVybiBmYWxzZTsgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgRGF0YV9UeXBlLlRZUEVfTE9HSUNfT1BFUkFUT1JfRVFVQUw6XHJcbiAgICAgICAgICAgIGNhc2UgRGF0YV9UeXBlLlRZUEVfTE9HSUNfT1BFUkFUT1JfSEFTX1NVQlNUUklORzpcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnR5cGVfdmFsaWRhdG9yLmxlbmd0aCA8IDIpICB7IHJldHVybiBmYWxzZTsgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGJjcyA9IG5ldyBCQ1MoZ2V0U3VpTW92ZUNvbmZpZygpKTtcclxuICAgICAgICB0aGlzLmRhdGEucHVzaChiY3Muc2VyKEJDUy5VOCwgdHlwZSkudG9CeXRlcygpKTsgLy8gVFlQRSAgICAgXHJcbiAgICAgICAgdGhpcy50eXBlX3ZhbGlkYXRvci5zcGxpY2UodGhpcy50eXBlX3ZhbGlkYXRvci5sZW5ndGggLSAyKTsgLy8gZGVsZXRlIHR5cGUgc3RhY2sgICBcclxuICAgICAgICB0aGlzLnR5cGVfdmFsaWRhdG9yLnB1c2goRGF0YV9UeXBlLlRZUEVfU1RBVElDX2Jvb2wpOyAvLyBhZGQgYm9vbCB0byB0eXBlIHN0YWNrXHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgbWFrZShiTm90QWZ0ZXJTZW5zZTpib29sZWFuLCBiaW5kZXI6R3VhcmRfU2Vuc2VfQmluZGVyKSA6IHVuZGVmaW5lZCB8IEd1YXJkX1NlbnNlIHtcclxuICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMudHlwZV92YWxpZGF0b3IpO1xyXG4gICAgICAgIC8vdGhpcy5kYXRhLmZvckVhY2goKHZhbHVlOlVpbnQ4QXJyYXkpID0+IGNvbnNvbGUubG9nKHZhbHVlKSk7XHJcbiAgICAgICAgaWYgKHRoaXMudHlwZV92YWxpZGF0b3IubGVuZ3RoICE9IDEgfHwgdGhpcy50eXBlX3ZhbGlkYXRvclswXSAhPSBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfYm9vbCkgeyBcclxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICB9IC8vIEVSUk9SXHJcblxyXG4gICAgICAgIGxldCBpbnB1dCA9IGNvbmNhdGVuYXRlKFVpbnQ4QXJyYXksIC4uLnRoaXMuZGF0YSkgYXMgVWludDhBcnJheTtcclxuICAgICAgICBjb25zdCBzZW5zZTpHdWFyZF9TZW5zZSA9IHtpbnB1dDppbnB1dCwgbm90QWZ0ZXJTZW5zZTpiTm90QWZ0ZXJTZW5zZSwgYmluZGVyOmJpbmRlcn07XHJcbiAgICAgICAgcmV0dXJuIHNlbnNlO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBtYXRjaF91MTI4KHR5cGU6RGF0YV9UeXBlKSA6IGJvb2xlYW4ge1xyXG4gICAgaWYgKHR5cGUgPT0gRGF0YV9UeXBlLlRZUEVfU1RBVElDX29wdGlvbl91OCB8fCBcclxuICAgICAgICB0eXBlID09IERhdGFfVHlwZS5UWVBFX1NUQVRJQ19vcHRpb25fdTY0IHx8IFxyXG4gICAgICAgIHR5cGUgPT0gRGF0YV9UeXBlLlRZUEVfU1RBVElDX29wdGlvbl91MTI4ICkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxufVxyXG5cclxuLy8gcGFyc2UgZ3VhcmQgc2Vuc2VzIGlucHV0IGJ5dGVzIG9mIGEgZ3VhcmQsIHJldHVybiBbb2JqZWN0aWRzXSBmb3IgJ3F1ZXJ5X2NtZCcgXHJcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZV9zZW5zZV9ic2MoY2hhaW5fc2Vuc2VfYnNjOlVpbnQ4QXJyYXkpICA6IHVuZGVmaW5lZCB8IHN0cmluZ1tdIHtcclxuICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgdmFyIGFycmF5ID0gW10uc2xpY2UuY2FsbChjaGFpbl9zZW5zZV9ic2MucmV2ZXJzZSgpKTtcclxuICAgIGNvbnN0IGJjcyA9IG5ldyBCQ1MoZ2V0U3VpTW92ZUNvbmZpZygpKTtcclxuICAgIHZhciByZXN1bHQgPSBbXTtcclxuICAgIHdoaWxlIChhcnJheS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgdmFyIHR5cGUgOiB1bmtub3duID0gYXJyYXkuc2hpZnQoKSA7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2codHlwZSk7XHJcbiAgICAgICAgc3dpdGNoICh0eXBlIGFzIERhdGFfVHlwZSkge1xyXG4gICAgICAgICAgICBjYXNlIERhdGFfVHlwZS5UWVBFX0NPTlRFWFRfU0lHTkVSOlxyXG4gICAgICAgICAgICBjYXNlIERhdGFfVHlwZS5UWVBFX0NPTlRFWFRfQ1VSUkVOVF9DTE9DSzpcclxuICAgICAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9DT05URVhUX0NVUlJFTlRfUFJPR1JFU1M6XHJcbiAgICAgICAgICAgIGNhc2UgRGF0YV9UeXBlLlRZUEVfTE9HSUNfT1BFUkFUT1JfVTEyOF9HUkVBVEVSOlxyXG4gICAgICAgICAgICBjYXNlIERhdGFfVHlwZS5UWVBFX0xPR0lDX09QRVJBVE9SX1UxMjhfR1JFQVRFUl9FUVVBTDpcclxuICAgICAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9MT0dJQ19PUEVSQVRPUl9VMTI4X0xFU1NFUjpcclxuICAgICAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9MT0dJQ19PUEVSQVRPUl9VMTI4X0xFU1NFUl9FUVVBTDpcclxuICAgICAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9MT0dJQ19PUEVSQVRPUl9VMTI4X0VRVUFMOlxyXG4gICAgICAgICAgICBjYXNlIERhdGFfVHlwZS5UWVBFX0xPR0lDX09QRVJBVE9SX0VRVUFMOlxyXG4gICAgICAgICAgICBjYXNlIERhdGFfVHlwZS5UWVBFX0xPR0lDX09QRVJBVE9SX0hBU19TVUJTVFJJTkc6XHJcbiAgICAgICAgICAgIGJyZWFrOyAgICBcclxuICAgICAgICBjYXNlIERhdGFfVHlwZS5UWVBFX1NUQVRJQ19hZGRyZXNzOiBcclxuICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnMHgnICsgYmNzLmRlKEJDUy5BRERSRVNTLCAgVWludDhBcnJheS5mcm9tKGFycmF5KSkudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgICAgIGFycmF5LnNwbGljZSgwLCAzMik7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgRGF0YV9UeXBlLlRZUEVfU1RBVElDX2Jvb2w6XHJcbiAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfdTg6XHJcbiAgICAgICAgICAgIGFycmF5LnNwbGljZSgwLCAxKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfdTY0OiBcclxuICAgICAgICAgICAgYXJyYXkuc3BsaWNlKDAsIDgpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIERhdGFfVHlwZS5UWVBFX1NUQVRJQ191MTI4OiBcclxuICAgICAgICAgICAgYXJyYXkuc3BsaWNlKDAsIDE2KTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9TVEFUSUNfdmVjX3U4OlxyXG4gICAgICAgICAgICBsZXQge3ZhbHVlLCBsZW5ndGh9ID0gdWxlYkRlY29kZShVaW50OEFycmF5LmZyb20oYXJyYXkpKTtcclxuICAgICAgICAgICAgYXJyYXkuc3BsaWNlKDAsIHZhbHVlK2xlbmd0aCk7XHJcbiAgICAgICAgICAgIGJyZWFrOyAgICAgXHJcbiAgICAgICAgY2FzZSBEYXRhX1R5cGUuVFlQRV9EWU5BTUlDX1FVRVJZOlxyXG4gICAgICAgICAgICByZXN1bHQucHVzaCgnMHgnICsgYmNzLmRlKEJDUy5BRERSRVNTLCAgVWludDhBcnJheS5mcm9tKGFycmF5KSkudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgICAgIGFycmF5LnNwbGljZSgwLCAzMyk7IC8vIGFkZHJlc3MgKyBjbWRcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3BhcnNlX3NlbnNlX2JzYzp1bmRlZmluZWQnKTtcclxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsgLy8gZXJyb3JcclxuICAgICAgICB9XHJcbiAgICB9IFxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuXHJcbiIsICJpbXBvcnQgeyBTdWlDbGllbnQsIGdldEZ1bGxub2RlVXJsLCBTdWlPYmplY3RSZXNwb25zZSB9IGZyb20gJ0BteXN0ZW4vc3VpLmpzL2NsaWVudCc7XHJcbmltcG9ydCB7IFRyYW5zYWN0aW9uQmxvY2ssIElucHV0cywgdHlwZSBUcmFuc2FjdGlvbk9iamVjdElucHV0IH0gZnJvbSAnQG15c3Rlbi9zdWkuanMvdHJhbnNhY3Rpb25zJztcclxuaW1wb3J0IHsgRWQyNTUxOUtleXBhaXIgfSBmcm9tICdAbXlzdGVuL3N1aS5qcy9rZXlwYWlycy9lZDI1NTE5JztcclxuaW1wb3J0IHsgQkNTLCBnZXRTdWlNb3ZlQ29uZmlnLCB0b0hFWCwgZnJvbUhFWCwgQmNzUmVhZGVyIH0gZnJvbSAnQG15c3Rlbi9iY3MnO1xyXG5pbXBvcnQgeyBFTlRSWVBPSU5ULCBHdWFyZEZuLCBGbkNhbGxUeXBlLCBPQkpFQ1RTX1RZUEUsIE9CSkVDVFNfVFlQRV9QUkVGSVgsIE1PRFVMRVMsIFBBQ0tBR0UsIENvbmZpZ19FbnRyeVBvaW50fSBmcm9tICcuL2NvbmZpZyc7XHJcbmltcG9ydCB7IHBhcnNlX3NlbnNlX2JzYyB9IGZyb20gJy4vZ3VhcmQnO1xyXG5pbXBvcnQgeyBjb25jYXRlbmF0ZSwgYXJyYXlfdW5pcXVlLCBjYXBpdGFsaXplLCBwYXJzZV9vYmplY3RfdHlwZSB9IGZyb20gJy4vdXRpbCc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFF1ZXJ5IHtcclxuXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBNQVhfR1VBUkQgPSA0O1xyXG5leHBvcnQgdHlwZSBHdWFyZF9RdWVyeV9PYmplY3QgPSB7XHJcbiAgICB0YXJnZXQ6IEZuQ2FsbFR5cGUsXHJcbiAgICBvYmplY3Q6IFRyYW5zYWN0aW9uT2JqZWN0SW5wdXQsXHJcbiAgICB0eXBlczogc3RyaW5nW10sXHJcbn1cclxuZXhwb3J0IHR5cGUgR3VhcmRfUXVlcnlfT2JqZWN0X1Jlc3VsdCA9IHtcclxuICAgIGd1YXJkX2lkczogc3RyaW5nW10sXHJcbiAgICBvYmplY3RzOiBHdWFyZF9RdWVyeV9PYmplY3RbXSxcclxufVxyXG5cclxuLy8gcXVlcnkgZ3VhcmQgb2JqZWN0cyB0aGF0IGNvdWxkIGNhbGwgJ3F1ZXJ5X2NtZCcgZm9yIHBhc3Nwb3J0IHZlcmlmeWluZ1xyXG4vLyAxLiBhd2FpdCBzZW5zZXNfdmVjLCBnZXQgc2Vuc2VzIGZvciBndWFyZHNcclxuLy8gMi4gcGFyc2Ugc2Vuc2VzIHRvIGZpbmQgYWxsIGd1YXJkX3F1ZXJ5IGNhbGxzIGFuZCBvYmplY3RpZHNcclxuLy8gMy4gYXdhaXQgYWxsIGd1YXJkX3F1ZXJ5IG9iamVjdHMgaW5mb21hdGlvblxyXG5leHBvcnQgY29uc3QgcnBjX2d1YXJkX3F1ZXJ5X29iamVjdHMgPSBhc3luYyAoc2VuZGVyX2FkZHI6c3RyaW5nLCBndWFyZF9pZHM6c3RyaW5nW10pIDogXHJcbiAgICBQcm9taXNlPEd1YXJkX1F1ZXJ5X09iamVjdF9SZXN1bHQgfCB1bmRlZmluZWQgPiA9PiB7XHJcbiAgICBpZiAoZ3VhcmRfaWRzLmxlbmd0aCA9PSAwKSB7IHJldHVybiB7Z3VhcmRfaWRzOmd1YXJkX2lkcywgb2JqZWN0czpbXX0gfVxyXG4gICAgaWYgKGd1YXJkX2lkcy5sZW5ndGggPiBNQVhfR1VBUkQpIHsgXHJcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZCA7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY2xpZW50ID0gIG5ldyBTdWlDbGllbnQoeyB1cmw6IGdldEZ1bGxub2RlVXJsKENvbmZpZ19FbnRyeVBvaW50KSB9KTsgIFxyXG4gICAgY29uc3QgdHhiID0gbmV3IFRyYW5zYWN0aW9uQmxvY2soKTtcclxuICAgIFxyXG4gICAgLy8gZ3VhcmQ6OnNlbnNlc192ZWMgLT4gc2Vuc2VzIGJ5dGVzXHJcbiAgICBmb3IgKGxldCBpID0gMDsgIGkgPCBndWFyZF9pZHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB0eGIubW92ZUNhbGwoe1xyXG4gICAgICAgICAgICB0YXJnZXQ6R3VhcmRGbignc2Vuc2VzX3ZlYycpIGFzIEZuQ2FsbFR5cGUsXHJcbiAgICAgICAgICAgIGFyZ3VtZW50czogW3R4Yi5vYmplY3QoZ3VhcmRfaWRzW2ldKV1cclxuICAgICAgICB9KTsgICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIHZhciBvYmplY3RzX2luZm8gPSBhd2FpdCBjbGllbnQuZGV2SW5zcGVjdFRyYW5zYWN0aW9uQmxvY2soe3NlbmRlcjpzZW5kZXJfYWRkciwgdHJhbnNhY3Rpb25CbG9jazp0eGJ9KTtcclxuICAgIHZhciBvYmplY3RzOnN0cmluZ1tdID0gW107XHJcbiAgICBjb25zdCBiY3MgPSBuZXcgQkNTKGdldFN1aU1vdmVDb25maWcoKSk7XHJcblxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAob2JqZWN0c19pbmZvLnJlc3VsdHMgYXMgYW55W10pPy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGxldCByZXQgPSAob2JqZWN0c19pbmZvLnJlc3VsdHMgYXMgYW55W10pW2ldLnJldHVyblZhbHVlcyBhcyBhbnlbXTtcclxuICAgICAgICB2YXIgYnVmID0gbmV3IFVpbnQ4QXJyYXk7IFxyXG4gICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgcmV0Lmxlbmd0aDsgaysrKSB7IC8vIFtkYXRhLCAndmVjdG9yPHU4PiddXHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJldFtrXSk7XHJcbiAgICAgICAgICAgIC8vIGxpc3Qgb2Ygb2JqZWN0cyB0byAncXVlcnlfY21kJ1xyXG4gICAgICAgICAgICBvYmplY3RzID0gb2JqZWN0cy5jb25jYXQoKHBhcnNlX3NlbnNlX2JzYyhuZXcgVWludDhBcnJheShiY3MuZGUoXCJ2ZWN0b3I8dTg+XCIsIFVpbnQ4QXJyYXkuZnJvbShyZXRba11bMF0pKSkucmV2ZXJzZSgpKSkgYXMgc3RyaW5nW10pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZiAob2JqZWN0cyA9PSB1bmRlZmluZWQgfHwgb2JqZWN0cy5sZW5ndGggPT0gMCkgcmV0dXJuIHtndWFyZF9pZHM6Z3VhcmRfaWRzLCBvYmplY3RzOltdfTtcclxuICAgIGNvbnNvbGUubG9nKG9iamVjdHMpXHJcblxyXG4gICAgLy8gdW5pcXVlIG9iamVjdHMgZm9yIHF1ZXJ5IG9iamVjdCBpbmZvbWF0aW9uXHJcbiAgICB2YXIgcXVlcmllcyA9IGFycmF5X3VuaXF1ZShvYmplY3RzIGFzIHN0cmluZ1tdKTsgXHJcbiAgICB2YXIgcXVlcmllc19pbmZvICA9IGF3YWl0IGNsaWVudC5jYWxsKCdzdWlfbXVsdGlHZXRPYmplY3RzJywgW3F1ZXJpZXMsIHtcInNob3dUeXBlXCI6IHRydWV9XSkgYXMgU3VpT2JqZWN0UmVzcG9uc2VbXTsgIFxyXG5cclxuICAgIC8vIFtbZm4sIG9ianJlZl1dIGZvciAncXVlcnlfY21kJ1xyXG4gICAgbGV0IHJlc3VsdCA6IEd1YXJkX1F1ZXJ5X09iamVjdFtdID0gW107IGxldCBiRm91bmQgOiBib29sZWFuO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvYmplY3RzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgYkZvdW5kID0gZmFsc2U7XHJcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBxdWVyaWVzX2luZm8ubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgaWYgKHF1ZXJpZXNfaW5mb1tqXS5kYXRhPy5vYmplY3RJZCA9PSBvYmplY3RzW2ldKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IE9CSkVDVFNfVFlQRS5sZW5ndGg7IGsrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChxdWVyaWVzX2luZm9bal0uZGF0YT8udHlwZT8uaW5jbHVkZXMoT0JKRUNUU19UWVBFW2tdKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZm4gPSBPQkpFQ1RTX1RZUEVfUFJFRklYW2tdICsgJ2d1YXJkX3F1ZXJ5JyBhcyBGbkNhbGxUeXBlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgb2JqID0gSW5wdXRzLlNoYXJlZE9iamVjdFJlZih7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RJZDogb2JqZWN0c1tpXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG11dGFibGU6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5pdGlhbFNoYXJlZFZlcnNpb246IHF1ZXJpZXNfaW5mb1tqXS5kYXRhIS52ZXJzaW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSBhcyBUcmFuc2FjdGlvbk9iamVjdElucHV0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgdHlwZXMgPSBwYXJzZV9vYmplY3RfdHlwZShxdWVyaWVzX2luZm9bal0uZGF0YT8udHlwZSBhcyBzdHJpbmcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh7dGFyZ2V0OmZuLCBvYmplY3Q6b2JqLCB0eXBlczp0eXBlc30pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhpICsgJyAgIGlkOiAnICsgb2JqZWN0c1tpXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJGb3VuZCA9IHRydWU7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoYkZvdW5kKSBicmVhazsgICAgICAgXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghYkZvdW5kKSByZXR1cm4gdW5kZWZpbmVkOyAvLyBzb21lIG9iamVjdCBub3QgbWF0Y2ggaW5mb1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7Z3VhcmRfaWRzOmd1YXJkX2lkcywgb2JqZWN0czpyZXN1bHR9OyBcclxufSIsICJcclxuaW1wb3J0IHsgU3VpQ2xpZW50LCBnZXRGdWxsbm9kZVVybCwgU3VpT2JqZWN0UmVzcG9uc2UgfSBmcm9tICdAbXlzdGVuL3N1aS5qcy9jbGllbnQnO1xyXG5pbXBvcnQgeyBUcmFuc2FjdGlvbkJsb2NrLCBJbnB1dHMsIHR5cGUgVHJhbnNhY3Rpb25SZXN1bHQgfSBmcm9tICdAbXlzdGVuL3N1aS5qcy90cmFuc2FjdGlvbnMnO1xyXG5pbXBvcnQgeyBFZDI1NTE5S2V5cGFpciB9IGZyb20gJ0BteXN0ZW4vc3VpLmpzL2tleXBhaXJzL2VkMjU1MTknO1xyXG5pbXBvcnQgeyBCQ1MsIGdldFN1aU1vdmVDb25maWcsIHRvSEVYLCBmcm9tSEVYLCBCY3NSZWFkZXIgfSBmcm9tICdAbXlzdGVuL2Jjcyc7XHJcbmltcG9ydCB7IENvbmZpZ19FbnRyeVBvaW50LCBDTE9DS19PQkpFQ1QsIFBhc3Nwb3J0Rm4sIEd1YXJkRm4sIEZuQ2FsbFR5cGUsIERhdGFfVHlwZSwgTU9EVUxFUywgU0VOREVSX1BSSVYsIEFERFIsIFBBQ0tBR0UsIFNlcnZpY2VGbiwgUGVybWlzc2lvbkZuLCBEZW1hbmRGbn0gZnJvbSAnLi9jb25maWcnO1xyXG5pbXBvcnQgeyBTZW5zZU1ha2VyLCBHdWFyZF9TZW5zZV9CaW5kZXIsIGNyZWF0ZV9ndWFyZCwgcGFyc2Vfc2Vuc2VfYnNjLCBHdWFyZF9TZW5zZSB9IGZyb20gJy4vZ3VhcmQnO1xyXG5pbXBvcnQgeyBjb25jYXRlbmF0ZSwgYXJyYXlfdW5pcXVlLCBjYXBpdGFsaXplLCBwYXJzZV9vYmplY3RfdHlwZX0gZnJvbSAnLi91dGlsJztcclxuaW1wb3J0IHsgR3VhcmRfUXVlcnlfT2JqZWN0X1Jlc3VsdCwgcnBjX2d1YXJkX3F1ZXJ5X29iamVjdHMgfSBmcm9tICcuL3F1ZXJ5J1xyXG5pbXBvcnQgeyB2ZXJpZnksIGRlc3Ryb3ksICB9IGZyb20gJy4vcGFzc3BvcnQnXHJcblxyXG5leHBvcnQgZW51bSBQZXJtaXNzaW9uSW5kZXgge1xyXG4gICAgcmVwb3NpdG9yeV9kZXNjcmlwdGlvbl9zZXQgPSAxMDEsXHJcbiAgICByZXBvc2l0b3J5X3BvbGljeV9tb2RlX3NldCA9IDEwMixcclxuICAgIHJlcG9zaXRvcnlfcG9saWN5X2FkZCA9IDEwNixcclxuICAgIHJlcG9zaXRvcnlfcG9saWN5X3JlbW92ZSA9IDEwNyxcclxuICAgIHJlcG9zaXRvcnlfcG9saWN5X3JlbW92ZV9hbGwgPSAxMDcsXHJcbiAgICByZXBvc2l0b3J5X3BvbGljeV9kZXNjcmlwdGlvbl9zZXQgPSAxMDksXHJcbiAgICByZXBvc2l0b3J5X3BvbGljeV9vcGVuZnVuY2luZGV4X3NldCA9IDExMCxcclxuXHJcbn1cclxuZXhwb3J0IHR5cGUgUGVybWlzc2lvbl9JbmRleCA9IHtcclxuICAgIGluZGV4OlBlcm1pc3Npb25JbmRleDtcclxuICAgIGd1YXJkPzpzdHJpbmc7XHJcbn1cclxuZXhwb3J0IHR5cGUgUGVybWlzc2lvbl9FbnRpdHkgPSB7XHJcbiAgICB3aG86c3RyaW5nO1xyXG4gICAgcGVybWlzc2lvbnM6UGVybWlzc2lvbl9JbmRleFtdO1xyXG59XHJcblxyXG5leHBvcnQgdHlwZSBQZXJtaXNzaW9uX0RhdGEgPSB7XHJcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xyXG4gICAgZW50aXRpZXM6IFBlcm1pc3Npb25fRW50aXR5W107XHJcbiAgICBhZG1pbjogc3RyaW5nW107XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVfcGVybWlzc2lvbih0eGI6VHJhbnNhY3Rpb25CbG9jaywgZGF0YTpQZXJtaXNzaW9uX0RhdGEpIHtcclxuICAgIGxldCBwZXJtaXNzaW9uID0gdHhiLm1vdmVDYWxsKHtcclxuICAgICAgICB0YXJnZXQ6IFBlcm1pc3Npb25GbignbmV3JykgYXMgRm5DYWxsVHlwZSxcclxuICAgICAgICBhcmd1bWVudHM6IFt0eGIucHVyZShkYXRhLmRlc2NyaXB0aW9uKV1cclxuICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgbGV0IGd1YXJkczphbnlbXSAgPSBbXTtcclxuICAgIGNvbnNvbGUubG9nKGRhdGEuZW50aXRpZXMpO1xyXG4gICAgZGF0YS5lbnRpdGllcy5mb3JFYWNoKChlbnRpdHk6UGVybWlzc2lvbl9FbnRpdHkpPT4ge1xyXG4gICAgICAgIGxldCBwZXJtaXNzaW9uX2luZGV4Om51bWJlcltdID0gW107XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAgZW50aXR5LnBlcm1pc3Npb25zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGxldCBpbmRleCA9IGVudGl0eS5wZXJtaXNzaW9uc1tpXS5pbmRleDtcclxuICAgICAgICAgICAgaWYgKGluZGV4Py5ndWFyZCAmJiBpbmRleC5ndWFyZC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBndWFyZHMucHVzaCh7d2hvOmVudGl0eS53aG8sIGluZGV4OmluZGV4LmluZGV4LCBndWFyZDppbmRleC5ndWFyZH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBlcm1pc3Npb25faW5kZXgucHVzaChpbmRleC5pbmRleCk7ICAgICAgICAgICAgXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChwZXJtaXNzaW9uX2luZGV4Lmxlbmd0aCAgPiAwKSB7XHJcbiAgICAgICAgICAgIHR4Yi5tb3ZlQ2FsbCh7XHJcbiAgICAgICAgICAgICAgICB0YXJnZXQ6UGVybWlzc2lvbkZuKCdhZGRfYmF0Y2gnKSBhcyBGbkNhbGxUeXBlLFxyXG4gICAgICAgICAgICAgICAgYXJndW1lbnRzOltwZXJtaXNzaW9uLCB0eGIucHVyZShlbnRpdHkud2hvLCBCQ1MuQUREUkVTUyksIHR4Yi5wdXJlKHBlcm1pc3Npb24sICd2ZWN0b3I8dTY0PicpXVxyXG4gICAgICAgICAgICB9KSAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgY29uc29sZS5sb2coJzIyMjIyJyk7XHJcblxyXG4gICAgLy8gc2V0IGd1YXJkc1xyXG4gICAgZ3VhcmRzLmZvckVhY2goKHt3aG8sIGluZGV4LCBndWFyZH0pID0+IHtcclxuICAgICAgICB0eGIubW92ZUNhbGwoe1xyXG4gICAgICAgICAgICB0YXJnZXQ6UGVybWlzc2lvbkZuKCdndWFyZF9zZXQnKSBhcyBGbkNhbGxUeXBlLFxyXG4gICAgICAgICAgICBhcmd1bWVudHM6WyBwZXJtaXNzaW9uLCB0eGIucHVyZSh3aG8sIEJDUy5BRERSRVNTKSwgdHhiLnB1cmUoaW5kZXgsIEJDUy5VNjQpLCB0eGIub2JqZWN0KGd1YXJkKV1cclxuICAgICAgICB9KVxyXG4gICAgfSlcclxuXHJcbiAgICAvLyBhZG1pbnNcclxuICAgIHR4Yi5tb3ZlQ2FsbCh7XHJcbiAgICAgICAgdGFyZ2V0OlBlcm1pc3Npb25GbignYWRtaW5fYWRkX2JhdGNoJykgIGFzIEZuQ2FsbFR5cGUsXHJcbiAgICAgICAgYXJndW1lbnRzOlsgcGVybWlzc2lvbiwgdHhiLnB1cmUoZGF0YS5hZG1pbiwgJ3ZlY3RvcjxhZGRyZXNzPicpXVxyXG4gICAgfSk7XHJcbiAgICB0eGIubW92ZUNhbGwoe1xyXG4gICAgICAgIHRhcmdldDpQZXJtaXNzaW9uRm4oJ2NyZWF0ZScpICBhcyBGbkNhbGxUeXBlLFxyXG4gICAgICAgIGFyZ3VtZW50czpbIHBlcm1pc3Npb24gXSAgICAgICAgXHJcbiAgICB9KVxyXG59Il0sCiAgIm1hcHBpbmdzIjogIjtBQUFBLFNBQVMsYUFBQUEsWUFBVyxrQkFBQUMsdUJBQXlDO0FBQzdELFNBQVMsb0JBQUFDLHlCQUF3RDtBQUNqRSxTQUFTLHNCQUFzQjtBQUMvQixTQUFTLE9BQUFDLE1BQThCLFdBQUFDLGdCQUEwQjs7O0FDRmpFLFNBQVMsY0FBYzs7O0FDeURoQixTQUFTLFdBQVksR0FBbUI7QUFDM0MsU0FBTyxLQUFLLEVBQUUsQ0FBQyxFQUFFLFlBQVksSUFBSSxFQUFFLE1BQU0sQ0FBQztBQUM5Qzs7O0FEakRPLElBQU0sb0JBQStCO0FBR3JDLElBQUksVUFBVTtBQUdkLElBQU0sY0FBYztBQUNwQixJQUFNLE9BQU87QUFHYixJQUFLLFVBQUwsa0JBQUtDLGFBQUw7QUFDSCxFQUFBQSxTQUFBLGFBQVU7QUFDVixFQUFBQSxTQUFBLFVBQU87QUFDUCxFQUFBQSxTQUFB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TXhEO0FBRUEsSUFBTSxrQkFBbUM7QUFBQSxFQUNyQyxhQUFhO0FBQUEsRUFDYixPQUFPLENBQUMsTUFBTSxzRUFBc0Usb0VBQW9FO0FBQUEsRUFDeEosVUFBVTtBQUFBLElBQ04sRUFBQyxLQUFJLHNFQUFzRSxhQUFZO0FBQUEsTUFDbkYsRUFBQyx1Q0FBMkM7QUFBQSxNQUM1QyxFQUFDLDRDQUFnRDtBQUFBLElBQ3JELEVBQUM7QUFBQSxJQUNELEVBQUMsS0FBSSxzRUFBc0UsYUFBWTtBQUFBLE1BQ25GLEVBQUMsMENBQThDO0FBQUEsTUFDL0MsRUFBQywyQ0FBZ0QsT0FBTSxxRUFBb0U7QUFBQSxJQUMvSCxFQUFDO0FBQUEsSUFDRCxFQUFDLEtBQUssTUFBTSxhQUFZLENBQUMsRUFBQztBQUFBLEVBQzlCO0FBQ0o7QUFFQSxJQUFNLGFBQWEsT0FBTyxTQUEyQztBQUNqRSxRQUFNLFNBQVUsSUFBSUUsV0FBVSxFQUFFLEtBQUtDLGdCQUFlLGlCQUFpQixFQUFFLENBQUM7QUFDeEUsUUFBTSxNQUFNLElBQUlDLGtCQUFpQjtBQUVqQyxvQkFBa0IsS0FBSyxJQUFJO0FBRTNCLFFBQU0sVUFBVUMsU0FBUSxXQUFXO0FBQ25DLFFBQU0sVUFBVSxlQUFlLGNBQWMsT0FBTztBQUVwRCxRQUFNLFVBQVUsRUFBRSxhQUFhLEtBQUs7QUFDcEMsUUFBTSxXQUFXLE1BQU0sT0FBTywrQkFBK0I7QUFBQSxJQUN6RCxrQkFBa0I7QUFBQSxJQUNsQixRQUFRO0FBQUEsSUFDUjtBQUFBLEVBQ0osQ0FBQztBQUNELE1BQUksZUFBZSxTQUFTLFNBQVMsUUFBUSxDQUFDLEVBQUUsVUFBVTtBQUMxRCxVQUFRLElBQUksbUJBQW1CLFlBQVk7QUFDM0MsU0FBTztBQUNYO0FBZ1NBLEtBQUssRUFBRSxLQUFLLFFBQVEsR0FBRyxFQUFFLE1BQU0sUUFBUSxLQUFLOyIsCiAgIm5hbWVzIjogWyJTdWlDbGllbnQiLCAiZ2V0RnVsbG5vZGVVcmwiLCAiVHJhbnNhY3Rpb25CbG9jayIsICJCQ1MiLCAiZnJvbUhFWCIsICJNT0RVTEVTIiwgIklucHV0cyIsICJCQ1MiLCAiZ2V0U3VpTW92ZUNvbmZpZyIsICJCQ1MiLCAicGVybWlzc2lvbiIsICJCQ1MiLCAiU3VpQ2xpZW50IiwgImdldEZ1bGxub2RlVXJsIiwgIlRyYW5zYWN0aW9uQmxvY2siLCAiZnJvbUhFWCJdCn0K

	
import ts from 'typescript/lib/tsserverlibrary';
import { GraphQLSchema, FragmentDefinitionNode } from 'graphql';

declare function init(modules: { typescript: typeof ts }): void;

declare function getGraphQLDiagnostics(
  filename: string,
  schema: {
    current: GraphQLSchema | null;
    version: number;
  },
  info: ts.server.PluginCreateInfo
): ts.Diagnostic[] | undefined;

declare function unrollTadaFragments(
  fragmentsArray: ts.ArrayLiteralExpression,
  wip: FragmentDefinitionNode[],
  info: ts.server.PluginCreateInfo
): FragmentDefinitionNode[];
declare function findAllPersistedCallExpressions(
  sourceFile: ts.SourceFile
): Array<ts.CallExpression>;

declare const getDocumentReferenceFromTypeQuery: (
  typeQuery: ts.TypeQueryNode,
  filename: string,
  info: ts.server.PluginCreateInfo
) => {
  node: ts.CallExpression | null;
  filename: string;
};
declare const getDocumentReferenceFromDocumentNode: (
  documentNodeArgument: ts.Identifier | ts.CallExpression,
  filename: string,
  info: ts.server.PluginCreateInfo
) => {
  node: ts.CallExpression | null;
  filename: string;
};

export {
  findAllPersistedCallExpressions,
  getDocumentReferenceFromDocumentNode,
  getDocumentReferenceFromTypeQuery,
  getGraphQLDiagnostics,
  init,
  unrollTadaFragments,
};
